{"version":3,"sources":["chat.js","dice2D.js","dice3D.js","dices.js","images.js","music.js","room.js","users.js","main.js","plugins.js"],"names":["Chat","room","messages","this","msgbox","myMessages","typing","editMode","$messages","$","$message","$content","$chat","init","Dice2D","id","type","color","box","value","parseInt","replace","split","radius","scale","transform","position","x","y","z","rotation","time","createMesh","Dices2D","width","height","w","h","cw","ch","scene","dices","copyto","obj","res","Array","i","length","copy","hasOwnProperty","constructor","makeGeometry","vertices","faces","tab","af","geom","THREE","Geometry","vertex","Vector3","fromArray","normalize","multiplyScalar","index","push","ii","fl","aa","Math","PI","j","Face3","faceVertexUvs","Vector2","cos","sin","computeFaceNormals","computeVertexNormals","boundingSphere","Sphere","idealTextColor","bgColor","nThreshold","components","getRGBComponents","bgDelta","R","G","B","r","substring","g","b","makeDiceMaterials","diceColor","faceLabels","size","margin","createTextTexture","text","backColor","undefined","canvas","document","createElement","context","getContext","font","fillStyle","fillRect","textAlign","textBaseline","fillText","texture","Texture","needsUpdate","materials","MeshPhongMaterial","materialOptions","map","makeD4Materials","createD4Text","translate","rotate","labels","Dice3D","DicesModels3D","renderer","render","camera","Dices3D","aspect","desk","light","Dice","rolls","cooldown","$item","pop","Dices","$dices","Images","image","$zoom","LocalPlayer","music","audio","Audio","volet","YoutubePlayer","youtube","$musicUrl","$playLater","$playNow","Music","playlist","current","savedVolume","currentVolume","localPlayer","youtubePlayer","player","$play","$mute","$volume","$bar","find","$musicPlayer","$musicPopin","Room","socket","name","user","users","options","hasWebGLSupport","dice","window","innerWidth","innerHeight","Users","images","chat","$roomName","$logout","grabbed","ghost","$users","item","prototype","getMessageIndexById","addMessage","message","editable","getClass","data","c","admin","prive","isNewBox","command","showCommand","append","html","showLastDice","roll","scrollTop","scrollHeight","showError","error","showImage","editMessage","myIndex","indexOf","typingStart","that","clearTimeout","setTimeout","typingStop","emit","startEdit","focus","val","putCursorAtEnd","stopEdit","editPrev","editNext","checkEndEdit","on","e","preventDefault","myMsg","keyCode","destroy","off","removeAllListeners","css","top","left","lineHeight","fontSize","fontWeight","textShadow","update","values","acos","Date","now","ceil","random","result","remove","sqrt","d4","geometry","mass","inertia","d6","d8","d10","a","d12","p","q","d20","t","d100","specular","emissive","shininess","shading","FlatShading","diceLabels","d10Labels","d100Labels","model","mesh","Mesh","MeshFaceMaterial","castShadow","receiveShadow","quaternion","add","resize","min","wh","tan","far","updateProjectionMatrix","mw","max","set","target","setSize","WebGLRenderingContext","WebGLRenderer","antialias","alpha","CanvasRenderer","shadowMapEnabled","shadowMapSoft","setClearColor","Scene","fog","domElement","PerspectiveCamera","ambientLight","AmbientLight","SpotLight","shadowCameraNear","shadowCameraFar","shadowCameraFov","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","planeFragmentShader","ShaderChunk","join","planeMaterial","ShaderMaterial","uniforms","ShaderLib","vertexShader","fragmentShader","PlaneGeometry","addEventListener","bind","addClass","removeClass","unload","show","sort","number","children","detach","className","exist","round","$this","hasClass","url","close","zoom","src","upload","shift","reader","FileReader","onload","evt","readAsDataURL","download","originalEvent","dataTransfer","files","attr","loginRoom","action","loading","joinRoom","createRoom","succes","settings","Cookies","expires","fadeOut","submit","click","cookie","get","ck","config","Config","io","body","appendChild","autoplay","loop","post","crawlSongs","song","parent","elem","songs","next","each","musiclist","title","start","track","play","pause","volume","v","console","log","parentNode","removeChild","onPlayerReady","event","parse","parseURL","onPlayerStateChange","YT","PlayerState","PLAYING","getPlaylistIndex","ENDED","getPlaylist","tag","firstScriptTag","getElementsByTagName","insertBefore","onYouTubeIframeAPIReady","Player","events","onReady","onStateChange","loadPlaylist","list","pauseVideo","playVideo","setVolume","load","l","mute","unmute","offsetX","offset","clientX","fadeIn","factory","define","amd","exports","module","_OldCookies","api","jQuery","noConflict","extend","arguments","attributes","key","converter","path","defaults","setMilliseconds","getMilliseconds","JSON","stringify","test","encodeURIComponent","String","decodeURIComponent","escape","toUTCString","domain","secure","cookies","rdecode","parts","slice","charAt","json","getJSON","apply","call","withConverter","fn","setSelectionRange","len","support","tested","gl","experimental","location","href","getUserByName","toLowerCase","getUserById","getIndexById","showUser","$caracs","$user","order","prepend","refreshTokens","addUser","unshift","removeUser","splice","u","tokens","ts","tok","grab","self","clone","outerWidth","appendTo","release","pageX","pageY","grabbing","items","outerHeight","after","before","ordering","connected","token","delay","stopPropagation"],"mappings":"AAAA,QAAAA,MAAAC,EAAAC,GAEAC,KAAAC,OAAA,EACAD,KAAAF,KAAAA,EACAE,KAAAD,YACAC,KAAAE,cACAF,KAAAG,OAAA,KACAH,KAAAI,YAEAJ,KAAAK,UAAAC,EAAA,aACAN,KAAAO,SAAAD,EAAA,YACAN,KAAAQ,SAAAF,EAAA,YACAN,KAAAS,MAAAH,EAAA,SAEAN,KAAAU,KAAAX,GCZA,QAAAY,QAAAC,EAAAC,EAAAC,EAAAC,GAEAf,KAAAY,GAAAA,EACAZ,KAAAa,KAAAA,EACAb,KAAAgB,MAAAC,SAAAjB,KAAAa,KAAAK,QAAA,IAAA,IAAAC,MAAA,KAAA,IACAnB,KAAAe,IAAAA,EACAf,KAAAoB,OAAA,IAAApB,KAAAe,IAAAM,MACArB,KAAAc,MAAAA,EACAd,KAAAsB,UAEAtB,KAAAuB,UAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA,GACA1B,KAAA2B,SAAA,EACA3B,KAAA4B,KAAA,EAEA5B,KAAA6B,aA4CA,QAAAC,SAAAhC,EAAAiC,EAAAC,GAEAhC,KAAAF,KAAAA,EACAE,KAAAiC,EAAAF,EACA/B,KAAAkC,EAAAF,EACAhC,KAAAmC,GACAnC,KAAAoC,GACApC,KAAAqB,MACArB,KAAAqC,MAEArC,KAAAsC,SAEAtC,KAAAU,OC6BA,QAAA6B,QAAAC,EAAAC,GACA,GAAA,MAAAD,GAAA,gBAAAA,GAAA,MAAAA,EACA,IAAAA,YAAAE,OACA,IAAA,GAAAC,GAAAH,EAAAI,OAAA,EAAAD,GAAA,IAAAA,EACAF,EAAAE,GAAAE,KAAAL,EAAAG,QAGA,KAAA,GAAAA,KAAAH,GACAA,EAAAM,eAAAH,KACAF,EAAAE,GAAAE,KAAAL,EAAAG,IAGA,OAAAF,GAGA,QAAAI,MAAAL,GACA,MAAAA,GACAD,OAAAC,EAAA,GAAAA,GAAAO,aADAP,EAIA,QAAAQ,cAAAC,EAAAC,EAAA9B,EAAA+B,EAAAC,GAEA,IAAA,GADAC,GAAA,GAAAC,OAAAC,SACAZ,EAAA,EAAAA,EAAAM,EAAAL,SAAAD,EAAA,CACA,GAAAa,IAAA,GAAAF,OAAAG,SAAAC,UAAAT,EAAAN,IAAAgB,YAAAC,eAAAxC,EACAoC,GAAAK,MAAAR,EAAAJ,SAAAa,KAAAN,GAAA,EAEA,IAAA,GAAAb,GAAA,EAAAA,EAAAO,EAAAN,SAAAD,EAGA,IAAA,GAFAoB,GAAAb,EAAAP,GAAAqB,EAAAD,EAAAnB,OAAA,EACAqB,EAAA,EAAAC,KAAAC,GAAAH,EACAI,EAAA,EAAAA,EAAAJ,EAAA,IAAAI,EACAf,EAAAH,MAAAY,KAAA,GAAAR,OAAAe,MAAAN,EAAA,GAAAA,EAAAK,EAAA,GAAAL,EAAAK,EAAA,IAAAf,EAAAJ,SAAAc,EAAA,IACAV,EAAAJ,SAAAc,EAAAK,EAAA,IAAAf,EAAAJ,SAAAc,EAAAK,EAAA,KAAA,EAAAL,EAAAC,GAAA,IACAX,EAAAiB,cAAA,GAAAR,MACA,GAAAR,OAAAiB,SAAAL,KAAAM,IAAApB,GAAA,EAAAD,GAAA,GAAA,EAAAA,IACAe,KAAAO,IAAArB,GAAA,EAAAD,GAAA,GAAA,EAAAA,IACA,GAAAG,OAAAiB,SAAAL,KAAAM,IAAAP,GAAAG,EAAA,GAAAhB,GAAA,EAAAD,GAAA,GAAA,EAAAA,IACAe,KAAAO,IAAAR,GAAAG,EAAA,GAAAhB,GAAA,EAAAD,GAAA,GAAA,EAAAA,IACA,GAAAG,OAAAiB,SAAAL,KAAAM,IAAAP,GAAAG,EAAA,GAAAhB,GAAA,EAAAD,GAAA,GAAA,EAAAA,IACAe,KAAAO,IAAAR,GAAAG,EAAA,GAAAhB,GAAA,EAAAD,GAAA,GAAA,EAAAA,KAMA,OAHAE,GAAAqB,qBACArB,EAAAsB,uBACAtB,EAAAuB,eAAA,GAAAtB,OAAAuB,OAAA,GAAAvB,OAAAG,QAAArC,GACAiC,EAeA,QAAAyB,gBAAAC,GAEA,GAAAC,GAAA,IACAC,EAAAC,iBAAAH,GACAI,EAAA,KAAAF,EAAAG,EAAA,KAAAH,EAAAI,EAAA,KAAAJ,EAAAK,CAEA,OAAA,KAAAH,EAAAH,EAAA,UAAA,UAGA,QAAAE,kBAAApE,GAEA,GAAAyE,GAAAzE,EAAA0E,UAAA,EAAA,GACAC,EAAA3E,EAAA0E,UAAA,EAAA,GACAE,EAAA5E,EAAA0E,UAAA,EAAA,EAEA,QACAJ,EAAAnE,SAAAsE,EAAA,IACAF,EAAApE,SAAAwE,EAAA,IACAH,EAAArE,SAAAyE,EAAA,KAIA,QAAAC,mBAAAC,EAAAC,EAAAC,EAAAC,GACA,QAAAC,GAAAC,EAAAnF,EAAAoF,GACA,GAAAC,QAAAF,EAAA,MAAA,KACA,IAAAG,GAAAC,SAAAC,cAAA,UACAC,EAAAH,EAAAI,WAAA,KACAJ,GAAArE,MAAA+D,EAAAC,EACAK,EAAApE,OAAA8D,EAAAC,EACAQ,EAAAE,KAAAX,EAAA,WACAS,EAAAG,UAAAR,EACAK,EAAAI,SAAA,EAAA,EAAAP,EAAArE,MAAAqE,EAAApE,QACAuE,EAAAK,UAAA,SACAL,EAAAM,aAAA,SACAN,EAAAG,UAAA5F,EACAyF,EAAAO,SAAAb,EAAAG,EAAArE,MAAA,EAAAqE,EAAApE,OAAA,GACA,KAAAiE,GAAA,KAAAA,GACAM,EAAAO,SAAA,MAAAV,EAAArE,MAAA,EAAAqE,EAAApE,OAAA,EAEA,IAAA+E,GAAA,GAAAzD,OAAA0D,QAAAZ,EAEA,OADAW,GAAAE,aAAA,EACAF,EAGA,IAAA,GADAG,MACAvE,EAAA,EAAAA,EAAAkD,EAAAjD,SAAAD,EACAuE,EAAApD,KAAA,GAAAR,OAAA6D,kBAAA5E,OAAA6E,iBAAAC,IAAArB,EAAAH,EAAAlD,GAAAmC,eAAAc,GAAAA,MAEA,OAAAsB,GAGA,QAAAI,iBAAA1B,EAAAE,EAAAC,GACA,QAAAwB,GAAAtB,EAAAnF,EAAAoF,GACA,GAAAE,GAAAC,SAAAC,cAAA,UACAC,EAAAH,EAAAI,WAAA,KACAJ,GAAArE,MAAA+D,EAAAC,EACAK,EAAApE,OAAA8D,EAAAC,EACAQ,EAAAE,KAAAX,EAAA,WACAS,EAAAG,UAAAR,EACAK,EAAAI,SAAA,EAAA,EAAAP,EAAArE,MAAAqE,EAAApE,QACAuE,EAAAK,UAAA,SACAL,EAAAM,aAAA,SACAN,EAAAG,UAAA5F,EACAyF,EAAAiB,UAAA,EAAA1B,EAAA,GACA,KAAA,GAAAnD,KAAAsD,GACAM,EAAAO,SAAAb,EAAAtD,GAAAyD,EAAArE,MAAA,EACAqE,EAAApE,OAAA,EAAA8D,EAAAC,EAAA,IACAQ,EAAAiB,UAAApB,EAAArE,MAAA,EAAAqE,EAAApE,OAAA,GACAuE,EAAAkB,OAAA,EAAAvD,KAAAC,GAAA,GACAoC,EAAAiB,WAAApB,EAAArE,MAAA,GAAAqE,EAAApE,OAAA,EAEA,IAAA+E,GAAA,GAAAzD,OAAA0D,QAAAZ,EAEA,OADAW,GAAAE,aAAA,EACAF,EAIA,IAAA,GAFAG,MACAQ,OAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IACA/E,EAAA,EAAAA,EAAA+E,EAAA9E,SAAAD,EACAuE,EAAApD,KAAA,GAAAR,OAAA6D,kBAAA5E,OAAA6E,iBAAAC,IAAAE,EAAAG,EAAA/E,GAAAmC,eAAAc,GAAAA,MACA,OAAAsB,GAGA,QAAAS,QAAA/G,EAAAC,EAAAC,EAAAC,GAEAf,KAAAY,GAAAA,EACAZ,KAAAa,KAAAA,EACAb,KAAAe,IAAAA,EACAf,KAAAoB,OAAA,GAAAwG,cAAA5H,KAAAa,MAAAQ,MAAAN,EAAAM,MACArB,KAAAc,MAAAA,EACAd,KAAAsB,UAKAtB,KAAA6B,aAEA7B,KAAAe,IAAA8G,SAAAC,OAAA9H,KAAAe,IAAAsB,MAAArC,KAAAe,IAAAgH,QAsDA,QAAAC,SAAAlI,EAAAiC,EAAAC,GAEAhC,KAAAF,KAAAA,EACAE,KAAAiC,EAAAF,EACA/B,KAAAkC,EAAAF,EACAhC,KAAAmC,GACAnC,KAAAoC,GACApC,KAAAqC,MACArC,KAAA+H,OACA/H,KAAA6H,SACA7H,KAAAiI,OACAjI,KAAAqB,MACArB,KAAAkI,KACAlI,KAAAmI,MAEAnI,KAAAsC,SAEAtC,KAAAU,OCtUA,QAAA0H,MAAAvH,GACAb,KAAAa,KAAAA,EACAb,KAAAqI,MAAA,EACArI,KAAAsI,SAAA,KACAtI,KAAAuI,MAAAjI,EAAA,qBAAAO,EAAAM,MAAA,KAAAqH,MAAA,cAAA3H,EAAA,UAWA,QAAA4H,OAAA3I,GAEAE,KAAAF,KAAAA,EACAE,KAAAsC,SAEAtC,KAAA0I,OAAApI,EAAA,UAEAN,KAAAU,OCtBA,QAAAiI,QAAA7I,GAEAE,KAAAF,KAAAA,EACAE,KAAA4I,MAAA,GAEA5I,KAAA6I,MAAA,KAEA7I,KAAAU,OCPA,QAAAoI,aAAAC,GAEA/I,KAAA+I,MAAAA,EACA/I,KAAAgJ,MAAA,GAAAC,OACAjJ,KAAAkJ,MAAA,EACAlJ,KAAAU,OAuGA,QAAAyI,eAAAJ,GAEA/I,KAAA+I,MAAAA,EACA/I,KAAA6D,MAAA,EACA7D,KAAAoJ,QACApJ,KAAAqJ,UACArJ,KAAAsJ,WACAtJ,KAAAuJ,SAEAvJ,KAAAU,OAuHA,QAAA8I,OAAA1J,GAEAE,KAAAF,KAAAA,EACAE,KAAAyJ,YACAzJ,KAAA0J,QAAA,EACA1J,KAAA2J,YAAA,EACA3J,KAAA4J,cAAA,EACA5J,KAAA6J,YACA7J,KAAA8J,cACA9J,KAAA+J,OAEA/J,KAAAgK,MAAA1J,EAAA,SACAN,KAAAiK,MAAA3J,EAAA,SACAN,KAAAkK,QAAA5J,EAAA,WACAN,KAAAmK,KAAAnK,KAAAkK,QAAAE,KAAA,qBACApK,KAAAqK,aAAA/J,EAAA,iBAEAN,KAAAsK,YAEAtK,KAAAU,OC/PA,QAAA6J,MAAAC,EAAAC,EAAAC,EAAAC,EAAA5K,EAAA6K,GAEA5K,KAAAwK,OAAAA,EACAxK,KAAAyK,KAAAA,EACAzK,KAAA0K,KAAAA,EAEA1K,KAAAsC,MAAA,GAAAmG,OAAAzI,MACA6K,kBACA7K,KAAA8K,KAAA,GAAA9C,SAAAhI,KAAA+K,OAAAC,WAAAD,OAAAE,aAEAjL,KAAA8K,KAAA,GAAAhJ,SAAA9B,KAAA+K,OAAAC,WAAAD,OAAAE,aAEAjL,KAAA2K,MAAA,GAAAO,OAAAlL,KAAA2K,GACA3K,KAAAmL,OAAA,GAAAxC,QAAA3I,MACAA,KAAAoL,KAAA,GAAAvL,MAAAG,KAAAD,GACAC,KAAA+I,MAAA,GAAAS,OAAAxJ,MACAA,KAAA4K,QAAAA,EAEA5K,KAAAqL,UAAA/K,EAAA,cACAN,KAAAsL,QAAAhL,EAAA,WAEAN,KAAAU,KAAAiK,GCrBA,QAAAO,OAAApL,EAAA6K,GAEA3K,KAAAF,KAAAA,EACAE,KAAA2K,SACA3K,KAAAuL,QAAA,KACAvL,KAAAwL,MAAA,KAEAxL,KAAAyL,OAAAnL,EAAA,UACAN,KAAA0L,KAEA1L,KAAAU,KAAAiK,GPOA9K,KAAA8L,UAAAC,oBAAA,SAAAhL,GAEA,IAAA,GAAA+B,GAAA3C,KAAAD,SAAA6C,OAAA,EAAAD,GAAA,EAAAA,IAEA,GAAA3C,KAAAD,SAAA4C,GAAA/B,IAAAA,EACA,MAAA+B,EAGA,WAGA9C,KAAA8L,UAAAE,WAAA,SAAAC,EAAAC,GAGAD,EAAApB,KAAAD,MAAAzK,KAAAF,KAAA4K,KAAAD,MAAAsB,GACA/L,KAAAE,WAAA4D,KAAAgI,GAEA9L,KAAAD,SAAA+D,KAAAgI,IAGAjM,KAAA8L,UAAAK,SAAA,SAAAC,GACA,GAAAC,GAAA,EAKA,OAJAD,GAAAvB,KAAAD,MAAAzK,KAAAF,KAAA4K,KAAAD,OAAAyB,GAAA,OACAD,EAAAvB,KAAAyB,QAAAD,GAAA,UACAD,EAAAG,QAAAF,GAAA,UAEAA,GAGArM,KAAA8L,UAAAU,SAAA,SAAAJ,GAEA,QACAjM,KAAAD,SAAA6C,OAAA,GACA5C,KAAAD,SAAAC,KAAAD,SAAA6C,OAAA,GAAA8H,KAAAD,MAAAwB,EAAAvB,KAAAD,OACAzK,KAAAD,SAAAC,KAAAD,SAAA6C,OAAA,GAAA0J,UACAtM,KAAAD,SAAAC,KAAAD,SAAA6C,OAAA,GAAAgG,OACA5I,KAAAD,SAAAC,KAAAD,SAAA6C,OAAA,GAAAwJ,OAAAH,EAAAG,QAIAvM,KAAA8L,UAAAY,YAAA,SAAAN,GAEA,OAAAA,EAAAK,SACA,IAAA,QACAtM,KAAAK,UAAAmM,OAAAlM,EAAA,qBAAAN,KAAAC,OAAA,8BAAAD,KAAAgM,SAAAC,GAAA,MAAAQ,KAAA,uBAAAR,EAAA,MAAAA,EAAAvB,KAAAD,KAAA,OAAAwB,EAAAG,MAAAH,EAAAvB,KAAAD,MAAA,YAAAwB,EAAAH,UACA9L,KAAA6L,WAAAI,GAAA,GACAjM,KAAAF,KAAA6K,MAAA+B,aAAAT,EAAAvB,KAAAuB,EAAAH,SACAG,EAAAvB,KAAAD,MAAAzK,KAAAF,KAAA4K,KAAAD,MAAAzK,KAAAF,KAAAwC,MAAAqK,KAAAV,EAAAnB,MAMA,MAFA9K,MAAAQ,SAAAoM,UAAA5M,KAAAQ,SAAA,GAAAqM,eAEA,GAGAhN,KAAA8L,UAAAmB,UAAA,SAAAb,GAEAA,EAAAvB,KAAAD,KAAA,QACAzK,KAAAK,UAAAmM,OAAAlM,EAAA,qBAAAN,KAAAC,OAAA,oBAAAgM,EAAAc,MAAA,SAAAN,KAAAR,EAAAH,UACA9L,KAAA6L,WAAAI,GAAA,GACAjM,KAAAQ,SAAAoM,UAAA5M,KAAAQ,SAAA,GAAAqM,eAIAhN,KAAA8L,UAAAqB,UAAA,SAAAf,GAEA,GAAAhG,GAAA,kBAAAgG,EAAArD,MAAA,6BAAAqD,EAAArD,MAAA,oBAAAqD,EAAAxB,KAAA,YACAzK,MAAAqM,SAAAJ,GAEAjM,KAAAK,UAAAmM,OACA,qBAAAxM,KAAAC,OAAA,6BAAAD,KAAAgM,SAAAC,GAAA,wBACAA,EAAA,MAAAA,EAAAvB,KAAAD,KAAA,OAAAwB,EAAAG,MAAAH,EAAAvB,KAAAD,MAAA,6BACAxE,EAAA,eAMA3F,EAAA,WAAAN,KAAAC,QAAAmK,KAAA,SAAAoC,OAAAvG,GAGAjG,KAAA6L,WAAAI,GAAA,GACAjM,KAAAQ,SAAAoM,UAAA5M,KAAAQ,SAAA,GAAAqM,eAGAhN,KAAA8L,UAAAG,QAAA,SAAAG,GAEA,MAAAA,GAAAc,UACA/M,MAAA8M,UAAAb,GAIAA,EAAAK,YACAtM,MAAAuM,YAAAN,GAIA,mBAAAA,GAAArD,UACA5I,MAAAgN,UAAAf,IAIAjM,KAAAqM,SAAAJ,GAGAjM,KAAAK,UAAAmM,OACA,qBAAAxM,KAAAC,OAAA,6BAAAD,KAAAgM,SAAAC,GAAA,wBACAA,EAAA,MAAAA,EAAAvB,KAAAD,KAAA,OAAAwB,EAAAG,MAAAH,EAAAvB,KAAAD,MAAA,0CACAwB,EAAArL,GAAA,KAAAqL,EAAAH,QAAA,qBAOAxL,EAAA,WAAAN,KAAAC,QAAAmK,KAAA,SAAAoC,OAAA,gBAAAP,EAAArL,GAAA,KAAAqL,EAAAH,QAAA,UAGA9L,KAAA6L,WAAAI,GAAA,OACAjM,MAAAQ,SAAAoM,UAAA5M,KAAAQ,SAAA,GAAAqM,gBAGAhN,KAAA8L,UAAAsB,YAAA,SAAAhB,GAGA,KAAAA,EAAAc,OAAAd,EAAAK,SAAAL,EAAArD,OAAA,CAEA,GAAA/E,GAAA7D,KAAA4L,oBAAAK,EAAArL,GACA,IAAAiD,GAAA,EACA,CACA,GAAAqJ,GAAAlN,KAAAE,WAAAiN,QAAAnN,KAAAD,SAAA8D,GACAqJ,IAAA,IACAlN,KAAAE,WAAAgN,GAAAjB,GAEAjM,KAAAD,SAAA8D,GAAAoI,EACA3L,EAAA,QAAA2L,EAAArL,IAAA6L,KAAAR,EAAAH,YAIAjM,KAAA8L,UAAAyB,YAAA,WAEA,GAAAC,GAAArN,IACAA,MAAAG,QAGAmN,aAAAtN,KAAAG,QACAH,KAAAG,OAAAoN,WAAA,WAAAF,EAAAG,cAAA,QAKAxN,KAAAF,KAAA0K,OAAAiD,KAAA,gBACAzN,KAAAG,OAAAoN,WAAA,WAAAF,EAAAG,cAAA,QAIA3N,KAAA8L,UAAA6B,WAAA,WAEAF,aAAAtN,KAAAG,QACAH,KAAAG,OAAA,KACAH,KAAAF,KAAA0K,OAAAiD,KAAA,gBAGA5N,KAAA8L,UAAA+B,UAAA,WAEA,GAAA1N,KAAAI,UAAA,EAAA,CACA,GAAAiN,GAAArN,IACAA,MAAAO,SAAAoN,QACA3N,KAAAO,SAAAqN,IAAA5N,KAAAE,WAAAF,KAAAI,UAAA0L,SACAyB,WAAA,WAAAF,EAAA9M,SAAAsN,kBAAA,KAIAhO,KAAA8L,UAAAmC,SAAA,WAEA9N,KAAAI,UAAA,IACAJ,KAAAO,SAAAqN,IAAA,IACA5N,KAAAI,cAIAP,KAAA8L,UAAAoC,SAAA,WAEA/N,KAAAI,UAAA,IACAJ,KAAAI,SAAAJ,KAAAE,WAAA0C,UAEA5C,KAAAI,SACAJ,KAAA0N,aAGA7N,KAAA8L,UAAAqC,SAAA,aAEAhO,KAAAI,SAEAJ,KAAAI,UAAAJ,KAAAE,WAAA0C,OAEA5C,KAAA8N,WAIA9N,KAAA0N,aAIA7N,KAAA8L,UAAAsC,aAAA,WAEA,IAAAjO,KAAAO,SAAAqN,QAEA5N,KAAAI,cAIAP,KAAA8L,UAAAjL,KAAA,SAAAX,GAEA,GAAAsN,GAAArN,IAGA,KAAA2C,EAAA,EAAAC,OAAA7C,EAAA6C,OAAAD,EAAAC,OAAAD,IACA3C,KAAA8L,QAAA/L,EAAA4C,GAIA3C,MAAAS,MAAAyN,GAAA,cAAA,SAAAC,GACAA,EAAAC,gBAEA,IAAAtC,GAAAuB,EAAA9M,SAAAqN,KAEA,IAAA,IAAA9B,EACA,CACA,GAAAuB,EAAAjN,UAAA,EACA,CACA,GAAAiO,GAAAhB,EAAAnN,WAAAmN,EAAAjN,SACAiO,GAAAjC,QACAN,EAAA,IAAAuC,EAAAjC,MAAA,IAAAN,GAEAuB,EAAAvN,KAAA0K,OAAAiD,KAAA,YAAAY,EAAAzN,GAAAkL,GACAuB,EAAAS,eAIAT,GAAAvN,KAAA0K,OAAAiD,KAAA,OAAA3B,EAGAuB,GAAA9M,SAAAqN,IAAA,IACAP,EAAAY,eACAZ,EAAAG,aAGA,OAAA,IAIAxN,KAAAF,KAAA0K,OAAA0D,GAAA,OAAA,SAAAjC,GACAoB,EAAAvB,QAAAG,KAIAjM,KAAAO,SAAA2N,GAAA,gBAAA,SAAAC,GAEA,GAAAA,EAAAG,SAAA,IAAAH,EAAAG,SAEAjB,EAAAD,gBAKApN,KAAAF,KAAA0K,OAAA0D,GAAA,YAAA,SAAAjC,GACAoB,EAAAJ,YAAAhB,KAGAjM,KAAAO,SAAA2N,GAAA,eAAA,SAAAC,GAEA,IAAAA,EAAAG,QAEAjB,EAAAU,WAGA,IAAAI,EAAAG,QAEAjB,EAAAW,WAGA,GAAAG,EAAAG,SAAA,IAAAH,EAAAG,SAEAjB,EAAAY,kBAKApO,KAAA8L,UAAA4C,QAAA,WAEAvO,KAAAS,MAAA+N,IAAA,SACAxO,KAAAO,SAAAiO,IAAA,SACAxO,KAAAF,KAAA0K,OAAAiE,mBAAA,QACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,cCrSA9N,OAAAgL,UAAA9J,WAAA,WAEA7B,KAAAsB,UAAAhB,EAAA,oBAAAN,KAAAa,KAAA,YAAA6N,KACAnN,SAAA,WACAoN,KAAA3O,KAAAoB,OACAwN,MAAA5O,KAAAoB,OACAW,MAAA,EAAA/B,KAAAoB,OACAY,OAAA,EAAAhC,KAAAoB,OACAyN,WAAA,EAAA7O,KAAAoB,OAAA,KACA0N,SAAA,IAAA9O,KAAAoB,OAAA,KACA2N,WAAA,OACAC,WAAA,2FAGAhP,KAAAe,IAAAsB,MAAAmK,OAAAxM,KAAAsB,YAGAX,OAAAgL,UAAAsD,OAAA,SAAAC,GAEAlP,KAAAuB,SAAAC,EAAA0N,EAAA,GAAAlP,KAAAe,IAAAkB,EAAA,IAAA,EAAAjC,KAAAe,IAAAoB,GACAnC,KAAAuB,SAAAE,EAAAzB,KAAAe,IAAAqB,GAAA8M,EAAA,GAAAlP,KAAAe,IAAAmB,EAAA,IAAA,EACAlC,KAAAuB,SAAAG,EAAAwN,EAAA,GACAlP,KAAA2B,UAAA,EAAAuC,KAAAiL,KAAAD,EAAA,IAAA,IAAAhL,KAAAC,GAAA,KAAA,IAEAnE,KAAAsB,UAAAoN,IAAA,YAAA,eAAA1O,KAAAuB,SAAAC,EAAA,OAAAxB,KAAAuB,SAAAE,EAAA,OAAAzB,KAAAuB,SAAAG,EAAA,cAAA1B,KAAA2B,SAAA,QACAyN,KAAAC,MAAArP,KAAA4B,KAAA,MACA5B,KAAAsB,UAAAmL,KAAAvI,KAAAoL,KAAApL,KAAAqL,SAAAvP,KAAAgB,QACAhB,KAAA4B,KAAAwN,KAAAC,QAIA1O,OAAAgL,UAAA6D,OAAA,SAAAxO,GAEAhB,KAAAsB,UAAAmL,KAAAzL,IAGAL,OAAAgL,UAAA8D,OAAA,WACAzP,KAAAsB,UAAAmO,eACAzP,MAAAe,IAAAuB,MAAAtC,KAAAY,KAkBAkB,QAAA6J,UAAAjL,KAAA,WAEA,GAAA2M,GAAArN,IAEAA,MAAAmC,GAAAnC,KAAAiC,EAAA,EACAjC,KAAAoC,GAAApC,KAAAkC,EAAA,EACAlC,KAAAqB,MAAA6C,KAAAwL,KAAA1P,KAAAiC,EAAAjC,KAAAiC,EAAAjC,KAAAkC,EAAAlC,KAAAkC,GAAA,GAEAlC,KAAAsC,SACAtC,KAAAqC,MAAA/B,EAAA,aAEAN,KAAAF,KAAA0K,OAAA0D,GAAA,aAAA,SAAAjC,GACA,IAAA,GAAAtJ,GAAA,EAAAA,EAAAsJ,EAAArJ,OAAAD,IACA0K,EAAA/K,MAAA2J,EAAAtJ,GAAA/B,IAAA,GAAAD,QAAAsL,EAAAtJ,GAAA/B,GAAAqL,EAAAtJ,GAAA9B,KAAAoL,EAAAtJ,GAAA7B,MAAAuM,KAIArN,KAAAF,KAAA0K,OAAA0D,GAAA,cAAA,SAAAjC,GACA,IAAA,GAAAtJ,KAAAsJ,GACAoB,EAAA/K,MAAAK,IAAA0K,EAAA/K,MAAAK,GAAAsM,OAAAhD,EAAAtJ,MAIA3C,KAAAF,KAAA0K,OAAA0D,GAAA,cAAA,SAAAjC,GACA,IAAA,GAAAtJ,KAAAsJ,GACAoB,EAAA/K,MAAAK,IAAA0K,EAAA/K,MAAAK,GAAA6M,OAAAvD,EAAAtJ,MAIA3C,KAAAF,KAAA0K,OAAA0D,GAAA,WAAA,SAAAjC,GACA,IAAA,GAAAtJ,GAAA,EAAAA,EAAAsJ,EAAArJ,OAAAD,IACA0K,EAAA/K,MAAA2J,EAAAtJ,KAAA0K,EAAA/K,MAAA2J,EAAAtJ,IAAA8M,YAKA3N,QAAA6J,UAAA8D,OAAA,WACAzP,KAAAF,KAAA0K,OAAAiE,mBAAA,cACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,YCjHA,IAAA7G,iBAEAA,eAAA+H,IACAC,UACA3M,WAAA,EAAA,EAAA,UAAA,OAAA,OAAA,UACAC,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IACAC,QACAC,GAAA,EAAAc,KAAAC,GAAA,GAEA0L,KAAA,IACAC,QAAA,EACAzO,MAAA,GAGAuG,cAAAmI,IACAH,UACA3M,sBAAA,UAAA,EAAA,UAAA,aAAA,IAAA,KAAA,IAAA,EAAA,EAAA,OAAA,EAAA,IACAC,QAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,IACAC,IAAA,GACAC,GAAAc,KAAAC,GAAA,GAEA0L,KAAA,IACAC,QAAA,GACAzO,MAAA,KAGAuG,cAAAoI,IACAJ,UACA3M,WAAA,EAAA,EAAA,OAAA,EAAA,IAAA,EAAA,EAAA,IAAA,KAAA,IAAA,EAAA,EAAA,IAAA,EAAA,OACAC,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IACAC,IAAA,EACAC,IAAAc,KAAAC,GAAA,EAAA,GAEA0L,KAAA,IACAC,QAAA,GACAzO,MAAA,KAGAuG,cAAAqI,KACAL,UACA3M,SAAA,WAGA,IAAA,GAFAiN,GAAA,EAAAhM,KAAAC,GAAA,GAAAjC,GAAAgC,KAAAM,IAAA0L,GAAA,MACAjN,KACAN,EAAA,EAAA+C,EAAA,EAAA/C,EAAA,KAAAA,EAAA+C,GAAAwK,EACAjN,EAAAa,MAAAI,KAAAM,IAAAkB,GAAAxB,KAAAO,IAAAiB,GAAAxD,GAAAS,EAAA,EAAA,OAEA,OADAM,GAAAa,MAAA,EAAA,OAAAb,EAAAa,MAAA,EAAA,EAAA,IACAb,KAEAC,QACA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IACA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,IACA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OACA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OAAA,EAAA,EAAA,OAEAC,IAAA,EACAC,GAAA,EAAAc,KAAAC,GAAA,GAEA0L,KAAA,IACAC,QAAA,EACAzO,MAAA,GAGAuG,cAAAuI,KACAP,UACA3M,SAAA,WACA,GAAAmN,IAAA,EAAAlM,KAAAwL,KAAA,IAAA,EAAAW,EAAA,EAAAD,CACA,SAAA,EAAAC,EAAAD,IAAA,EAAAC,GAAAD,IAAA,GAAAC,EAAAD,IAAA,GAAAC,GAAAD,IAAAA,EAAA,EAAAC,IAAAD,EAAA,GAAAC,KAAAD,EAAA,EAAAC,KAAAD,EAAA,GAAAC,IAAAA,EAAAD,EAAA,IAAAC,GAAAD,EAAA,KAAAC,EAAAD,EAAA,KAAAC,GAAAD,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,OAAA,KAAA,IAAA,aAAA,EAAA,OAAA,aAAA,kBAEAlN,QAAA,EAAA,GAAA,EAAA,GAAA,EAAA,IAAA,GAAA,EAAA,GAAA,GAAA,EAAA,IAAA,GAAA,GAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,GAAA,GAAA,GAAA,IAAA,EAAA,GAAA,EAAA,EAAA,GAAA,IAAA,GAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,GAAA,EAAA,GAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAA,IAAA,GAAA,EAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,EAAA,GAAA,EAAA,KACAC,IAAA,GACAC,IAAAc,KAAAC,GAAA,EAAA,GAEA0L,KAAA,IACAC,QAAA,EACAzO,MAAA,GAGAuG,cAAA0I,KACAV,UACA3M,SAAA,WACA,GAAAsN,IAAA,EAAArM,KAAAwL,KAAA,IAAA,CACA,YAAAa,EAAA,IAAA,EAAAA,EAAA,QAAAA,EAAA,IAAA,GAAAA,EAAA,IAAA,KAAAA,IAAA,EAAA,EAAAA,IAAA,MAAAA,IAAA,EAAA,GAAAA,IAAAA,EAAA,OAAAA,EAAA,EAAA,KAAAA,EAAA,QAAAA,EAAA,EAAA,OAEArN,QAAA,EAAA,GAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA,GAAA,IAAA,EAAA,GAAA,GAAA,IAAA,EAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,GAAA,GAAA,EAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,GAAA,KAAA,EAAA,EAAA,GAAA,KAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,EAAA,KACAC,QACAC,IAAAc,KAAAC,GAAA,EAAA,GAEA0L,KAAA,IACAC,QAAA,EACAzO,MAAA,GAGAuG,cAAA4I,MACAZ,SAAAhI,cAAAqI,IAAAL,SACAC,KAAA,IACAC,QAAA,EACAzO,MAAA,EAkDA,IAAA+F,kBACAqJ,SAAA,UACA3P,MAAA,UACA4P,SAAA,UACAC,UAAA,EACAC,QAAAtN,MAAAuN,aAGAC,YAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,MACAC,WAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,KACAC,YAAA,IAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAoGArJ,QAAAgE,UAAA9J,WAAA,WAEA,GAGAqF,GAHA+J,EAAArJ,cAAA5H,KAAAa,MACA+O,EAAA5M,aAAAiO,EAAArB,SAAA3M,SAAAgO,EAAArB,SAAA1M,MAAAlD,KAAAoB,OAAA6P,EAAArB,SAAAzM,IAAA8N,EAAArB,SAAAxM,GAIA8D,GADA,MAAAlH,KAAAa,KACAyG,gBAAAtH,KAAAc,MAAAd,KAAAe,IAAAM,MAAA,EAAArB,KAAAe,IAAAM,OACA,QAAArB,KAAAa,KACA8E,kBAAA3F,KAAAc,MAAAkQ,WAAAhR,KAAAe,IAAAM,MAAA,EAAArB,KAAAe,IAAAM,OACA,OAAArB,KAAAa,KACA8E,kBAAA3F,KAAAc,MAAAiQ,UAAA/Q,KAAAe,IAAAM,MAAA,EAAArB,KAAAe,IAAAM,OAEAsE,kBAAA3F,KAAAc,MAAAgQ,WAAA9Q,KAAAe,IAAAM,MAAA,EAAArB,KAAAe,IAAAM,MAGA,IAAA6P,GAAA,GAAA5N,OAAA6N,KAAAvB,EAAA,GAAAtM,OAAA8N,iBAAAlK,GAEAgK,GAAAG,YAAA,EACAH,EAAAI,eAAA,EAEAJ,EAAA3P,SAAAC,EAAA,GAAAxB,KAAAe,IAAAkB,EACAiP,EAAA3P,SAAAE,EAAA,GAAAzB,KAAAe,IAAAmB,EACAgP,EAAA3P,SAAAG,EAAA,EAEAwP,EAAAK,WAAA/P,EAAA,EACA0P,EAAAK,WAAA9P,EAAA,EACAyP,EAAAK,WAAA7P,EAAA,EACAwP,EAAAK,WAAAtP,EAAA,EAEAjC,KAAAsB,UAAA4P,EACAlR,KAAAe,IAAAsB,MAAAmP,IAAAN,IAGAvJ,OAAAgE,UAAAsD,OAAA,SAAAC,GAEAlP,KAAAsB,UAAAC,SAAAC,EAAA0N,EAAA,GAAAlP,KAAAe,IAAAkB,EAAA,IACAjC,KAAAsB,UAAAC,SAAAE,EAAAyN,EAAA,GAAAlP,KAAAe,IAAAmB,EAAA,IACAlC,KAAAsB,UAAAC,SAAAG,EAAAwN,EAAA,GAEAlP,KAAAsB,UAAAiQ,WAAA/P,EAAA0N,EAAA,GACAlP,KAAAsB,UAAAiQ,WAAA9P,EAAAyN,EAAA,GACAlP,KAAAsB,UAAAiQ,WAAA7P,EAAAwN,EAAA,GACAlP,KAAAsB,UAAAiQ,WAAAtP,EAAAiN,EAAA,IAGAvH,OAAAgE,UAAA8D,OAAA,WACAzP,KAAAe,IAAAsB,MAAAoN,OAAAzP,KAAAsB,iBACAtB,MAAAe,IAAAuB,MAAAtC,KAAAY,KAuBAoH,QAAA2D,UAAA8F,OAAA,WAEAzR,KAAAiC,EAAA8I,OAAAC,WACAhL,KAAAkC,EAAA6I,OAAAE,YACAjL,KAAAmC,GAAAnC,KAAAiC,EAAA,EACAjC,KAAAoC,GAAApC,KAAAkC,EAAA,EACAlC,KAAAiI,OAAA/D,KAAAwN,IAAA1R,KAAAmC,GAAAnC,KAAAiC,EAAAjC,KAAAoC,GAAApC,KAAAkC,GACAlC,KAAAqB,MAAA6C,KAAAwL,KAAA1P,KAAAiC,EAAAjC,KAAAiC,EAAAjC,KAAAkC,EAAAlC,KAAAkC,GAAA,EAEA,IAAAyP,GAAAzN,KAAAwN,IAAA1R,KAAAmC,GAAAnC,KAAAoC,IAAApC,KAAAiI,OAAA/D,KAAA0N,IAAA,GAAA1N,KAAAC,GAAA,IACAnE,MAAA+H,OAAAE,OAAAjI,KAAAmC,GAAAnC,KAAAoC,GACApC,KAAA+H,OAAA8J,IAAA,IAAAF,EACA3R,KAAA+H,OAAAxG,SAAAG,EAAAiQ,EACA3R,KAAA+H,OAAA+J,wBAEA,IAAAC,GAAA7N,KAAA8N,IAAAhS,KAAAiC,EAAAjC,KAAAkC,EACAlC,MAAAmI,MAAA5G,SAAA0Q,KAAAF,EAAA,EAAAA,EAAA,EAAA,EAAAA,GACA/R,KAAAmI,MAAA+J,OAAA3Q,SAAA0Q,IAAA,EAAA,EAAA,GAEAjS,KAAA6H,SAAAsK,QAAAnS,KAAAiC,EAAAjC,KAAAkC,IAGA8F,QAAA2D,UAAAjL,KAAA,WAEA,GAAA2M,GAAArN,IAEAA,MAAAmC,GAAAnC,KAAAiC,EAAA,EACAjC,KAAAoC,GAAApC,KAAAkC,EAAA,EAEAlC,KAAAiI,OAAA/D,KAAAwN,IAAA1R,KAAAmC,GAAAnC,KAAAiC,EAAAjC,KAAAoC,GAAApC,KAAAkC,GACAlC,KAAAqB,MAAA6C,KAAAwL,KAAA1P,KAAAiC,EAAAjC,KAAAiC,EAAAjC,KAAAkC,EAAAlC,KAAAkC,GAAA,GAEAlC,KAAA6H,SAAAkD,OAAAqH,sBACA,GAAA9O,OAAA+O,eAAAC,WAAA,EAAAC,OAAA,IACA,GAAAjP,OAAAkP,gBAAAF,WAAA,EAAAC,OAAA,IACAvS,KAAA6H,SAAAsK,QAAA,EAAAnS,KAAAmC,GAAA,EAAAnC,KAAAoC,IACApC,KAAA6H,SAAA4K,kBAAA,EACAzS,KAAA6H,SAAA6K,eAAA,EACA1S,KAAA6H,SAAA8K,cAAA,EAAA,GAEA3S,KAAAsC,SACAtC,KAAAqC,MAAA,GAAAiB,OAAAsP,MACA5S,KAAAqC,MAAAwQ,IAAA,KAEAvS,EAAA,aAAAkM,OAAAxM,KAAA6H,SAAAiL,WAEA,IAAAnB,GAAAzN,KAAAwN,IAAA1R,KAAAmC,GAAAnC,KAAAoC,IAAApC,KAAAiI,OAAA/D,KAAA0N,IAAA,GAAA1N,KAAAC,GAAA,IACAnE,MAAA+H,OAAA,GAAAzE,OAAAyP,kBAAA,GAAA/S,KAAAmC,GAAAnC,KAAAoC,GAAA,EAAA,IAAAuP,GACA3R,KAAA+H,OAAAxG,SAAAG,EAAAiQ,CAEA,IAAAqB,GAAA,GAAA1P,OAAA2P,aAAA,QACAjT,MAAAqC,MAAAmP,IAAAwB,EAEA,IAAAjB,GAAA7N,KAAA8N,IAAAhS,KAAAiC,EAAAjC,KAAAkC,EACAlC,MAAAmI,MAAA,GAAA7E,OAAA4P,UAAA,UACAlT,KAAAmI,MAAA5G,SAAA0Q,KAAAF,EAAA,EAAAA,EAAA,EAAA,EAAAA,GACA/R,KAAAmI,MAAA+J,OAAA3Q,SAAA0Q,IAAA,EAAA,EAAA,GACAjS,KAAAmI,MAAAkJ,YAAA,EACArR,KAAAmI,MAAAgL,iBAAApB,EAAA,GACA/R,KAAAmI,MAAAiL,gBAAA,EAAArB,EACA/R,KAAAmI,MAAAkL,gBAAA,GACArT,KAAAmI,MAAAmL,WAAA,KACAtT,KAAAmI,MAAAoL,eAAA,GACAvT,KAAAmI,MAAAqL,eAAA,KACAxT,KAAAmI,MAAAsL,gBAAA,KACAzT,KAAAqC,MAAAmP,IAAAxR,KAAAmI,MAEA,IAAAuL,IAEA,wBACA,yBAEApQ,MAAAqQ,YAAA,oBACArQ,MAAAqQ,YAAA,kBACArQ,MAAAqQ,YAAA,uBACArQ,MAAAqQ,YAAA,qBACArQ,MAAAqQ,YAAA,kBACArQ,MAAAqQ,YAAA,wBACArQ,MAAAqQ,YAAA,0BAEA,gBAEA,6CAEArQ,MAAAqQ,YAAA,aACArQ,MAAAqQ,YAAA,mBACArQ,MAAAqQ,YAAA,qBACArQ,MAAAqQ,YAAA,kBACArQ,MAAAqQ,YAAA,eACArQ,MAAAqQ,YAAA,gBACArQ,MAAAqQ,YAAA,mBACArQ,MAAAqQ,YAAA,yBACArQ,MAAAqQ,YAAA,aAEA,6DAEA,KAEAC,KAAA,MAEAC,EAAA,GAAAvQ,OAAAwQ,gBACAC,SAAAzQ,MAAA0Q,UAAA,MAAAD,SACAE,aAAA3Q,MAAA0Q,UAAA,MAAAC,aACAC,eAAAR,EACA5S,MAAA,KAGAd,MAAAkI,KAAA,GAAA5E,OAAA6N,KAAA,GAAA7N,OAAA6Q,cAAA,EAAAnU,KAAAiC,EAAA,EAAAjC,KAAAkC,EAAA,EAAA,GAAA2R,GACA7T,KAAAkI,KAAAoJ,eAAA,EACAtR,KAAAqC,MAAAmP,IAAAxR,KAAAkI,MAEA6C,OAAAqJ,iBAAA,QAAApU,KAAAyR,OAAA4C,KAAArU,OAEAA,KAAAF,KAAA0K,OAAA0D,GAAA,aAAA,SAAAjC,GACA,IAAA,GAAAtJ,GAAA,EAAAA,EAAAsJ,EAAArJ,OAAAD,IACA0K,EAAA/K,MAAA2J,EAAAtJ,GAAA/B,IAAA,GAAA+G,QAAAsE,EAAAtJ,GAAA/B,GAAAqL,EAAAtJ,GAAA9B,KAAAoL,EAAAtJ,GAAA7B,MAAAuM,KAIArN,KAAAF,KAAA0K,OAAA0D,GAAA,cAAA,SAAAjC,GACA,IAAA,GAAAtJ,KAAAsJ,GACAoB,EAAA/K,MAAAK,IAAA0K,EAAA/K,MAAAK,GAAAsM,OAAAhD,EAAAtJ,GAEA0K,GAAAxF,SAAAC,OAAAuF,EAAAhL,MAAAgL,EAAAtF,UAGA/H,KAAAF,KAAA0K,OAAA0D,GAAA,WAAA,SAAAjC,GACA,IAAA,GAAAtJ,GAAA,EAAAA,EAAAsJ,EAAArJ,OAAAD,IACA0K,EAAA/K,MAAA2J,EAAAtJ,KAAA0K,EAAA/K,MAAA2J,EAAAtJ,IAAA8M,QAEApC,GAAAxF,SAAAC,OAAAuF,EAAAhL,MAAAgL,EAAAtF,WAIAC,QAAA2D,UAAA8D,OAAA,WACAzP,KAAAF,KAAA0K,OAAAiE,mBAAA,cACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,aC3cArG,KAAAuD,UAAAgB,KAAA,WACA,GAAAU,GAAArN,OACAA,KAAAqI,MACArI,KAAAuI,MAAA+L,SAAA,YACAhH,aAAAtN,KAAAsI,UACAtI,KAAAsI,SAAAiF,WAAA,WAAAF,EAAA9E,MAAAgM,YAAA,aAAA,MAcA9L,MAAAkD,UAAA6I,OAAA,WAEAxU,KAAAsC,UAIAmG,MAAAkD,UAAA8I,KAAA,WAEAzU,KAAA0U,MACA,IAAAC,GAAA3U,KAAA2U,SACA/R,EAAA5C,KAAAsC,MAAAM,OAAA+R,EAAAA,EAAA3U,KAAAsC,MAAAM,MACA5C,MAAA0I,OAAAkM,SAAA,SAAAC,SACA7U,KAAA0I,OAAA,GAAAoM,UAAA,SAAAlS,CAEA,KAAA,GAAAD,GAAA,EAAAA,EAAAC,EAAAD,IACA3C,KAAA0I,OAAA8D,OAAAxM,KAAAsC,MAAAK,GAAA4F,QAKAE,MAAAkD,UAAA+I,KAAA,WAEA1U,KAAAsC,MAAAoS,KAAA,SAAAxE,EAAAxK,GAAA,MAAAA,GAAA2C,MAAA6H,EAAA7H,SAIAI,MAAAkD,UAAAgB,KAAA,SAAA7B,GAGAA,EAAAA,EAAA3J,MAAA,KACA,KAAA2J,EAAA,KACAA,EAAA,GAAA,IACAA,EAAAA,EAAA8I,KAAA,IAGA,KAAA,GADAmB,IAAA,EACApS,EAAA3C,KAAAsC,MAAAM,OAAA,EAAAD,GAAA,EAAAA,IACA,GAAA3C,KAAAsC,MAAAK,GAAA9B,MAAAiK,EAAA,CACAiK,GAAA,EACA/U,KAAAsC,MAAAK,GAAAgK,MACA,OAIAoI,GACA/U,KAAAsC,MAAAwB,KAAA,GAAAsE,MAAA0C,IAGA9K,KAAAyU,QAGAhM,MAAAkD,UAAAgJ,OAAA,WAEA,MAAAzQ,MAAA8N,IAAA9N,KAAAwN,IAAAxN,KAAA8Q,MAAA,IAAA1U,EAAAyK,QAAAhJ,QAAA,IAAA,GAAA,IAGA0G,MAAAkD,UAAAjL,KAAA,WAEA,GAAA2M,GAAArN,IAEAM,GAAAyK,QAAAmD,GAAA,eAAA,WACAb,EAAAoH,SAGAnU,EAAA+F,UAAA6H,GAAA,cAAA,QAAA,SAAAC,GACAA,EAAAC,gBACA,IAAA6G,GAAA3U,EAAAN,KACA,KAAAiV,EAAAC,SAAA,YAAA,CACAD,EAAAX,SAAA,WACA,IAAAxJ,GAAAmK,EAAAxI,MACAY,GAAAvN,KAAA0K,OAAAiD,KAAA,OAAA,SAAA3C,OAKArC,MAAAkD,UAAA4C,QAAA,WAEAjO,EAAAyK,QAAAyD,IAAA,UACAlO,EAAA+F,UAAAmI,IAAA,WC7FA7F,OAAAgD,UAAA8I,KAAA,SAAAxI,GACA3L,EAAA,UAAA2L,EAAArL,IAAA6L,KAAA,mCAAAR,EAAAkJ,IAAA,UAAAlJ,EAAAxB,KAAA,YAAAwB,EAAAxB,KAAA,OAGA9B,OAAAgD,UAAAyJ,MAAA,WAEApV,KAAA6I,QAEA7I,KAAA6I,MAAA2F,IAAA,WACAxO,KAAA6I,MAAA4G,SACAzP,KAAA6I,MAAA,OAIAF,OAAAgD,UAAA0J,KAAA,SAAAC,GAEA,IAAAtV,KAAA6I,MACA,CACA,GAAAwE,GAAArN,IACAA,MAAA6I,MAAAvI,EAAA,+FAAAgV,EAAA,yBACAhV,EAAA,QAAAkM,OAAAxM,KAAA6I,OACA7I,KAAA6I,MAAAqF,GAAA,eAAA,WACAb,EAAA+H,YAKAzM,OAAAgD,UAAA4J,OAAA,SAAA3M,GAEA,GAAA,SAAAA,EAAA/H,KAAAM,MAAA,KAAAqU,QACA,CACA,GAAAnI,GAAArN,IACAyV,QAAA,GAAAC,YACAD,OAAAE,OAAA,SAAAC,GACAvI,EAAAvN,KAAA0K,OAAAiD,KAAA,eAAA7E,EAAA6B,KAAAmL,EAAA1D,OAAA1C,SAEAiG,OAAAI,cAAAjN,KAIAD,OAAAgD,UAAAmK,SAAA,SAAAlV,GACAZ,KAAAF,KAAA0K,OAAAiD,KAAA,iBAAA7M,IAGA+H,OAAAgD,UAAAjL,KAAA,WAEA,GAAA2M,GAAArN,IAEAM,GAAA,QACA4N,GAAA,kBAAA,SAAAC,GACAA,EAAAC,mBAEAF,GAAA,cAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAkI,OAAApH,EAAA4H,cAAAC,aAAAC,MAAA,MAEA/H,GAAA,eAAA,YAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAgI,KAAA/U,EAAAN,MAAAkW,KAAA,UAEAhI,GAAA,eAAA,eAAA,SAAAC,GACAA,EAAAC,iBACA9N,EAAAN,MAAAwM,OAAA,0CACAa,EAAAyI,SAAAxV,EAAAN,MAAAkW,KAAA,iBAGAlW,KAAAF,KAAA0K,OAAA0D,GAAA,QAAA,SAAAjC,GACAoB,EAAAoH,KAAAxI,MAIAtD,OAAAgD,UAAA4C,QAAA,WAEAvO,KAAAoV,QACA9U,EAAA,QAAAkO,IAAA,YIpFA,WAaA,QAAA2H,GAAAzK,EAAA5L,EAAA4K,EAAA0L,GAEA,MAAA,IAAAtW,GAAA,IAAA4K,IAAA2L,IAGAA,GAAA,EACA3K,EAAAc,OAAA,mFACAhC,GAAAiD,KAAA2I,GAAAtW,KAAAA,EAAA4K,KAAAA,KAIA,QAAA4L,KAGA,MADAH,GAAA7V,EAAA,SAAAA,EAAA,SAAAsN,MAAAtN,EAAA,SAAAsN,MAAA,cACA,EAIA,QAAA2I,KAGA,MADAJ,GAAA7V,EAAA,WAAAA,EAAA,SAAAsN,MAAAtN,EAAA,SAAAsN,MAAA,gBACA,EAIA,QAAAlN,KAGA8J,EAAA0D,GAAA,QAAA,SAAAjC,GAIA,MAHAoK,IAAA,EACA/V,EAAA,YAAAmP,SAEAxD,EAAAuK,QAKA1W,EAAA,GAAAyK,MAAAC,EAAAyB,EAAAnM,KAAA2K,KAAAwB,EAAAvB,KAAAuB,EAAAnM,KAAA6K,MAAAsB,EAAAnM,KAAAC,SAAAkM,EAAAnM,KAAA2W,UACAC,QAAAzE,IAAA,QAAAhG,EAAAnM,KAAA2K,KAAA,IAAAwB,EAAAvB,KAAAD,MAAAkM,QAAA,UAEArW,GAAA,kBAAAsW,QAAA,UAPAtW,GAAA,cAAAmM,KAAAR,EAAAc,OAAAuH,SAAA,WAWAhU,EAAA,UAAAuW,OAAAP,GACAhW,EAAA,SAAAwW,MAAAR,GACAhW,EAAA,WAAAwW,MAAAP,EAGA,IAAAQ,GAAAL,QAAAM,IAAA,QACA,IAAAD,EAAA,CACA,GAAAE,GAAAF,EAAA5V,MAAA,IACAgV,GAAA7V,EAAA,SAAA2W,EAAA,GAAAA,EAAA,GAAA,cA3DA,GAIAnX,GAJAoX,EAAAC,WACAhC,EAAA+B,EAAA/B,KAAA,wBACA3K,EAAA4M,GAAAjC,GAGAkB,GAAA,CA0DAtL,QAAAqJ,iBAAA,mBAAA1T,MH7DAoI,YAAA6C,UAAAjL,KAAA,WACA,GAAA2M,GAAArN,IACAqG,UAAAgR,KAAAC,YAAAtX,KAAAgJ,OACAhJ,KAAAgJ,MAAAuO,UAAA,EACAvX,KAAAgJ,MAAAwO,MAAA,EAEAnK,EAAAtE,MAAAjJ,KAAA4K,KAAAyB,OACA7L,EAAAmX,KAAA,iBAAA,SAAAxL,GACAoB,EAAAtE,MAAAuB,YAAAF,KAAA,mBAAAoC,OAAAa,EAAAqK,WAAAzL,IAEA3L,EAAA,QAAA4N,GAAA,cAAA,iBAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAsK,KAAArX,EAAAN,MAAA4X,SAAAA,UAAA,KAGAtX,EAAA,QAAA4N,GAAA,cAAA,iBAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAsK,KAAArX,EAAAN,MAAA4X,SAAAA,UAAA,KAGAtX,EAAA,QAAA4N,GAAA,cAAA,qBAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAA5D,SAAAnJ,EAAAN,MAAA4X,SAAAA,UAAA,KAGAtX,EAAA,QAAA4N,GAAA,cAAA,qBAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAA5D,SAAAnJ,EAAAN,MAAA4X,SAAAA,UAAA,QAMA9O,YAAA6C,UAAAgM,KAAA,SAAAE,EAAArG,GACA,GAAAnE,GAAArN,IACAqN,GAAAtE,MAAAuB,YAAAsM,QAAA,IACA,IAAAkB,IACAjX,KAAA,QACA2Q,IAAAA,EACA2D,KAAA0C,EAAA3B,KAAA,cAEA7I,GAAAtE,MAAAjJ,KAAA0K,OAAAiD,KAAA,QAAAqK,IAGAhP,YAAA6C,UAAAlC,SAAA,SAAAoO,EAAArG,GACA,GAAAnE,GAAArN,KACA8X,GACAjX,KAAA,QACA2Q,IAAAA,EACA2D,OAEA9H,GAAAtE,MAAAuB,YAAAsM,QAAA,KACAiB,EAAAE,KAAA,SAAAA,KAAA,SAAAA,KAAA,MAAA3N,KAAA,SAAA4N,KAAA,WACAF,EAAA3C,IAAArR,KAAAxD,EAAAN,MAAAkW,KAAA,gBAGA7I,EAAAtE,MAAAjJ,KAAA0K,OAAAiD,KAAA,QAAAqK,IAGAhP,YAAA6C,UAAA+L,WAAA,SAAAjO,KACAzJ,KAAAkJ,KACA,IAAA+O,GAAA,EACAA,IAAA,kCAAAxO,EAAAyO,MAAA,2FACAD,GAAA,oBAAAjY,KAAAkJ,MAAA,sBAAA,GAAAlJ,KAAAkJ,MAAA,UAAA,IAAA,2BACA+O,GAAA,qBAAAjY,KAAAkJ,MAAA,sDACA+O,GAAA,4BACA,KAAA,GAAAtV,GAAA,EAAAA,EAAA8G,EAAAqO,MAAAlV,OAAAD,IAEAsV,GADA,YAAAxO,EAAAqO,MAAAnV,GAAA9B,KACA,OAAAb,KAAA0X,WAAAjO,EAAAqO,MAAAnV,IAAA,QAEA,+CAAA8G,EAAAqO,MAAAnV,GAAAwS,IAAA,KAAA1L,EAAAqO,MAAAnV,GAAAuV,MAAA,0FAKA,OAFAD,IAAA,SAKAnP,YAAA6C,UAAAwM,MAAA,SAAAC,GACApY,KAAAgJ,MAAAsM,IAAA8C,EAAAjD,IACAnV,KAAAqY,QAGAvP,YAAA6C,UAAA2M,MAAA,WACAtY,KAAAgJ,MAAAsP,SAGAxP,YAAA6C,UAAA0M,KAAA,WACArY,KAAAgJ,MAAAqP,QAGAvP,YAAA6C,UAAA4M,OAAA,SAAAC,GACAxY,KAAAgJ,MAAAuP,OAAArU,KAAA8N,IAAA,EAAA9N,KAAAwN,IAAA8G,EAAA,KAGA1P,YAAA6C,UAAA4C,QAAA,WACAkK,QAAAC,IAAA1Y,KAAAgJ,OACAhJ,KAAAgJ,MAAA2P,WAAAC,YAAA5Y,KAAAgJ,QAeAG,cAAAwC,UAAAjL,KAAA,WAqBA,QAAAmY,GAAAC,GACAL,QAAAC,IAAA,gBAEArL,EAAAtE,MAAAjJ,KAAA4K,KAAAyB,QACAkB,EAAAtE,MAAAuB,YAAAF,KAAA,qBAAAoC,OACA,iYAQAa,EAAAhE,UAAA/I,EAAA,cACA+M,EAAA/D,WAAAhJ,EAAA,eACA+M,EAAA9D,SAAAjJ,EAAA,aAEA+M,EAAA9D,SAAA2E,GAAA,cAAA,SAAAC,GACAA,EAAAC,gBACA,IAAApN,GAAAqM,EAAAhE,UAAA,GAAArI,MACA+X,EAAA1L,EAAA2L,SAAAhY,EACA+X,GAAAvH,KAAA,EACAnE,EAAAtE,MAAAuB,YAAAsM,QAAA,KACAvJ,EAAAtE,MAAAjJ,KAAA0K,OAAAiD,KAAA,QAAAsL,KAIA1L,EAAA/D,WAAA4E,GAAA,cAAA,SAAAC,GACAA,EAAAC,gBACA,IAAApN,GAAAqM,EAAAhE,UAAA,GAAArI,MACA+X,EAAA1L,EAAA2L,SAAAhY,EACA+X,GAAAvH,KAAA,EACAnE,EAAAtE,MAAAuB,YAAAsM,QAAA,KACAvJ,EAAAtE,MAAAjJ,KAAA0K,OAAAiD,KAAA,QAAAsL,MAOA,QAAAE,GAAAH,GAEAA,EAAA7M,MAAAiN,GAAAC,YAAAC,UACA/L,EAAAxJ,MAAAiV,EAAA5G,OAAAmH,oBACAP,EAAA7M,MAAAiN,GAAAC,YAAAG,OAAAjM,EAAAxJ,OAAAiV,EAAA5G,OAAAqH,cAAA3W,OAAA,GACAyK,EAAAtE,MAAAgP,OAjEA,GAAA1K,GAAArN,KAGAwZ,EAAAnT,SAAAC,cAAA,SACAkT,GAAAlE,IAAA,oCACA,IAAAmE,GAAApT,SAAAqT,qBAAA,UAAA,EACAD,GAAAd,WAAAgB,aAAAH,EAAAC,GAEA1O,OAAA6O,wBAAA,WACAvM,EAAAjE,QAAA,GAAA8P,IAAAW,OAAA,aACA7X,OAAA,IACAD,MAAA,IACA+X,QACAC,QAAAlB,EACAmB,cAAAf,OAyDA9P,cAAAwC,UAAAqN,SAAA,SAAA7D,GAEA,GAAAtU,GAAA,OAWA,OAVAsU,GAAAhI,QAAA,cACAgI,EAAAA,EAAAjU,QAAA,UAAA,IAAAC,MAAA,4CACAN,EAAA,YAEAsU,EAAAA,EAAAjU,QAAA,UAAA,IAAAC,MAAA,yCAGAgF,SAAAgP,EAAA,KACAA,EAAAA,EAAA,GAAAhU,MAAA,mBAGAgU,IAAAA,EAAA,GACAtU,KAAAA,IAIAsI,cAAAwC,UAAAwM,MAAA,SAAAC,GACA,YAAAA,EAAAvX,KAAAb,KAAAoJ,QAAA6Q,cAAAC,KAAA9B,EAAAjD,MACAnV,KAAAoJ,QAAA6Q,aAAA7B,EAAAjD,MAGAhM,cAAAwC,UAAA2M,MAAA,WACAtY,KAAAoJ,QAAA+Q,cAGAhR,cAAAwC,UAAA0M,KAAA,WACArY,KAAAoJ,QAAAgR,aAGAjR,cAAAwC,UAAA4M,OAAA,SAAAC,GACAxY,KAAAoJ,QAAAiR,UAAA,IAAAnW,KAAA8N,IAAA,EAAA9N,KAAAwN,IAAA8G,EAAA,MAGArP,cAAAwC,UAAA4C,QAAA,WACAvO,KAAAoJ,QAAAmF,UACAvO,KAAA+I,MAAAjJ,KAAA4K,KAAAyB,QACAnM,KAAAuJ,SAAAiF,IAAA,UACAxO,KAAAsJ,WAAAkF,IAAA,YA0BAhF,MAAAmC,UAAA2O,KAAA,SAAArO,GAGA,GADAwM,QAAAC,IAAA,OAAAzM,GACAA,EAAAuF,IAAA,CACA,GAAA,SAAAvF,EAAApL,KACA,IAAA,GAAA8B,GAAA,EAAA4X,EAAAtO,EAAAkJ,IAAAvS,OAAAD,EAAA4X,EAAA5X,IACA3C,KAAAyJ,SAAA3F,MAAAjD,KAAAoL,EAAApL,KAAA2Q,IAAAvF,EAAAuF,IAAA2D,IAAAlJ,EAAAkJ,IAAAxS,SAEA3C,MAAAyJ,SAAA3F,KAAAmI,EAGA,IAAAjM,KAAAyJ,SAAA7G,SACA5C,KAAA0J,QAAA,EACA1J,KAAAmY,aAEA,CAEA,GADAnY,KAAAyJ,YACA,SAAAwC,EAAApL,KACA,IAAA,GAAA8B,GAAA,EAAA4X,EAAAtO,EAAAkJ,IAAAvS,OAAAD,EAAA4X,EAAA5X,IACA3C,KAAAyJ,SAAA3F,MAAAjD,KAAAoL,EAAApL,KAAA2Q,IAAAvF,EAAAuF,IAAA2D,IAAAlJ,EAAAkJ,IAAAxS,SAEA3C,MAAAyJ,SAAA3F,KAAAmI,EAEAjM,MAAA0J,QAAA,EACA1J,KAAAmY,UAIA3O,MAAAmC,UAAAwM,MAAA,WAEAM,QAAAC,IAAA1Y,KAAAyJ,UACA,IAAAzJ,KAAAyJ,SAAA7G,SAEA,SAAA5C,KAAAyJ,SAAAzJ,KAAA0J,SAAA7I,KACAb,KAAA+J,OAAA/J,KAAA6J,YAEA7J,KAAA+J,OAAA/J,KAAA8J,cAEA9J,KAAA+J,OAAAoO,MAAAnY,KAAAyJ,SAAAzJ,KAAA0J,UACA1J,KAAAqY,SAGA7O,MAAAmC,UAAAoM,KAAA,aAEA/X,KAAA0J,SAAA1J,KAAAyJ,SAAA7G,SACA5C,KAAA0J,QAAA,GACA1J,KAAAmY,SAGA3O,MAAAmC,UAAA0M,KAAA,WAEArY,KAAAgK,MACAuK,YAAA,WACAD,SAAA,YACAtU,KAAA+J,OAAAsO,OACArY,KAAAuY,OAAAvY,KAAA4J,gBAGAJ,MAAAmC,UAAA2M,MAAA,WAEAtY,KAAAgK,MACAuK,YAAA,YACAD,SAAA,WACAtU,KAAA+J,OAAAuO,SAGA9O,MAAAmC,UAAA4M,OAAA,SAAAA,GAEAA,EAAArU,KAAAwN,IAAAxN,KAAA8N,IAAAuG,EAAA,GAAA,EAEA,IAAArM,GAAA,KAEAA,IADA,GAAAqM,EACA,gBACAA,EAAA,GACA,iBAEA,eAGAvY,KAAAiK,MAAA,GAAA6K,UAAA5I,EAEAlM,KAAAmK,KAAAuE,IAAA,QAAA,IAAA6J,EAAA,KAEAvY,KAAA+J,QACA/J,KAAA+J,OAAAwO,OAAA,GAAAA,GACAvY,KAAA4J,cAAA2O,GAGA/O,MAAAmC,UAAA6O,KAAA,WAEAxa,KAAA2J,YAAA3J,KAAA4J,cACA5J,KAAAuY,OAAA,IAGA/O,MAAAmC,UAAA8O,OAAA,WAEAza,KAAAuY,OAAAvY,KAAA2J,aACA3J,KAAA2J,YAAA,GAGAH,MAAAmC,UAAAjL,KAAA,WAEA,GAAA2M,GAAArN,IAEAqN,GAAAvD,cAAA,GAAAX,eAAAkE,GACAA,EAAAxD,YAAA,GAAAf,aAAAuE,GAEAA,EAAAkL,OAAA,IAEAlL,EAAAnD,QAAAgE,GAAA,kBAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAkL,OAAArU,KAAA8Q,MAAA7G,EAAAuM,QAAApa,EAAAN,MAAA+B,QAAA,KAAA,KACAzB,EAAAyK,QAAAmD,GAAA,kBAAA,SAAAC,GACA,GAAAwM,GAAAxM,EAAAyM,QAAAvN,EAAAnD,QAAAyQ,SAAA/L,IACAvB,GAAAkL,OAAArU,KAAA8Q,MAAA2F,EAAAtN,EAAAnD,QAAAnI,QAAA,KAAA,SAIAsL,EAAApD,MAAAiE,GAAA,cAAA,WACA,GAAAb,EAAA1D,YACA0D,EAAAmN,OAEAnN,EAAAoN,WAIAna,EAAAyK,QAAAmD,GAAA,gBAAA,WACA5N,EAAAyK,QAAAyD,IAAA,qBAGAnB,EAAAvN,KAAA0K,OAAA0D,GAAA,QAAA,SAAAjC,GACAoB,EAAAiN,KAAArO,KAGAoB,EAAAvN,KAAA0K,OAAA0D,GAAA,cAAA,WACAb,EAAAiL,UAGAjL,EAAAvN,KAAA0K,OAAA0D,GAAA,aAAA,WACAb,EAAAgL,SAGAhL,EAAAvN,KAAA0K,OAAA0D,GAAA,eAAA,SAAAjC,GACAoB,EAAAkL,OAAAtM,KAGAoB,EAAAvN,KAAA4K,KAAAyB,QAEA7L,EAAA,iBAAAkM,OAAA,oFAEAlM,EAAA,iBAAAkM,OAAA,0RAQAa,EAAAhD,aAAA/J,EAAA,iBACA+M,EAAA/C,YAAAhK,EAAA,mBAEA+M,EAAAhD,aAAA6D,GAAA,cAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAAvN,KAAA4K,KAAAyB,OACAkB,EAAA/C,YAAAuQ,OAAA,OAIAxN,EAAArD,MAAAkE,GAAA,cAAA,SAAAC,GAEA,GADAA,EAAAC,iBACAf,EAAAvN,KAAA4K,KAAAyB,MACA,CACA,GAAA8I,GAAA3U,EAAAN,KACAiV,GAAAC,SAAA,WACA7H,EAAAtD,OACAsD,EAAAvN,KAAA0K,OAAAiD,KAAA,cAEAJ,EAAA/C,YAAAuQ,OAAA,KAGAxN,EAAAvN,KAAA0K,OAAAiD,KAAA,kBAKAnN,EAAA,QAAA4N,GAAA,cAAA,wBAAA,WACAb,EAAA/C,YAAAsM,QAAA,SAKApN,MAAAmC,UAAA4C,QAAA,WAEAvO,KAAA8J,cAAAyE,UACAvO,KAAA6J,YAAA0E,UAEAvO,KAAAkK,QAAAsE,IAAA,UACAxO,KAAAiK,MAAAuE,IAAA,UACAxO,KAAAgK,MAAAwE,IAAA,UACAlO,EAAA,QAAAkO,IAAA,UACAlO,EAAAyK,QAAAyD,IAAA,UAEAxO,KAAAF,KAAA0K,OAAAiE,mBAAA,SACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,cACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,gBAEAzO,KAAAF,KAAA4K,KAAAyB,QACAnM,KAAAqK,aAAAoF,SACAzP,KAAAsK,YAAAmF,WI5cA,SAAAqL,GACA,GAAA,kBAAAC,SAAAA,OAAAC,IACAD,OAAAD,OACA,IAAA,gBAAAG,SACAC,OAAAD,QAAAH,QACA,CACA,GAAAK,GAAApQ,OAAA2L,QACA0E,EAAArQ,OAAA2L,QAAAoE,EAAA/P,OAAAsQ,OACAD,GAAAE,WAAA,WAEA,MADAvQ,QAAA2L,QAAAyE,EACAC,KAGA,WACA,QAAAG,KAGA,IAFA,GAAA5Y,GAAA,EACA6M,KACA7M,EAAA6Y,UAAA5Y,OAAAD,IAAA,CACA,GAAA8Y,GAAAD,UAAA7Y,EACA,KAAA,GAAA+Y,KAAAD,GACAjM,EAAAkM,GAAAD,EAAAC,GAGA,MAAAlM,GAGA,QAAA9O,GAAAib,GACA,QAAAP,GAAAM,EAAA1a,EAAAya,GACA,GAAAjM,EAIA,IAAAgM,UAAA5Y,OAAA,EAAA,CAKA,GAJA6Y,EAAAF,GACAK,KAAA,KACAR,EAAAS,SAAAJ,GAEA,gBAAAA,GAAA9E,QAAA,CACA,GAAAA,GAAA,GAAAvH,KACAuH,GAAAmF,gBAAAnF,EAAAoF,kBAAA,MAAAN,EAAA9E,SACA8E,EAAA9E,QAAAA,EAGA,IACAnH,EAAAwM,KAAAC,UAAAjb,GACA,UAAAkb,KAAA1M,KACAxO,EAAAwO,GAEA,MAAArB,IASA,MAPAnN,GAAAmb,mBAAAC,OAAApb,IACAA,EAAAA,EAAAE,QAAA,4DAAAmb,oBAEAX,EAAAS,mBAAAC,OAAAV,IACAA,EAAAA,EAAAxa,QAAA,2BAAAmb,oBACAX,EAAAA,EAAAxa,QAAA,UAAAob,QAEAjW,SAAA0Q,QACA2E,EAAA,IAAA1a,EACAya,EAAA9E,SAAA,aAAA8E,EAAA9E,QAAA4F,cACAd,EAAAG,MAAA,UAAAH,EAAAG,KACAH,EAAAe,QAAA,YAAAf,EAAAe,OACAf,EAAAgB,OAAA,WAAA,IACA7I,KAAA,IAKA8H,IACAlM,KAUA,KAJA,GAAAkN,GAAArW,SAAA0Q,OAAA1Q,SAAA0Q,OAAA5V,MAAA,SACAwb,EAAA,mBACAha,EAAA,EAEAA,EAAA+Z,EAAA9Z,OAAAD,IAAA,CACA,GAAAia,GAAAF,EAAA/Z,GAAAxB,MAAA,KACAsJ,EAAAmS,EAAA,GAAA1b,QAAAyb,EAAAN,oBACAtF,EAAA6F,EAAAC,MAAA,GAAAjJ,KAAA,IAEA,OAAAmD,EAAA+F,OAAA,KACA/F,EAAAA,EAAA8F,MAAA,MAGA,KAGA,GAFA9F,EAAA4E,GAAAA,EAAA5E,EAAAtM,IAAAsM,EAAA7V,QAAAyb,EAAAN,oBAEArc,KAAA+c,KACA,IACAhG,EAAAiF,KAAAjD,MAAAhC,GACA,MAAA5I;AAGA,GAAAuN,IAAAjR,EAAA,CACA+E,EAAAuH,CACA,OAGA2E,IACAlM,EAAA/E,GAAAsM,GAEA,MAAA5I,KAGA,MAAAqB,GAmBA,MAhBA4L,GAAApE,IAAAoE,EAAAnJ,IAAAmJ,EACAA,EAAA4B,QAAA,WACA,MAAA5B,GAAA6B,OACAF,MAAA,MACAF,MAAAK,KAAA1B,aAEAJ,EAAAS,YAEAT,EAAA3L,OAAA,SAAAiM,EAAAD,GACAL,EAAAM,EAAA,GAAAH,EAAAE,GACA9E,eAIAyE,EAAA+B,cAAAzc,EAEA0a,EAGA,MAAA1a,OAGA2a,OAAA+B,GAAAvP,eAAA,WAEA,MAAA7N,MAAAgY,KAAA,WAKA,GAHA1X,EAAAN,MAAA2N,QAGA3N,KAAAqd,kBAAA,CAIA,GAAAC,GAAA,EAAAhd,EAAAN,MAAA4N,MAAAhL,MAEA5C,MAAAqd,kBAAAC,EAAAA,OAMAhd,GAAAN,MAAA4N,IAAAtN,EAAAN,MAAA4N,MAMA5N,MAAA4M,UAAA,SAMA,IAAA/B,iBAAA,WACA,GAAA0S,IAAA,EACAC,GAAA,CACA,OAAA,YACA,IAAAA,EAAA,CACA,GAAAC,GAAA,KACArX,EAAAC,SAAAC,cAAA,SACA,KAAAmX,EAAArX,EAAAI,WAAA,SACA,MAAAhF,GAAAic,EAAA,KAEA,GAAA,MAAAA,EACA,IAAAA,EAAArX,EAAAI,WAAA,sBAAAkX,cAAA,EACA,MAAAlc,GAAAic,EAAA,KAMAF,IAHA,MAAAE,IAAA1S,OAAAqH,uBAMAhM,EAAA,KACAoX,GAAA,EAGA,MAAAD,MH5KAhT,MAAAoB,UAAAjL,KAAA,SAAAiK,GAEA,GAAA0C,GAAArN,IAEAA,MAAAqL,UAAApF,KAAAjG,KAAAyK,MAGAzK,KAAA0K,KAAAyB,OAEA7L,EAAA,QAAAgU,SAAA,gBAIAtU,KAAAsL,QAAA4C,GAAA,aAAA,SAAAC,GACAA,EAAAC,iBACAsI,QAAAjH,OAAA,SACApC,EAAAkB,UACAxD,OAAA4S,SAAAC,KAAA7S,OAAA4S,SAAAC,OAGA5d,KAAAwK,OAAA0D,GAAA,aAAA,WACAb,EAAAkB,UACAxD,OAAA4S,SAAAC,KAAA7S,OAAA4S,SAAAC,QAIArT,KAAAoB,UAAA4C,QAAA,WAEAjO,EAAA,QAAAiU,YAAA,gBACAvU,KAAAqL,UAAApF,KAAA,IACAjG,KAAAsL,QAAAkD,IAAA,SAEAxO,KAAAsC,MAAAiM,UACAvO,KAAA2K,MAAA4D,UACAvO,KAAAoL,KAAAmD,UACAvO,KAAA+I,MAAAwF,WC9CArD,MAAAS,UAAAkS,cAAA,SAAApT,GACA,IAAA,GAAA9H,GAAA3C,KAAA2K,MAAA/H,OAAA,EAAAD,GAAA,EAAAA,IACA,GAAA3C,KAAA2K,MAAAhI,GAAA8H,KAAAqT,eAAArT,EAAAqT,cACA,MAAA9d,MAAA2K,MAAAhI,EAGA,QAAA,GAGAuI,MAAAS,UAAAoS,YAAA,SAAAnd,GACA,IAAA,GAAA+B,GAAA3C,KAAA2K,MAAA/H,OAAA,EAAAD,GAAA,EAAAA,IACA,GAAA3C,KAAA2K,MAAAhI,GAAA/B,IAAAA,EACA,MAAAZ,MAAA2K,MAAAhI,EAGA,QAAA,GAGAuI,MAAAS,UAAAqS,aAAA,SAAApd,GACA,IAAA,GAAA+B,GAAA3C,KAAA2K,MAAA/H,OAAA,EAAAD,GAAA,EAAAA,IACA,GAAA3C,KAAA2K,MAAAhI,GAAA/B,IAAAA,EACA,MAAA+B,EAGA,WAGAuI,MAAAS,UAAAsS,SAAA,SAAAvT,GAEA,GAAAwB,GAAA,MACAxB,GAAAyB,QAAAD,GAAA,UACAxB,EAAAD,MAAAzK,KAAAF,KAAA4K,KAAAD,OAAAyB,GAAA,MAEA,IAAAgS,GACA,2YAQAC,EAAA,kBAAAzT,EAAA9J,GAAA,gBAAA8J,EAAA0T,MAAA,sBAAAlS,EAAA,cAAAxB,EAAA9J,GAAA,KAAA8J,EAAAD,KAAA,kCAAAyT,EAAA,OAEAxT,GAAAyB,MACAnM,KAAAyL,OAAA4S,QAAAF,GAEAne,KAAAyL,OAAAe,OAAA2R,GAGAne,KAAAse,cAAA5T,IAGAQ,MAAAS,UAAA4S,QAAA,SAAA7T,GAEAA,EAAAyB,MACAnM,KAAA2K,MAAA6T,QAAA9T,GAEA1K,KAAA2K,MAAA7G,KAAA4G,GAGA1K,KAAAie,SAAAvT,GACA1K,KAAAoe,SAGAlT,MAAAS,UAAA8S,WAAA,SAAA/T,GAEA,GAAA7G,GAAA7D,KAAAge,aAAAtT,EAAA9J,GACAiD,IAAA,GACA7D,KAAA2K,MAAA+T,OAAA7a,EAAA,GAEAvD,EAAA,SAAAoK,EAAA9J,IAAA6O,SACAzP,KAAAoe,SAGAlT,MAAAS,UAAA2S,cAAA,SAAA5T,GAGA,GADAiU,EAAA3e,KAAA+d,YAAArT,EAAA9J,IACA+d,EAAA,CACAA,EAAAC,OAAAlU,EAAAkU,MACA,IAAAC,GAAAve,EAAA,SAAAoK,EAAA9J,GAAA,iBACAke,EAAA,EAEA,KAAA,GAAAvO,KAAAoO,GAAAC,OACAE,GAAA,qBAAAvO,EAAA,gBAAA7F,EAAA9J,GAAA,iBAAA2P,EAAA,KAAAoO,EAAAC,OAAArO,GAAA,QAGA,KAAAuO,EACAD,EAAApS,KAAA,wCAEAoS,EAAApS,KAAAqS,KAKA5T,MAAAS,UAAAyB,YAAA,SAAA1C,GAEApK,EAAA,SAAAoK,EAAA9J,IAAA0T,SAAA,WAGApJ,MAAAS,UAAA6B,WAAA,SAAA9C,GAEApK,EAAA,SAAAoK,EAAA9J,IAAA2T,YAAA,WAGArJ,MAAAS,UAAAe,aAAA,SAAAhC,EAAAI,GAEAxK,EAAA,SAAAoK,EAAA9J,IAAAwJ,KAAA,cAAAqC,KAAA3B,IAGAI,MAAAS,UAAAoT,KAAA,SAAAlH,EAAAtW,GAEA,GAAA,OAAAvB,KAAAuL,SAAAvL,KAAAF,KAAA4K,KAAAyB,QAAA0L,EAAA3C,SAAA,SAAA,CAGA,GAAA8J,GAAAhf,IACAM,GAAA,QAAAgU,SAAA,YACAtU,KAAAwL,MAAAqM,EAAAoH,QACAvQ,KACAnN,SAAA,WACAoN,IAAA,IACAC,KAAA,IACA7M,MAAA8V,EAAAqH,aAAA,KACA5d,UAAA,aAAAC,EAAAC,EAAA,OAAAD,EAAAE,EAAA,QAEA0d,SAAA,QACAnf,KAAAuL,QAAAsM,EAAAvD,SAAA,YAEAhU,EAAA,QAAA4N,GAAA,mBAAA,SAAAC,GACAA,EAAAC,iBACA4Q,EAAAI,SAAA5d,EAAA2M,EAAAkR,MAAA5d,EAAA0M,EAAAmR,UAGAhf,EAAA,QAAA4N,GAAA,qBAAA,SAAAC,GACAA,EAAAC,iBACA4Q,EAAAO,UAAA/d,EAAA2M,EAAAkR,MAAA5d,EAAA0M,EAAAmR,YAIApU,MAAAS,UAAA4T,SAAA,SAAAhe,GAEA,GAAA,OAAAvB,KAAAuL,QAAA,CAGA,GAAAyT,GAAAhf,IACAA,MAAAwL,MAAAkD,IAAA,YAAA,aAAAnN,EAAAC,EAAA,OAAAD,EAAAE,EAAA,OAEAzB,KAAAwf,MAAAxH,KAAA,WACA,GAAA/C,GAAA3U,EAAAN,KACA,KAAAiV,EAAAC,SAAA,cAAAD,EAAAC,SAAA,SAAA,CACA,GAAAvG,GAAAsG,EAAA0F,SAAAhM,IACA3M,EAAAiT,EAAAwK,aACA,IAAA9Q,EAAApN,EAAAE,GAAAF,EAAAE,EAAAkN,EAAA3M,EAQA,YANAT,EAAAE,EAAAkN,EAAA3M,EAAA,EACAgd,EAAAzT,QAAAmU,MAAAzK,GAEA+J,EAAAzT,QAAAoU,OAAA1K,SASA/J,MAAAS,UAAAyT,QAAA,WAEA,OAAApf,KAAAuL,UAGAjL,EAAA,QAAAiU,YAAA,YACAvU,KAAAuL,QAAAgJ,YAAA,YACAvU,KAAAuL,QAAA,KACAvL,KAAAwL,MAAAiE,SACAzP,KAAAwL,MAAA,KACAlL,EAAA,QAAAkO,IAAA,aAEAxO,KAAAF,KAAA4K,KAAAyB,OACAnM,KAAA4f,aAGA1U,MAAAS,UAAAyS,MAAA,WAEA,GAAA/Q,GAAArN,IACAA,MAAAwf,MAAAxf,KAAAyL,OAAArB,KAAA,SAAAsK,KAAA,SAAAxE,EAAAxK,GACA,MAAAzE,UAAAX,EAAA4P,GAAAjE,KAAA,QAAA,IAAAhL,SAAAX,EAAAoF,GAAAuG,KAAA,QAAA,MACA+L,KAAA,SAAAnU,GACAvD,EAAAN,MAAAiM,KAAA,OACAoB,GAAA5B,OAAAe,OAAAlM,EAAAN,UAIAkL,MAAAS,UAAAiU,SAAA,WAEA,GAAA3T,KACAjM,MAAAwf,MAAAxf,KAAAyL,OAAArB,KAAA,SACApK,KAAAwf,MAAAxH,KAAA,SAAAnU,GACAvD,EAAAN,MAAAiM,KAAA,OAAApI,EACA,IAAAjD,GAAAN,EAAAN,MAAAiM,KAAA,OACArL,IAAAiD,IACAoI,EAAArL,GAAAiD,KAGA7D,KAAAF,KAAA0K,OAAAiD,KAAA,aAAAxB,IAGAf,MAAAS,UAAA+I,KAAA,SAAAwF,GAEA,IAAA,GAAAK,KAAAL,GAAA,CACAK,EAAAtZ,SAAAsZ,EAAA,GACA,IAAA7P,GAAA1K,KAAA+d,YAAAxD,EACA7P,KACAA,EAAA0T,MAAAnd,SAAAiZ,EAAAK,GAAA,IACAja,EAAA,SAAAia,GAAAtO,KAAA,OAAAiO,EAAAK,KAIAva,KAAAoe,SAGAlT,MAAAS,UAAAjL,KAAA,SAAAiK,GAKA,IAAA,GAHA0C,GAAArN,KAGA2C,EAAA,EAAAC,EAAA+H,EAAA/H,OAAAD,EAAAC,EAAAD,IAAA,CACA,GAAA+H,GAAAC,EAAAhI,EACA+H,GAAAmV,YACAnV,EAAAD,KAAAqT,eAAA9d,KAAAF,KAAA4K,KAAAD,KAAAqT,gBACApT,EAAA1K,KAAAF,KAAA4K,MAGA1K,KAAAue,QAAA7T,GACA1K,KAAAse,cAAA5T,IAKA1K,KAAAF,KAAA0K,OAAA0D,GAAA,aAAA,SAAAjC,GACAoB,EAAAkR,QAAAtS,KAGAjM,KAAAF,KAAA0K,OAAA0D,GAAA,cAAA,SAAAjC,GACAoB,EAAAoR,WAAAxS,KAIAjM,KAAAF,KAAA0K,OAAA0D,GAAA,eAAA,SAAAjC,GACAoB,EAAAD,YAAAnB,KAGAjM,KAAAF,KAAA0K,OAAA0D,GAAA,cAAA,SAAAjC,GACAoB,EAAAG,WAAAvB,KAIAjM,KAAAF,KAAA0K,OAAA0D,GAAA,aAAA,SAAAjC,GACAoB,EAAAiR,cAAArS,KAGAjM,KAAAF,KAAA0K,OAAA0D,GAAA,YAAA,SAAAjC,EAAA6T,GACAzS,EAAAiR,cAAArS,EACA,IAAA6T,GAAAxf,EACA,wBAAA2L,EAAArL,GAAA,iGAEAqL,EAAAxB,KAAA,QAAAqV,EAAA,0BACAA,EAAA,uCAGAxf,GAAA,QAAAkM,OAAAsT,GAEAA,EAAAC,MAAA,KAAAnJ,QAAA,IAAA,WAAAtW,EAAA,gBAAA2L,EAAArL,IAAA6O,WACAlC,WAAA,WAAAuS,EAAAvL,YAAA,cAIAvU,KAAAF,KAAA0K,OAAA0D,GAAA,aAAA,SAAAjC,GACAoB,EAAAqH,KAAAzI,KAGAjM,KAAAF,KAAA4K,KAAAyB,OACAnM,KAAAyL,OAAAyC,GAAA,qBAAA,gBAAA,SAAAC,GACAA,EAAAC,iBACAD,EAAA6R,oBAGAhgB,KAAAyL,OAAAyC,GAAA,qBAAA,QAAA,SAAAC,GACAA,EAAAC,iBACAf,EAAA0R,KAAAze,EAAAN,OAAAwB,EAAA2M,EAAAkR,MAAA5d,EAAA0M,EAAAmR,UAGAhf,EAAA,QAAA4N,GAAA,cAAA,sBAAA,WACAb,EAAAvN,KAAA0K,OAAAiD,KAAA,YAAAnN,EAAAN,MAAAiM,KAAA,QAAA3L,EAAAN,MAAAiM,KAAA,aAGA3L,EAAA,QAAA4N,GAAA,cAAA,SAAAlO,KAAAF,KAAA4K,KAAA9J,GAAA,UAAA,WACAyM,EAAAvN,KAAA0K,OAAAiD,KAAA,YAAAJ,EAAAvN,KAAA4K,KAAA9J,GAAAN,EAAAN,MAAAiM,KAAA,YAIAjM,KAAAoe,SAGAlT,MAAAS,UAAA4C,QAAA,WAEAvO,KAAAF,KAAA0K,OAAAiE,mBAAA,cACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,gBACAzO,KAAAF,KAAA0K,OAAAiE,mBAAA,eACAzO,KAAAyL,OAAA+C,IAAA,aACAlO,EAAA,QAAAkO,IAAA,UAAAA,IAAA","file":"all.min.js","sourcesContent":["function Chat(room, messages)\r\n{\r\n\tthis.msgbox = 0;\r\n\tthis.room = room;\r\n\tthis.messages = [];\r\n\tthis.myMessages = [];\r\n\tthis.typing = null;\r\n\tthis.editMode = -1;\r\n\r\n\tthis.$messages = $(\"#messages\");\r\n\tthis.$message = $(\"#message\");\r\n\tthis.$content = $(\"#content\");\r\n\tthis.$chat = $(\"#chat\");\r\n\r\n\tthis.init(messages);\r\n}\r\n\r\nChat.prototype.getMessageIndexById = function(id)\r\n{\r\n\tfor (var i = this.messages.length - 1; i >= 0; i--)\r\n\t{\r\n\t\tif(this.messages[i].id == id)\r\n\t\t\treturn i;\r\n\t}\r\n\r\n\treturn -1;\r\n};\r\n\r\nChat.prototype.addMessage = function(message, editable)\r\n{\r\n\t// On garde aussi en référence uniquement mes messages\r\n\tif(message.user.name == this.room.user.name && editable)\r\n\t\tthis.myMessages.push(message);\r\n\r\n\tthis.messages.push(message);\r\n};\r\n\r\nChat.prototype.getClass = function(data) {\r\n\tvar c = '';\r\n\tif(data.user.name == this.room.user.name) c += ' me';\r\n\tif(data.user.admin) c += ' admin';\r\n\tif(data.prive) c += ' prive';\r\n\r\n\treturn c;\r\n};\r\n\r\nChat.prototype.isNewBox = function(data)\r\n{\r\n\treturn !(\r\n\t\tthis.messages.length > 0 &&\r\n\t\tthis.messages[this.messages.length-1].user.name == data.user.name &&\r\n\t\t!this.messages[this.messages.length-1].command &&\r\n\t\t!this.messages[this.messages.length-1].image &&\r\n\t\tthis.messages[this.messages.length-1].prive == data.prive\r\n\t);\r\n};\r\n\r\nChat.prototype.showCommand = function(data)\r\n{\r\n\tswitch(data.command){\r\n\t\tcase \"/roll\":\r\n\t\t\tthis.$messages.append($('<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"diceroll mui-panel'+this.getClass(data)+'\">').html('<span class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</span> '+data.message));\r\n\t\t\tthis.addMessage(data, false);\r\n\t\t\tthis.room.users.showLastDice(data.user, data.message);\r\n\t\t\tif(data.user.name == this.room.user.name) this.room.dices.roll(data.dice);\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n\r\n\treturn true;\r\n};\r\n\r\nChat.prototype.showError = function(data)\r\n{\r\n\tdata.user.name = \"error\";\r\n\tthis.$messages.append($('<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message '+data.error+' me\">').html(data.message));\r\n\tthis.addMessage(data, false);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n\treturn;\r\n};\r\n\r\nChat.prototype.showImage = function(data)\r\n{\r\n\tvar text = '<div id=\"image-'+data.image+'\"><a href=\"#\" data-image=\"'+data.image+'\">Download image '+data.name+'</a></div>';\r\n\tif(this.isNewBox(data))\r\n\t{\r\n\t\tthis.$messages.append(\r\n\t\t\t'<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message mui-panel'+this.getClass(data)+'\">'+\r\n\t\t\t\t'<div class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</div> '+\r\n\t\t\t\t'<div class=\"text\">'+text+'</div>'+\r\n\t\t\t'</li>'\r\n\t\t);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$('#msgbox-'+this.msgbox).find('.text').append(text);\r\n\t}\r\n\t\r\n\tthis.addMessage(data, false);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n};\r\n\r\nChat.prototype.message = function(data)\r\n{\r\n\tif(data.error){\r\n\t\tthis.showError(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(data.command){\r\n\t\tthis.showCommand(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(typeof data.image !== \"undefined\"){\r\n\t\tthis.showImage(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(this.isNewBox(data))\r\n\t{\r\n\t\t// Nouvelle box\r\n\t\tthis.$messages.append(\r\n\t\t\t'<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message mui-panel'+this.getClass(data)+'\">'+\r\n\t\t\t\t'<div class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</div> '+\r\n\t\t\t\t'<div class=\"text\"><div id=\"msg-'+data.id+'\">'+data.message+'</div></div>'+\r\n\t\t\t'</li>'\r\n\t\t);\r\n\t} \r\n\telse\r\n\t{\r\n\t\t// On ne crée pas de nouvelle box\r\n\t\t$('#msgbox-'+this.msgbox).find('.text').append('<div id=\"msg-'+data.id+'\">'+data.message+'</div>');\r\n\t}\r\n\r\n\tthis.addMessage(data, true);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n};\r\n\r\nChat.prototype.editMessage = function(data)\r\n{\r\n\t// Errors, command and images aren't editable\r\n\tif(data.error || data.command || data.image) return;\r\n\r\n\tvar index = this.getMessageIndexById(data.id);\r\n\tif(index >= 0)\r\n\t{\r\n\t\tvar myIndex = this.myMessages.indexOf(this.messages[index]);\r\n\t\tif(myIndex >= 0)\r\n\t\t\tthis.myMessages[myIndex] = data;\r\n\r\n\t\tthis.messages[index] = data;\r\n\t\t$(\"#msg-\"+data.id).html(data.message);\r\n\t}\r\n};\r\n\r\nChat.prototype.typingStart = function()\r\n{\r\n\tvar that = this;\r\n\tif(this.typing)\r\n\t{\r\n\t\t// Si typing en cours, on update\r\n\t\tclearTimeout(this.typing);\r\n\t\tthis.typing = setTimeout(function(){ that.typingStop(); }, 2500);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t// Sinon on emet l'info\r\n\t\tthis.room.socket.emit('typing start');\r\n\t\tthis.typing = setTimeout(function(){ that.typingStop(); }, 2500);\r\n\t}\r\n};\r\n\r\nChat.prototype.typingStop = function()\r\n{\r\n\tclearTimeout(this.typing);\r\n\tthis.typing = null;\r\n\tthis.room.socket.emit('typing stop');\r\n};\r\n\r\nChat.prototype.startEdit = function()\r\n{\r\n\tif(this.editMode >= 0){\r\n\t\tvar that = this;\r\n\t\tthis.$message.focus();\r\n\t\tthis.$message.val(this.myMessages[this.editMode].message);\r\n\t\tsetTimeout(function(){ that.$message.putCursorAtEnd(); }, 0);\r\n\t}\r\n};\r\n\r\nChat.prototype.stopEdit = function()\r\n{\r\n\tif(this.editMode >= 0){\r\n\t\tthis.$message.val(\"\");\r\n\t\tthis.editMode = -1;\r\n\t}\r\n};\r\n\r\nChat.prototype.editPrev = function()\r\n{\r\n\tif(this.editMode <= 0)\r\n\t\tthis.editMode = this.myMessages.length;\r\n\r\n\t--this.editMode;\r\n\tthis.startEdit();\r\n};\r\n\r\nChat.prototype.editNext = function()\r\n{\r\n\t++this.editMode;\r\n\r\n\tif(this.editMode >= this.myMessages.length)\r\n\t{\r\n\t\tthis.stopEdit();\r\n\t}\r\n\telse\r\n\t{\r\n\t\tthis.startEdit();\r\n\t}\r\n};\r\n\r\nChat.prototype.checkEndEdit = function() \r\n{\r\n\tif(this.$message.val() == \"\")\r\n\t{\r\n\t\tthis.editMode = -1;\r\n\t}\r\n};\r\n\r\nChat.prototype.init = function(messages)\r\n{\r\n\tvar that = this;\r\n\r\n\t// Ajouter messages existants\r\n\tfor (i = 0, length = messages.length; i < length; i++) {\r\n\t\tthis.message(messages[i]);\r\n\t}\r\n\r\n\t// Envoyer message\r\n\tthis.$chat.on(\"submit.chat\", function(e){\r\n\t\te.preventDefault();\r\n\r\n\t\tvar message = that.$message.val();\r\n\r\n\t\tif(message != \"\")\r\n\t\t{\r\n\t\t\tif (that.editMode >= 0)\r\n\t\t\t{\r\n\t\t\t\tvar myMsg = that.myMessages[that.editMode];\r\n\t\t\t\tif(myMsg.prive)\r\n\t\t\t\t\tmessage = \"@\"+myMsg.prive+\" \"+message;\r\n\r\n\t\t\t\tthat.room.socket.emit(\"chat edit\", myMsg.id, message);\r\n\t\t\t\tthat.stopEdit();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthat.room.socket.emit(\"chat\", message);\r\n\t\t\t}\r\n\r\n\t\t\tthat.$message.val('');\r\n\t\t\tthat.checkEndEdit();\r\n\t\t\tthat.typingStop();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\t// Recevoir messages\r\n\tthis.room.socket.on('chat', function(data){\r\n\t\tthat.message(data);\r\n\t});\r\n\r\n\t// Gestion du typing\r\n\tthis.$message.on(\"keypress.chat\", function(e){\r\n\t\t// e.keyCode : 8 back, 13 entrée\r\n\t\tif(e.keyCode != 8 && e.keyCode != 13)\r\n\t\t{\r\n\t\t\tthat.typingStart();\r\n\t\t}\r\n\t});\r\n\r\n\t// Gestion de l'édition\r\n\tthis.room.socket.on('chat edit', function(data){\r\n\t\tthat.editMessage(data);\r\n\t});\r\n\r\n\tthis.$message.on(\"keydown.chat\", function(e){\r\n\t\t// Key up\r\n\t\tif(e.keyCode == 38)\r\n\t\t{\r\n\t\t\tthat.editPrev();\r\n\t\t}\r\n\t\t// Key down\r\n\t\telse if(e.keyCode == 40)\r\n\t\t{\r\n\t\t\tthat.editNext();\r\n\t\t}\r\n\t\t// Key return or suppr\r\n\t\telse if(e.keyCode == 8 || e.keyCode == 46)\r\n\t\t{\r\n\t\t\tthat.checkEndEdit();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nChat.prototype.destroy = function()\r\n{\r\n\tthis.$chat.off(\".chat\");\r\n\tthis.$message.off(\".chat\");\r\n\tthis.room.socket.removeAllListeners('chat');\r\n\tthis.room.socket.removeAllListeners('chat edit');\r\n};","\"use strict\";\r\n\r\nfunction Dice2D(id, type, color, box)\r\n{\r\n\tthis.id = id;\r\n\tthis.type = type;\r\n\tthis.value = parseInt(this.type.replace('d', '').split(' ')[0]);\r\n\tthis.box = box;\r\n\tthis.radius = 0.25 * this.box.scale;\r\n\tthis.color = color;\r\n\tthis.transform;\r\n\r\n\tthis.position = {x: 0, y: 0, z: 0};\r\n\tthis.rotation = 0;\r\n\tthis.time = 0;\r\n\r\n\tthis.createMesh();\r\n}\r\n\r\nDice2D.prototype.createMesh = function()\r\n{\r\n\tthis.transform = $('<div class=\"dice '+this.type+'\"></div>').css({\r\n\t\tposition: \"absolute\",\r\n\t\ttop: -this.radius,\r\n\t\tleft: -this.radius,\r\n\t\twidth: this.radius * 2,\r\n\t\theight: this.radius * 2,\r\n\t\tlineHeight: this.radius * 2 + \"px\",\r\n\t\tfontSize: this.radius * 0.75 + \"px\",\r\n\t\tfontWeight: \"bold\",\r\n\t\ttextShadow: \"2px 2px 0px #000000, 2px -2px 0px #000000, -2px -2px 0px #000000, -2px 2px 0px #000000\"\r\n\t});\r\n\r\n\tthis.box.scene.append(this.transform);\r\n};\r\n\r\nDice2D.prototype.update = function(values)\r\n{\r\n\tthis.position.x = values[0] * this.box.w / 1000 / 2 + this.box.cw;\r\n\tthis.position.y = this.box.ch - values[1] * this.box.h / 1000 / 2;\r\n\tthis.position.z = values[2];\r\n\tthis.rotation = (((2 * Math.acos(values[3])) * 180 / Math.PI) + 180) % 360;\r\n\r\n\tthis.transform.css(\"transform\", \"translate3d(\"+this.position.x+\"px, \"+this.position.y+\"px, \"+this.position.z+\"px) rotate(\"+this.rotation+\"deg)\");\r\n\tif(Date.now() - this.time > 166){\r\n\t\tthis.transform.html(Math.ceil(Math.random() * this.value));\r\n\t\tthis.time = Date.now();\r\n\t}\r\n};\r\n\r\nDice2D.prototype.result = function(value)\r\n{\r\n\tthis.transform.html(value);\r\n};\r\n\r\nDice2D.prototype.remove = function() {\r\n\tthis.transform.remove();\r\n\tdelete this.box.dices[this.id];\r\n};\r\n\r\nfunction Dices2D(room, width, height)\r\n{\r\n\tthis.room = room;\r\n\tthis.w = width;\r\n\tthis.h = height;\r\n\tthis.cw;\r\n\tthis.ch;\r\n\tthis.scale;\r\n\tthis.scene;\r\n\r\n\tthis.dices = {};\r\n\r\n\tthis.init();\r\n}\r\n\r\nDices2D.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tthis.dices = {};\r\n\tthis.scene = $(\"#dice-box\");\r\n\r\n\tthis.room.socket.on('dice start', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tthat.dices[data[i].id] = new Dice2D(data[i].id, data[i].type, data[i].color, that);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice update', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].update(data[i]);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice result', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].result(data[i]);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice end', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tif(that.dices[data[i]]) that.dices[data[i]].remove();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nDices2D.prototype.remove = function() {\r\n\tthis.room.socket.removeAllListeners('dice start');\r\n\tthis.room.socket.removeAllListeners('dice update');\r\n\tthis.room.socket.removeAllListeners('dice result');\r\n\tthis.room.socket.removeAllListeners('dice end');\r\n};","\"use strict\";\r\n\r\nvar DicesModels3D = {};\r\n\r\nDicesModels3D.d4 = {\r\n\tgeometry: {\r\n\t\tvertices: [[1, 1, 1], [-1, -1, 1], [-1, 1, -1], [1, -1, -1]],\r\n\t\tfaces: [[1, 0, 2, 1], [0, 1, 3, 2], [0, 3, 2, 3], [1, 2, 3, 4]],\r\n\t\ttab: -0.1,\r\n\t\taf: Math.PI * 7 / 6\r\n\t},\r\n\tmass: 300,\r\n\tinertia: 5,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d6 = {\r\n\tgeometry: {\r\n\t\tvertices: [[-1, -1, -1], [1, -1, -1], [1, 1, -1], [-1, 1, -1], [-1, -1, 1], [1, -1, 1], [1, 1, 1], [-1, 1, 1]],\r\n\t\tfaces: [[0, 3, 2, 1, 1], [1, 2, 6, 5, 2], [0, 1, 5, 4, 3], [3, 7, 6, 2, 4], [0, 4, 7, 3, 5], [4, 5, 6, 7, 6]],\r\n\t\ttab: 0.1,\r\n\t\taf: Math.PI / 4\r\n\t},\r\n\tmass: 300,\r\n\tinertia: 13,\r\n\tscale: 1.1\r\n};\r\n\r\nDicesModels3D.d8 = {\r\n\tgeometry: {\r\n\t\tvertices: [[1, 0, 0], [-1, 0, 0], [0, 1, 0], [0, -1, 0], [0, 0, 1], [0, 0, -1]],\r\n\t\tfaces: [[0, 2, 4, 1], [0, 4, 3, 2], [0, 3, 5, 3], [0, 5, 2, 4], [1, 3, 4, 5], [1, 4, 2, 6], [1, 2, 5, 7], [1, 5, 3, 8]],\r\n\t\ttab: 0,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 340,\r\n\tinertia: 10,\r\n\tscale: 1.1\r\n};\r\n\r\nDicesModels3D.d10 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar a = Math.PI * 2 / 10, k = Math.cos(a), h = 0.105;\r\n\t\t\tvar vertices = [];\r\n\t\t\tfor (var i = 0, b = 0; i < 10; ++i, b += a)\r\n\t\t\t\tvertices.push([Math.cos(b), Math.sin(b), h * (i % 2 ? 1 : -1)]);\r\n\t\t\tvertices.push([0, 0, -1]); vertices.push([0, 0, 1]);\r\n\t\t\treturn vertices;\r\n\t\t}(),\r\n\t\tfaces: [\r\n\t\t\t[5, 7, 11, 0], [4, 2, 10, 1], [1, 3, 11, 2], [0, 8, 10, 3], [7, 9, 11, 4],\r\n\t\t\t[8, 6, 10, 5], [9, 1, 11, 6], [2, 0, 10, 7], [3, 5, 11, 8], [6, 4, 10, 9],\r\n\t\t\t[5, 6, 7, -1], [3, 2, 4, -1], [1, 2, 3, -1], [9, 8, 0, -1], [7, 8, 9, -1],\r\n\t\t\t[7, 6, 8, -1], [9, 0, 1, -1], [1, 0, 2, -1], [3, 4, 5, -1], [5, 4, 6, -1]\r\n\t\t],\r\n\t\ttab: 0,\r\n\t\taf: Math.PI * 6 / 5\r\n\t},\r\n\tmass: 350,\r\n\tinertia: 9,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d12 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar p = (1 + Math.sqrt(5)) / 2, q = 1 / p;\r\n\t\t\treturn [[0, q, p], [0, q, -p], [0, -q, p], [0, -q, -p], [p, 0, q], [p, 0, -q], [-p, 0, q], [-p, 0, -q], [q, p, 0], [q, -p, 0], [-q, p, 0], [-q, -p, 0], [1, 1, 1], [1, 1, -1], [1, -1, 1], [1, -1, -1], [-1, 1, 1], [-1, 1, -1], [-1, -1, 1], [-1, -1, -1]];\r\n\t\t}(),\r\n\t\tfaces: [[2, 14, 4, 12, 0, 1], [15, 9, 11, 19, 3, 2], [16, 10, 17, 7, 6, 3], [6, 7, 19, 11, 18, 4], [6, 18, 2, 0, 16, 5], [18, 11, 9, 14, 2, 6], [1, 17, 10, 8, 13, 7], [1, 13, 5, 15, 3, 8], [13, 8, 12, 4, 5, 9], [5, 4, 14, 9, 15, 10], [0, 12, 8, 10, 16, 11], [3, 19, 7, 17, 1, 12]],\r\n\t\ttab: 0.2,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 380,\r\n\tinertia: 8,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d20 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar t = (1 + Math.sqrt(5)) / 2;\r\n\t\t\treturn [[-1, t, 0], [1, t, 0 ], [-1, -t, 0], [1, -t, 0], [0, -1, t], [0, 1, t], [0, -1, -t], [0, 1, -t], [t, 0, -1], [t, 0, 1], [-t, 0, -1], [-t, 0, 1]];\r\n\t\t}(),\r\n\t\tfaces: [[0, 11, 5, 1], [0, 5, 1, 2], [0, 1, 7, 3], [0, 7, 10, 4], [0, 10, 11, 5], [1, 5, 9, 6], [5, 11, 4, 7], [11, 10, 2, 8], [10, 7, 6, 9], [7, 1, 8, 10], [3, 9, 4, 11], [3, 4, 2, 12], [3, 2, 6, 13], [3, 6, 8, 14], [3, 8, 9, 15], [4, 9, 5, 16], [2, 4, 11, 17], [6, 2, 10, 18], [8, 6, 7, 19], [9, 8, 1, 20]],\r\n\t\ttab: -0.2,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 400,\r\n\tinertia: 6,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d100 = {\r\n\tgeometry: DicesModels3D.d10.geometry,\r\n\tmass: 350,\r\n\tinertia: 9,\r\n\tscale: 1\r\n};\r\n\r\nfunction copyto(obj, res) {\r\n\tif (obj == null || typeof obj !== 'object') return obj;\r\n\tif (obj instanceof Array) {\r\n\t\tfor (var i = obj.length - 1; i >= 0; --i)\r\n\t\t\tres[i] = copy(obj[i]);\r\n\t}\r\n\telse {\r\n\t\tfor (var i in obj) {\r\n\t\t\tif (obj.hasOwnProperty(i))\r\n\t\t\t\tres[i] = copy(obj[i]);\r\n\t\t}\r\n\t}\r\n\treturn res;\r\n}\r\n\r\nfunction copy(obj) {\r\n\tif (!obj) return obj;\r\n\treturn copyto(obj, new obj.constructor());\r\n}\r\n\r\nfunction makeGeometry(vertices, faces, radius, tab, af) {\r\n\tvar geom = new THREE.Geometry();\r\n\tfor (var i = 0; i < vertices.length; ++i) {\r\n\t\tvar vertex = (new THREE.Vector3).fromArray(vertices[i]).normalize().multiplyScalar(radius);\r\n\t\tvertex.index = geom.vertices.push(vertex) - 1;\r\n\t}\r\n\tfor (var i = 0; i < faces.length; ++i) {\r\n\t\tvar ii = faces[i], fl = ii.length - 1;\r\n\t\tvar aa = Math.PI * 2 / fl;\r\n\t\tfor (var j = 0; j < fl - 2; ++j) {\r\n\t\t\tgeom.faces.push(new THREE.Face3(ii[0], ii[j + 1], ii[j + 2], [geom.vertices[ii[0]],\r\n\t\t\t\t\t\tgeom.vertices[ii[j + 1]], geom.vertices[ii[j + 2]]], 0, ii[fl] + 1));\r\n\t\t\tgeom.faceVertexUvs[0].push([\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(af) + 1 + tab) / 2 / (1 + tab)),\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab)),\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab))]);\r\n\t\t}\r\n\t}\r\n\tgeom.computeFaceNormals();\r\n\tgeom.computeVertexNormals();\r\n\tgeom.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\treturn geom;\r\n}\r\n\r\nvar materialOptions = {\r\n\tspecular: '#171d1f',\r\n\tcolor: '#ffffff',\r\n\temissive: '#000000',\r\n\tshininess: 7,\r\n\tshading: THREE.FlatShading,\r\n};\r\n\r\nvar diceLabels = [' ', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20'];\r\nvar d10Labels = [' ', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0'];\r\nvar d100Labels = [' ', '10', '20', '30', '40', '50', '60', '70', '80', '90', '00'];\r\n\r\nfunction idealTextColor(bgColor) {\r\n\r\n   var nThreshold = 105;\r\n   var components = getRGBComponents(bgColor);\r\n   var bgDelta = (components.R * 0.299) + (components.G * 0.587) + (components.B * 0.114);\r\n\r\n   return ((255 - bgDelta) < nThreshold) ? \"#000000\" : \"#ffffff\";\r\n}\r\n\r\nfunction getRGBComponents(color) {\r\n\r\n    var r = color.substring(1, 3);\r\n    var g = color.substring(3, 5);\r\n    var b = color.substring(5, 7);\r\n\r\n    return {\r\n       R: parseInt(r, 16),\r\n       G: parseInt(g, 16),\r\n       B: parseInt(b, 16)\r\n    };\r\n}\r\n\r\nfunction makeDiceMaterials(diceColor, faceLabels, size, margin) {\r\n\tfunction createTextTexture(text, color, backColor) {\r\n\t\tif (text == undefined) return null;\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tvar context = canvas.getContext(\"2d\");\r\n\t\tcanvas.width = size + margin;\r\n\t\tcanvas.height = size + margin;\r\n\t\tcontext.font = size + \"pt Arial\";\r\n\t\tcontext.fillStyle = backColor;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.fillText(text, canvas.width / 2, canvas.height / 2);\r\n\t\tif (text == '6' || text == '9') {\r\n\t\t\tcontext.fillText('  .', canvas.width / 2, canvas.height / 2);\r\n\t\t}\r\n\t\tvar texture = new THREE.Texture(canvas);\r\n\t\ttexture.needsUpdate = true;\r\n\t\treturn texture;\r\n\t}\r\n\tvar materials = [];\r\n\tfor (var i = 0; i < faceLabels.length; ++i)\r\n\t\tmaterials.push(new THREE.MeshPhongMaterial(copyto(materialOptions, { map: createTextTexture(faceLabels[i], idealTextColor(diceColor), diceColor) })));\r\n\r\n\treturn materials;\r\n}\r\n\r\nfunction makeD4Materials(diceColor, size, margin) {\r\n\tfunction createD4Text(text, color, backColor) {\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tvar context = canvas.getContext(\"2d\");\r\n\t\tcanvas.width = size + margin;\r\n\t\tcanvas.height = size + margin;\r\n\t\tcontext.font = size + \"pt Arial\";\r\n\t\tcontext.fillStyle = backColor;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.translate(0, size / 10);\r\n\t\tfor (var i in text) {\r\n\t\t\tcontext.fillText(text[i], canvas.width / 2,\r\n\t\t\t\t\tcanvas.height / 2 - size - margin / 10);\r\n\t\t\tcontext.translate(canvas.width / 2, canvas.height / 2);\r\n\t\t\tcontext.rotate(Math.PI * 2 / 3);\r\n\t\t\tcontext.translate(-canvas.width / 2, -canvas.height / 2);\r\n\t\t}\r\n\t\tvar texture = new THREE.Texture(canvas);\r\n\t\ttexture.needsUpdate = true;\r\n\t\treturn texture;\r\n\t}\r\n\tvar materials = [];\r\n\tvar labels = [[], [0, 0, 0], [2, 4, 3], [1, 3, 4], [2, 1, 4], [1, 2, 3]];\r\n\tfor (var i = 0; i < labels.length; ++i)\r\n\t\tmaterials.push(new THREE.MeshPhongMaterial(copyto(materialOptions, { map: createD4Text(labels[i], idealTextColor(diceColor), diceColor) })));\r\n\treturn materials;\r\n}\r\n\r\nfunction Dice3D(id, type, color, box)\r\n{\r\n\tthis.id = id;\r\n\tthis.type = type;\r\n\tthis.box = box;\r\n\tthis.radius = 0.6 * DicesModels3D[this.type].scale * box.scale;\r\n\tthis.color = color;\r\n\tthis.transform;\r\n\r\n\t//this.position = {x: 0, y: 0, z: 0};\r\n\t//this.rotation = {x: 0, y: 0, z: 0, w: 0};\r\n\r\n\tthis.createMesh();\r\n\r\n\tthis.box.renderer.render(this.box.scene, this.box.camera);\r\n}\r\n\r\nDice3D.prototype.createMesh = function()\r\n{\r\n\tvar model = DicesModels3D[this.type];\r\n\tvar geometry = makeGeometry(model.geometry.vertices, model.geometry.faces, this.radius, model.geometry.tab, model.geometry.af);\r\n\r\n\tvar materials;\r\n\tif(this.type == 'd4'){\r\n\t\tmaterials = makeD4Materials(this.color, this.box.scale / 3, this.box.scale);\r\n\t} else if(this.type == 'd100') {\r\n\t\tmaterials = makeDiceMaterials(this.color, d100Labels, this.box.scale / 3, this.box.scale);\r\n\t} else if(this.type == 'd10') {\r\n\t\tmaterials = makeDiceMaterials(this.color, d10Labels, this.box.scale / 3, this.box.scale);\r\n\t} else {\r\n\t\tmaterials = makeDiceMaterials(this.color, diceLabels, this.box.scale / 3, this.box.scale);\r\n\t}\r\n\r\n\tvar mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial( materials )  );\r\n\r\n\tmesh.castShadow = true;\r\n\tmesh.receiveShadow = false;\r\n\r\n\tmesh.position.x = -this.box.w * 2;\r\n\tmesh.position.y = -this.box.h * 2;\r\n\tmesh.position.z = 0;\r\n\r\n\tmesh.quaternion.x = 0;\r\n\tmesh.quaternion.y = 0;\r\n\tmesh.quaternion.z = 0;\r\n\tmesh.quaternion.w = 0;\r\n\r\n\tthis.transform = mesh;\r\n\tthis.box.scene.add(mesh);\r\n};\r\n\r\nDice3D.prototype.update = function(values)\r\n{\r\n\tthis.transform.position.x = values[0] * this.box.w / 1000;\r\n\tthis.transform.position.y = values[1] * this.box.h / 1000;\r\n\tthis.transform.position.z = values[2];\r\n\r\n\tthis.transform.quaternion.x = values[3];\r\n\tthis.transform.quaternion.y = values[4];\r\n\tthis.transform.quaternion.z = values[5];\r\n\tthis.transform.quaternion.w = values[6];\r\n};\r\n\r\nDice3D.prototype.remove = function() {\r\n\tthis.box.scene.remove(this.transform);\r\n\tdelete this.box.dices[this.id];\r\n};\r\n\r\nfunction Dices3D(room, width, height)\r\n{\r\n\tthis.room = room;\r\n\tthis.w = width;\r\n\tthis.h = height;\r\n\tthis.cw;\r\n\tthis.ch;\r\n\tthis.scene;\r\n\tthis.camera;\r\n\tthis.renderer;\r\n\tthis.aspect;\r\n\tthis.scale;\r\n\tthis.desk;\r\n\tthis.light;\r\n\r\n\tthis.dices = {};\r\n\r\n\tthis.init();\r\n}\r\n\r\nDices3D.prototype.resize = function()\r\n{\r\n\tthis.w = window.innerWidth;\r\n\tthis.h = window.innerHeight;\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\tthis.aspect = Math.min(this.cw / this.w, this.ch / this.h);\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tvar wh = Math.min(this.cw, this.ch) / this.aspect / Math.tan(10 * Math.PI / 180);\r\n\tthis.camera.aspect = this.cw / this.ch;\r\n\tthis.camera.far = wh * 1.3;\r\n\tthis.camera.position.z = wh;\r\n\tthis.camera.updateProjectionMatrix();\r\n\r\n\tvar mw = Math.max(this.w, this.h);\r\n\tthis.light.position.set(-mw / 2, mw / 2, mw * 2);\r\n\tthis.light.target.position.set(0, 0, 0);\r\n\r\n\tthis.renderer.setSize(this.w, this.h);\r\n};\r\n\r\nDices3D.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\r\n\tthis.aspect = Math.min(this.cw / this.w, this.ch / this.h);\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tthis.renderer = window.WebGLRenderingContext\r\n\t\t? new THREE.WebGLRenderer({ antialias: true, alpha: true })\r\n\t\t: new THREE.CanvasRenderer({ antialias: true, alpha: true });\r\n\tthis.renderer.setSize(this.cw * 2, this.ch * 2);\r\n\tthis.renderer.shadowMapEnabled = true;\r\n\tthis.renderer.shadowMapSoft = true;\r\n\tthis.renderer.setClearColor(0x000000, 0);\r\n\r\n\tthis.dices = {};\r\n\tthis.scene = new THREE.Scene();\r\n\tthis.scene.fog = null;\r\n\r\n\t$(\"#dice-box\").append(this.renderer.domElement);\r\n\r\n\tvar wh = Math.min(this.cw, this.ch) / this.aspect / Math.tan(10 * Math.PI / 180);\r\n\tthis.camera = new THREE.PerspectiveCamera(20, this.cw / this.ch, 1, wh * 1.3);\r\n\tthis.camera.position.z = wh;\r\n\r\n\tvar ambientLight = new THREE.AmbientLight(0x666666);\r\n\tthis.scene.add(ambientLight);\r\n\r\n\tvar mw = Math.max(this.w, this.h);\r\n\tthis.light = new THREE.SpotLight(0xffffff);\r\n\tthis.light.position.set(-mw / 2, mw / 2, mw * 2);\r\n\tthis.light.target.position.set(0, 0, 0);\r\n\tthis.light.castShadow = true;\r\n\tthis.light.shadowCameraNear = mw / 10;\r\n\tthis.light.shadowCameraFar = mw * 3;\r\n\tthis.light.shadowCameraFov = 50;\r\n\tthis.light.shadowBias = 0.001;\r\n\tthis.light.shadowDarkness = 0.3;\r\n\tthis.light.shadowMapWidth = 1024;\r\n\tthis.light.shadowMapHeight = 1024;\r\n\tthis.scene.add(this.light);\r\n\r\n\tvar planeFragmentShader = [\r\n\r\n\t\t\"uniform vec3 diffuse;\",\r\n\t\t\"uniform float opacity;\",\r\n\r\n\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\t\"gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 );\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 - shadowColor.x );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join(\"\\n\");\r\n\r\n\tvar planeMaterial = new THREE.ShaderMaterial({\r\n\t\tuniforms: THREE.ShaderLib['basic'].uniforms,\r\n\t\tvertexShader: THREE.ShaderLib['basic'].vertexShader,\r\n\t\tfragmentShader: planeFragmentShader,\r\n\t\tcolor: 0x0000FF\r\n\t});\r\n\r\n\tthis.desk = new THREE.Mesh(new THREE.PlaneGeometry(this.w*2, this.h*2, 1, 1), planeMaterial);\r\n\tthis.desk.receiveShadow = true;\r\n\tthis.scene.add(this.desk);\r\n\r\n\twindow.addEventListener('click', this.resize.bind(this));\r\n\r\n\tthis.room.socket.on('dice start', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tthat.dices[data[i].id] = new Dice3D(data[i].id, data[i].type, data[i].color, that);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice update', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].update(data[i]);\r\n\t\t}\r\n\t\tthat.renderer.render(that.scene, that.camera);\r\n\t});\r\n\r\n\tthis.room.socket.on('dice end', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tif(that.dices[data[i]]) that.dices[data[i]].remove();\r\n\t\t}\r\n\t\tthat.renderer.render(that.scene, that.camera);\r\n\t});\r\n};\r\n\r\nDices3D.prototype.remove = function() {\r\n\tthis.room.socket.removeAllListeners('dice start');\r\n\tthis.room.socket.removeAllListeners('dice update');\r\n\tthis.room.socket.removeAllListeners('dice end');\r\n};\r\n","function Dice(type){\r\n\tthis.type = type;\r\n\tthis.rolls = 0;\r\n\tthis.cooldown = null;\r\n\tthis.$item = $('<div class=\"dice d'+type.split('d').pop()+' noselect\">'+type+'</div>');\r\n}\r\n\r\nDice.prototype.roll = function() {\r\n\tvar that = this;\r\n\t++this.rolls;\r\n\tthis.$item.addClass(\"cooldown\");\r\n\tclearTimeout(this.cooldown);\r\n\tthis.cooldown = setTimeout(function(){ that.$item.removeClass(\"cooldown\"); }, 2000);\r\n};\r\n\r\nfunction Dices(room)\r\n{\r\n\tthis.room = room;\r\n\tthis.dices = [];\r\n\r\n\tthis.$dices = $(\"#dices\");\r\n\r\n\tthis.init();\r\n}\r\n\r\n// Clear dices\r\nDices.prototype.unload = function()\r\n{\r\n\tthis.dices = [];\r\n};\r\n\r\n// Show dices\r\nDices.prototype.show = function()\r\n{\r\n\tthis.sort();\r\n\tvar number = this.number();\r\n\tvar length = (this.dices.length > number) ? number : this.dices.length;\r\n\tthis.$dices.children(\".dice\").detach();\r\n\tthis.$dices[0].className = \"dices-\"+length;\r\n\r\n\tfor(var i = 0; i < length; i++){\r\n\t\tthis.$dices.append(this.dices[i].$item);\r\n\t}\r\n};\r\n\r\n// Sort dices by number of rolls\r\nDices.prototype.sort = function()\r\n{\r\n\tthis.dices.sort(function(a, b){ return b.rolls - a.rolls; });\r\n};\r\n\r\n// Show\r\nDices.prototype.roll = function(dice)\r\n{\r\n\t// Merge 1dX and dX\r\n\tdice = dice.split('d');\r\n\tif(dice[0] == \"1\")\r\n\t\tdice[0] = \"\";\r\n\tdice = dice.join('d');\r\n\r\n\tvar exist = false;\r\n\tfor (var i = this.dices.length - 1; i >= 0; i--) {\r\n\t\tif(this.dices[i].type == dice){\r\n\t\t\texist = true;\r\n\t\t\tthis.dices[i].roll();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif(!exist) {\r\n\t\tthis.dices.push(new Dice(dice));\r\n\t}\r\n\r\n\tthis.show();\r\n};\r\n\r\nDices.prototype.number = function()\r\n{\r\n\treturn Math.max(Math.min(Math.round(($(window).width() * 0.15) / 40), 5), 1);\r\n};\r\n\r\nDices.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\t$(window).on('resize.dices', function(){\r\n\t\tthat.show();\r\n\t});\r\n\r\n\t$(document).on(\"click.dices\", \".dice\", function(e){\r\n\t\te.preventDefault();\r\n\t\tvar $this = $(this);\r\n\t\tif(!$this.hasClass(\"cooldown\")){\r\n\t\t\t$this.addClass(\"cooldown\");\r\n\t\t\tvar dice = $this.html();\r\n\t\t\tthat.room.socket.emit('chat', \"/roll \"+dice);\r\n\t\t}\r\n\t});\r\n};\r\n\r\nDices.prototype.destroy = function()\r\n{\r\n\t$(window).off('.dices');\r\n\t$(document).off('.dices');\r\n};\r\n","function Images(room)\r\n{\r\n\tthis.room = room;\r\n\tthis.image = \"\";\r\n\r\n\tthis.$zoom = null;\r\n\r\n\tthis.init();\r\n}\r\n\r\nImages.prototype.show = function(data) {\r\n\t$(\"#image-\"+data.id).html('<img class=\"zoomable link\" src=\"'+data.url+'\" alt=\"'+data.name+'\" title=\"'+data.name+'\">');\r\n};\r\n\r\nImages.prototype.close = function()\r\n{\r\n\tif(this.$zoom)\r\n\t{\r\n\t\tthis.$zoom.off('.images');\r\n\t\tthis.$zoom.remove();\r\n\t\tthis.$zoom = null;\r\n\t}\r\n};\r\n\r\nImages.prototype.zoom = function(src)\r\n{\r\n\tif(!this.$zoom)\r\n\t{\r\n\t\tvar that = this;\r\n\t\tthis.$zoom = $('<div class=\"overlay centerer closable\"><div class=\"image centered\"><img class=\"zoomed\" src=\"'+src+'\" alt=\"\"></div></div>')\r\n\t\t$('body').append(this.$zoom);\r\n\t\tthis.$zoom.on('click.images', function(){\r\n\t\t\tthat.close();\r\n\t\t});\r\n\t}\r\n};\r\n\r\nImages.prototype.upload = function(image)\r\n{\r\n\tif(image.type.split('/').shift() == 'image')\r\n\t{\r\n\t\tvar that = this;\r\n\t\treader = new FileReader();\r\n\t\treader.onload = function(evt){\r\n\t\t\tthat.room.socket.emit('image upload', image.name, evt.target.result);\r\n\t\t};\r\n\t\treader.readAsDataURL(image);\r\n\t}\r\n};\r\n\r\nImages.prototype.download = function(id) {\r\n\tthis.room.socket.emit('image download', id);\r\n};\r\n\r\nImages.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\t$('body')\r\n\t\t.on('dragover.images', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t})\r\n\t\t.on('drop.images', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.upload(e.originalEvent.dataTransfer.files[0]);\r\n\t\t})\r\n\t\t.on('click.images', '.zoomable', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.zoom($(this).attr(\"src\"));\r\n\t\t})\r\n\t\t.on('click.images', '[data-image]', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\t$(this).append(' <i class=\"fa fa-spin fa-refresh\"></i>');\r\n\t\t\tthat.download($(this).attr(\"data-image\"));\r\n\t\t});\r\n\r\n\tthis.room.socket.on('image', function(data){\r\n\t\tthat.show(data);\r\n\t});\r\n};\r\n\r\nImages.prototype.destroy = function()\r\n{\r\n\tthis.close();\r\n\t$('body').off('.images');\r\n};","function LocalPlayer(music)\r\n{\r\n\tthis.music = music;\r\n\tthis.audio = new Audio();\r\n\tthis.volet = 0;\r\n\tthis.init();\r\n}\r\n\r\nLocalPlayer.prototype.init = function(){\r\n\tvar that = this;\r\n\tdocument.body.appendChild(this.audio);\r\n\tthis.audio.autoplay = true;\r\n\tthis.audio.loop = true;\r\n\r\n\tif(that.music.room.user.admin){\r\n\t\t$.post('music/list.php', function(data){\r\n\t\t\tthat.music.$musicPopin.find('.local-contener').append(that.crawlSongs(data));\r\n\r\n\t\t\t$('body').on('click.music', '.song .fa-play', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.song($(this).parent().parent(), false);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.song .fa-plus', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.song($(this).parent().parent(), true);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.playlist .fa-play', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.playlist($(this).parent().parent(), false);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.playlist .fa-plus', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.playlist($(this).parent().parent(), true);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n};\r\n\r\nLocalPlayer.prototype.song = function(elem, add){\r\n\tvar that = this;\r\n\tthat.music.$musicPopin.fadeOut(300);\r\n\tvar songs = {\r\n\t\ttype: 'local',\r\n\t\tadd: add,\r\n\t\turl: [elem.attr('data-song')]\r\n\t};\r\n\tthat.music.room.socket.emit('music', songs);\r\n};\r\n\r\nLocalPlayer.prototype.playlist = function(elem, add){\r\n\tvar that = this;\r\n\tvar songs = {\r\n\t\ttype: 'local',\r\n\t\tadd: add,\r\n\t\turl: []\r\n\t};\r\n\tthat.music.$musicPopin.fadeOut(300);\r\n\telem.next('input').next('label').next('ul').find('.song').each(function(){\r\n\t\tsongs.url.push($(this).attr('data-song'));\r\n\t});\r\n\r\n\tthat.music.room.socket.emit('music', songs);\r\n};\r\n\r\nLocalPlayer.prototype.crawlSongs = function(playlist){\r\n\t++this.volet;\r\n\tvar musiclist = '';\r\n\tmusiclist += '<h4 class=\"playlist list link\">'+playlist.title+'<span class=\"icon-play\"><i class=\"fa fa-plus\"></i><i class=\"fa fa-play\"></i></span></h4>';\r\n\tmusiclist += '<input id=\"volet-'+this.volet+'\" type=\"checkbox\" '+((this.volet==1)?'checked':'')+' class=\"volet-checkbox\">';\r\n\tmusiclist += '<label for=\"volet-'+this.volet+'\" class=\"volet-btn link fa fa-caret-right\"></label>';\r\n\tmusiclist += '<ul class=\"volet-content\">';\r\n\tfor(var i = 0; i < playlist.songs.length; i++){\r\n\t\tif(playlist.songs[i].type == \"playlist\"){\r\n\t\t\tmusiclist += '<li>'+this.crawlSongs(playlist.songs[i])+'</li>';\r\n\t\t} else {\r\n\t\t\tmusiclist += '<li class=\"song list link\" data-song=\"music/'+playlist.songs[i].url+'\">'+playlist.songs[i].title+'<span class=\"icon-play\"><i class=\"fa fa-plus\"></i><i class=\"fa fa-play\"></i></span></li>';\r\n\t\t}\r\n\t}\r\n\tmusiclist += '</ul>';\r\n\r\n\treturn musiclist;\r\n};\r\n\r\nLocalPlayer.prototype.start = function(track){\r\n\tthis.audio.src = track.url;\r\n\tthis.play();\r\n};\r\n\r\nLocalPlayer.prototype.pause = function(){\r\n\tthis.audio.pause();\r\n};\r\n\r\nLocalPlayer.prototype.play = function(){\r\n\tthis.audio.play();\r\n};\r\n\r\nLocalPlayer.prototype.volume = function(v){\r\n\tthis.audio.volume = Math.max(0, Math.min(v, 1));\r\n};\r\n\r\nLocalPlayer.prototype.destroy = function(){\r\n\tconsole.log(this.audio);\r\n\tthis.audio.parentNode.removeChild(this.audio);\r\n};\r\n\r\nfunction YoutubePlayer(music)\r\n{\r\n\tthis.music = music;\r\n    this.index = 0;\r\n\tthis.youtube;\r\n    this.$musicUrl;\r\n    this.$playLater;\r\n    this.$playNow;\r\n\r\n\tthis.init();\r\n}\r\n\r\nYoutubePlayer.prototype.init = function(){\r\n\tvar that = this;\r\n\r\n\t// Youtube player tag\r\n\tvar tag = document.createElement('script');\r\n\ttag.src = \"https://www.youtube.com/iframe_api\";\r\n\tvar firstScriptTag = document.getElementsByTagName('script')[0];\r\n\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n\r\n\twindow.onYouTubeIframeAPIReady = function() {\r\n\t\tthat.youtube = new YT.Player('yt-player', {\r\n\t\t\theight: '1',\r\n\t\t\twidth: '1',\r\n\t\t\tevents: {\r\n\t\t\t\t'onReady': onPlayerReady,\r\n\t\t\t\t'onStateChange': onPlayerStateChange\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// 4. The API will call this function when the video player is ready.\r\n    function onPlayerReady(event) {\r\n        console.log('player ready');\r\n\r\n\t\tif(that.music.room.user.admin){\r\n\t\t\tthat.music.$musicPopin.find('.youtube-contener').append(\r\n\t\t\t\t'<div class=\"mui-form-group\">'+\r\n\t\t\t\t\t'<input id=\"music-url\" type=\"text\" class=\"mui-form-control\" placeholder=\"https://www.youtube.com/watch?v=KqeKikpLQ5o\">'+\r\n\t\t\t\t\t'<label>Youtube url</label>'+\r\n\t\t\t\t'</div>'+\r\n\t\t\t\t'<button id=\"play-later\" class=\"mui-btn mui-btn-flat mui-btn-default mui-pull-left\">To playlist</button>'+\r\n\t\t\t\t'<button id=\"play-now\" class=\"mui-btn mui-btn-raised mui-btn-primary mui-pull-right\">Play now</button>'\r\n\t\t\t);\r\n\r\n\t\t\tthat.$musicUrl = $(\"#music-url\");\r\n\t\t\tthat.$playLater = $(\"#play-later\");\r\n\t\t\tthat.$playNow = $(\"#play-now\");\r\n\r\n\t\t\tthat.$playNow.on('click.music', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar value = that.$musicUrl[0].value;\r\n\t\t\t\tvar parse = that.parseURL(value);\r\n\t\t\t\tparse.add = false;\r\n\t\t\t\tthat.music.$musicPopin.fadeOut(300);\r\n\t\t\t\tthat.music.room.socket.emit('music', parse);\r\n\t\t\t\t//console.log('play now', parse);\r\n\t\t\t});\r\n\r\n\t\t\tthat.$playLater.on('click.music', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar value = that.$musicUrl[0].value;\r\n\t\t\t\tvar parse = that.parseURL(value);\r\n\t\t\t\tparse.add = true;\r\n\t\t\t\tthat.music.$musicPopin.fadeOut(300);\r\n\t\t\t\tthat.music.room.socket.emit('music', parse);\r\n\t\t\t\t//console.log('play later', parse);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\r\n    function onPlayerStateChange(event) {\r\n        //console.log('event: ' + event.data, 'index: ' + that.currentIndex, 'length: ' + (event.target.getPlaylist().length-1));\r\n        if(event.data == YT.PlayerState.PLAYING)\r\n            that.index = event.target.getPlaylistIndex();\r\n        if(event.data == YT.PlayerState.ENDED && that.index == event.target.getPlaylist().length-1){\r\n            that.music.next();\r\n            //console.log('Fin de la playlist');\r\n        }\r\n    }\r\n};\r\n\r\nYoutubePlayer.prototype.parseURL = function(url)\r\n{\r\n    var type = 'video';\r\n    if(url.indexOf('list=') != -1){\r\n        url = url.replace(/(>|<)/gi,'').split(/(vi\\/|list=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\r\n        type = 'playlist';\r\n    } else {\r\n        url = url.replace(/(>|<)/gi,'').split(/(vi\\/|v=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\r\n    }\r\n\r\n    if(url[2] !== undefined)\r\n        url = url[2].split(/[^0-9a-z_\\-]/i);\r\n\r\n    return {\r\n        url: url[0],\r\n        type: type\r\n    };\r\n};\r\n\r\nYoutubePlayer.prototype.start = function(track){\r\n\tif(track.type == 'playlist') this.youtube.loadPlaylist({list: track.url});\r\n    else this.youtube.loadPlaylist(track.url);\r\n};\r\n\r\nYoutubePlayer.prototype.pause = function(){\r\n\tthis.youtube.pauseVideo();\r\n};\r\n\r\nYoutubePlayer.prototype.play = function(){\r\n\tthis.youtube.playVideo();\r\n};\r\n\r\nYoutubePlayer.prototype.volume = function(v){\r\n\tthis.youtube.setVolume(Math.max(0, Math.min(v, 1)) * 100);\r\n};\r\n\r\nYoutubePlayer.prototype.destroy = function(){\r\n\tthis.youtube.destroy();\r\n\tif(this.music.room.user.admin){\r\n\t\tthis.$playNow.off('.music');\r\n\t\tthis.$playLater.off('.music');\r\n\t}\r\n};\r\n\r\nfunction Music(room)\r\n{\r\n\tthis.room = room;\r\n\tthis.playlist = [];\r\n\tthis.current = 0;\r\n\tthis.savedVolume = 0;\r\n\tthis.currentVolume = 0;\r\n\tthis.localPlayer;\r\n\tthis.youtubePlayer;\r\n\tthis.player;\r\n\r\n\tthis.$play = $(\"#play\");\r\n\tthis.$mute = $(\"#mute\");\r\n\tthis.$volume = $(\"#volume\");\r\n\tthis.$bar = this.$volume.find(\".audio-volume-bar\");\r\n\tthis.$musicPlayer = $(\"#music-player\");\r\n\r\n    this.$musicPopin;\r\n\r\n\tthis.init();\r\n}\r\n\r\nMusic.prototype.load = function(data)\r\n{\r\n\tconsole.log('data', data);\r\n    if(data.add){\r\n\t\tif(data.type == 'local'){\r\n\t\t\tfor(var i = 0, l = data.url.length; i<l; i++)\r\n\t\t\t\tthis.playlist.push({type: data.type, add: data.add, url: data.url[i]});\r\n\t\t} else {\r\n\t\t\tthis.playlist.push(data);\r\n\t\t}\r\n\r\n        if(this.playlist.length == 1){\r\n            this.current = 0;\r\n            this.start();\r\n        }\r\n    } else {\r\n\t\tthis.playlist = [];\r\n\t\tif(data.type == 'local'){\r\n\t\t\tfor(var i = 0, l = data.url.length; i<l; i++)\r\n\t\t\t\tthis.playlist.push({type: data.type, add: data.add, url: data.url[i]});\r\n\t\t} else {\r\n\t\t\tthis.playlist.push(data);\r\n\t\t}\r\n\t\tthis.current = 0;\r\n        this.start();\r\n    }\r\n};\r\n\r\nMusic.prototype.start = function()\r\n{\r\n\tconsole.log(this.playlist);\r\n    if(this.playlist.length === 0)\r\n        return;\r\n\tif(this.playlist[this.current].type == 'local')\r\n\t\tthis.player = this.localPlayer;\r\n\telse\r\n\t\tthis.player = this.youtubePlayer;\r\n\r\n    this.player.start(this.playlist[this.current]);\r\n    this.play();\r\n};\r\n\r\nMusic.prototype.next = function()\r\n{\r\n\tif(++this.current >= this.playlist.length)\r\n\t\tthis.current = 0;\r\n\tthis.start();\r\n};\r\n\r\nMusic.prototype.play = function()\r\n{\r\n\tthis.$play\r\n\t\t.removeClass(\"fa-play\")\r\n\t\t.addClass(\"fa-pause\");\r\n\tthis.player.play();\r\n\tthis.volume(this.currentVolume);\r\n};\r\n\r\nMusic.prototype.pause = function()\r\n{\r\n\tthis.$play\r\n\t\t.removeClass(\"fa-pause\")\r\n\t\t.addClass(\"fa-play\");\r\n\tthis.player.pause();\r\n};\r\n\r\nMusic.prototype.volume = function(volume)\r\n{\r\n\tvolume = Math.min(Math.max(volume, 0), 1);\r\n\r\n\tvar c = \"fa \";\r\n\tif(volume == 0){\r\n\t\tc += \"fa-volume-off\";\r\n\t} else if(volume < 0.4){\r\n\t\tc += \"fa-volume-down\";\r\n\t} else {\r\n\t\tc += \"fa-volume-up\";\r\n\t}\r\n\r\n\tthis.$mute[0].className = c;\r\n\r\n\tthis.$bar.css('width', (volume*100)+'%');\r\n\r\n\tif(this.player)\r\n\t\tthis.player.volume(volume * 0.2);\r\n    this.currentVolume = volume;\r\n};\r\n\r\nMusic.prototype.mute = function()\r\n{\r\n\tthis.savedVolume = this.currentVolume;\r\n\tthis.volume(0);\r\n};\r\n\r\nMusic.prototype.unmute = function()\r\n{\r\n\tthis.volume(this.savedVolume);\r\n\tthis.savedVolume = 0;\r\n};\r\n\r\nMusic.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthat.youtubePlayer = new YoutubePlayer(that);\r\n\tthat.localPlayer = new LocalPlayer(that);\r\n\r\n    that.volume(0.5);\r\n\r\n    that.$volume.on('mousedown.music', function(e){\r\n        e.preventDefault();\r\n        that.volume(Math.round(e.offsetX/$(this).width()*100)/100);\r\n        $(window).on('mousemove.music', function(e){\r\n            var offset = e.clientX - that.$volume.offset().left;\r\n            that.volume(Math.round(offset/that.$volume.width()*100)/100);\r\n        });\r\n    });\r\n\r\n    that.$mute.on('click.music', function(){\r\n        if(that.savedVolume == 0){\r\n            that.mute();\r\n        } else {\r\n            that.unmute();\r\n        }\r\n    });\r\n\r\n    $(window).on('mouseup.music', function(){\r\n        $(window).off('mousemove.music');\r\n    });\r\n\r\n    that.room.socket.on('music', function(data){\r\n        that.load(data);\r\n    });\r\n\r\n    that.room.socket.on('music pause', function(){\r\n        that.pause();\r\n    });\r\n\r\n    that.room.socket.on('music play', function(){\r\n        that.play();\r\n    });\r\n\r\n    that.room.socket.on('music volume', function(data){\r\n        that.volume(data);\r\n    });\r\n\r\n    if(that.room.user.admin)\r\n    {\r\n        $('.room-wrapper').append('<div id=\"music-player\"><div class=\"music-title\">Click to choose song</div></div>');\r\n\r\n        $('.room-wrapper').append('<div class=\"music-selector overlay centerer\" style=\"display:none;\">'+\r\n            '<div class=\"popin mui-panel centered\">'+\r\n                '<i class=\"music-selector-close fa fa-times link\"></i>'+\r\n\t\t\t\t'<div class=\"youtube-contener\"></div>'+\r\n\t\t\t\t'<div class=\"local-contener\" style=\"position:relative;clear:both;\"></div>'+\r\n            '</div>'+\r\n        '</div>');\r\n\r\n        that.$musicPlayer = $(\"#music-player\");\r\n        that.$musicPopin = $(\".music-selector\");\r\n\r\n        that.$musicPlayer.on(\"click.music\", function(e){\r\n            e.preventDefault();\r\n            if(that.room.user.admin){\r\n                that.$musicPopin.fadeIn(300);\r\n            }\r\n        });\r\n\r\n        that.$play.on(\"click.music\", function(e){\r\n            e.preventDefault();\r\n            if(that.room.user.admin)\r\n            {\r\n                var $this = $(this);\r\n                if($this.hasClass('fa-play')){\r\n                    if(that.player){\r\n                        that.room.socket.emit('music play');\r\n                    } else {\r\n                        that.$musicPopin.fadeIn(300);\r\n                    }\r\n                } else {\r\n                    that.room.socket.emit('music pause');\r\n                }\r\n            }\r\n        });\r\n\r\n\t\t$('body').on(\"click.music\", \".music-selector-close\", function(){\r\n\t        that.$musicPopin.fadeOut(300);\r\n\t    });\r\n    }\r\n};\r\n\r\nMusic.prototype.destroy = function()\r\n{\r\n\tthis.youtubePlayer.destroy();\r\n\tthis.localPlayer.destroy();\r\n\r\n\tthis.$volume.off('.music');\r\n\tthis.$mute.off('.music');\r\n\tthis.$play.off('.music');\r\n\t$('body').off('.music');\r\n\t$(window).off('.music');\r\n\r\n\tthis.room.socket.removeAllListeners('music');\r\n\tthis.room.socket.removeAllListeners('music play');\r\n\tthis.room.socket.removeAllListeners('music pause');\r\n\tthis.room.socket.removeAllListeners('music volume');\r\n\r\n\tif(this.room.user.admin){\r\n\t\tthis.$musicPlayer.remove();\r\n\t\tthis.$musicPopin.remove();\r\n\t}\r\n};\r\n","function Room(socket, name, user, users, messages, options)\r\n{\r\n\tthis.socket = socket;\r\n\tthis.name = name;\r\n\tthis.user = user;\r\n\r\n\tthis.dices = new Dices(this);\r\n\tif(hasWebGLSupport()){\r\n\t\tthis.dice = new Dices3D(this, window.innerWidth, window.innerHeight);\r\n\t} else {\r\n\t\tthis.dice = new Dices2D(this, window.innerWidth, window.innerHeight);\r\n\t}\r\n\tthis.users = new Users(this, users);\r\n\tthis.images = new Images(this);\r\n\tthis.chat = new Chat(this, messages);\r\n\tthis.music = new Music(this);\r\n\tthis.options = options;\r\n\r\n\tthis.$roomName = $(\"#room-name\");\r\n\tthis.$logout = $(\"#logout\");\r\n\r\n\tthis.init(users);\r\n}\r\n\r\nRoom.prototype.init = function(users)\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.$roomName.text(this.name);\r\n\r\n\t// Is admin\r\n\tif(this.user.admin)\r\n\t{\r\n\t\t$(\"body\").addClass('admin-layout');\r\n\t}\r\n\r\n\t// Login out\r\n\tthis.$logout.on(\"click.room\", function(e){\r\n\t\te.preventDefault();\r\n\t\tCookies.remove('login');\r\n\t\tthat.destroy();\t\t\r\n\t\twindow.location.href = window.location.href;\r\n\t});\r\n\r\n\tthis.socket.on('disconnect', function(){\r\n\t\tthat.destroy();\t\t\r\n\t\twindow.location.href = window.location.href;\r\n\t});\r\n};\r\n\r\nRoom.prototype.destroy = function()\r\n{\r\n\t$(\"body\").removeClass('admin-layout');\r\n\tthis.$roomName.text(\"\");\r\n\tthis.$logout.off(\".room\");\r\n\r\n\tthis.dices.destroy();\r\n\tthis.users.destroy();\r\n\tthis.chat.destroy();\r\n\tthis.music.destroy();\r\n};","function Users(room, users)\r\n{\r\n\tthis.room = room;\r\n\tthis.users = [];\r\n\tthis.grabbed = null;\r\n\tthis.ghost = null;\r\n\r\n\tthis.$users = $(\"#users\");\r\n\tthis.item;\r\n\r\n\tthis.init(users);\r\n}\r\n\r\nUsers.prototype.getUserByName = function(name) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].name.toLowerCase() == name.toLowerCase())\r\n\t\t\treturn this.users[i];\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nUsers.prototype.getUserById = function(id) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].id == id)\r\n\t\t\treturn this.users[i];\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nUsers.prototype.getIndexById = function(id) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].id == id)\r\n\t\t\treturn i;\r\n\t}\r\n\r\n\treturn -1;\r\n};\r\n\r\nUsers.prototype.showUser = function(user)\r\n{\r\n\tvar c = \"user\";\r\n\tif(user.admin) c += \" admin\";\r\n\tif(user.name == this.room.user.name) c += \" me\";\r\n\r\n\tvar $caracs =\r\n\t\t'<div class=\"user-details mui-panel\">' +\r\n\t\t\t'<!--<div class=\"title\"><strong>Characteristics</strong></div>' +\r\n\t\t\t'<div class=\"user-health noselect\" data-carac=\"health\"><i class=\"fa fa-heart\"></i> <span>8</span></div>' +\r\n\t\t\t'<div class=\"user-defense noselect\" data-carac=\"defense\"><i class=\"fa fa-shield\"></i> <span>8</span></div>-->' +\r\n\t\t\t'<div class=\"title\"><strong>Tokens</strong></div>' +\r\n\t\t\t'<div class=\"user-tokens\"></div>' +\r\n\t\t'</div>';\r\n\r\n\tvar $user = '<li data-user=\"'+user.id+'\" data-sort=\"'+user.order+'\" class=\"user-item '+c+'\" id=\"user-'+user.id+'\">'+user.name+'<span class=\"user-dice\"></span>'+$caracs+'</li>';\r\n\r\n\tif(user.admin) {\r\n\t\tthis.$users.prepend($user);\r\n\t} else {\r\n\t\tthis.$users.append($user);\r\n\t}\r\n\r\n\tthis.refreshTokens(user);\r\n};\r\n\r\nUsers.prototype.addUser = function(user)\r\n{\r\n\tif(user.admin) {\r\n\t\tthis.users.unshift(user);\r\n\t} else {\r\n\t\tthis.users.push(user);\r\n\t}\r\n\r\n\tthis.showUser(user);\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.removeUser = function(user)\r\n{\r\n\tvar index = this.getIndexById(user.id);\r\n\tif(index >= 0)\r\n\t\tthis.users.splice(index, 1);\r\n\r\n\t$(\"#user-\"+user.id).remove();\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.refreshTokens = function(user)\r\n{\r\n\tu = this.getUserById(user.id);\r\n\tif(u){\r\n\t\tu.tokens = user.tokens;\r\n\t\tvar ts = $(\"#user-\"+user.id+\" .user-tokens\");\r\n\t\tvar tok = \"\";\r\n\r\n\t\tfor(var t in u.tokens){\r\n\t\t\ttok += '<div class=\"token '+t+'\" data-user=\"'+user.id+'\" data-token=\"'+t+'\">'+u.tokens[t]+'</div>';\r\n\t\t}\r\n\r\n\t\tif(tok == \"\"){\r\n\t\t\tts.html('<div class=\"notoken\">No tokens</div>');\r\n\t\t} else {\r\n\t\t\tts.html(tok);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nUsers.prototype.typingStart = function(user)\r\n{\r\n\t$(\"#user-\"+user.id).addClass(\"typing\");\r\n};\r\n\r\nUsers.prototype.typingStop = function(user)\r\n{\r\n\t$(\"#user-\"+user.id).removeClass(\"typing\");\r\n};\r\n\r\nUsers.prototype.showLastDice = function(user, dice)\r\n{\r\n\t$(\"#user-\"+user.id).find(\".user-dice\").html(dice);\r\n};\r\n\r\nUsers.prototype.grab = function(elem, position)\r\n{\r\n\tif(this.grabbed !== null || !this.room.user.admin || elem.hasClass('admin'))\r\n\t\treturn;\r\n\r\n\tvar self = this;\r\n\t$('body').addClass('grabbing');\r\n\tthis.ghost = elem.clone()\r\n\t\t.css({\r\n\t\t\tposition: \"absolute\",\r\n\t\t\ttop: \"0\",\r\n\t\t\tleft: \"0\",\r\n\t\t\twidth: elem.outerWidth()+'px',\r\n\t\t\ttransform: \"translate(\"+position.x+\"px, \"+position.y+\"px)\"\r\n\t\t})\r\n\t\t.appendTo('body');\r\n\tthis.grabbed = elem.addClass('grabbing');\r\n\r\n\t$('body').on('mouseup.sortable', function(e){\r\n\t\te.preventDefault();\r\n\t\tself.release({x:e.pageX, y:e.pageY});\r\n\t});\r\n\r\n\t$('body').on('mousemove.sortable', function(e){\r\n\t\te.preventDefault();\r\n\t\tself.grabbing({x:e.pageX, y:e.pageY});\r\n\t});\r\n};\r\n\r\nUsers.prototype.grabbing = function(position)\r\n{\r\n\tif(this.grabbed === null)\r\n\t\treturn;\r\n\r\n\tvar self = this;\r\n\tthis.ghost.css(\"transform\", \"translate(\"+position.x+\"px, \"+position.y+\"px)\");\r\n\r\n\tthis.items.each(function(){\r\n\t\tvar $this = $(this);\r\n\t\tif(!$this.hasClass('grabbing') && !$this.hasClass('admin')){\r\n\t\t\tvar top = $this.offset().top;\r\n\t\t\tvar height = $this.outerHeight();\r\n\t\t\tif(top < position.y && position.y< top + height){\r\n\t\t\t\t// if is in range\r\n\t\t\t\tif(position.y> top + height / 2){\r\n\t\t\t\t\tself.grabbed.after($this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.grabbed.before($this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n\r\nUsers.prototype.release = function()\r\n{\r\n\tif(this.grabbed === null)\r\n\t\treturn;\r\n\r\n\t$('body').removeClass('grabbing');\r\n\tthis.grabbed.removeClass('grabbing');\r\n\tthis.grabbed = null;\r\n\tthis.ghost.remove();\r\n\tthis.ghost = null;\r\n\t$('body').off('.sortable');\r\n\r\n\tif(this.room.user.admin)\r\n\t\tthis.ordering();\r\n};\r\n\r\nUsers.prototype.order = function()\r\n{\r\n\tvar that = this;\r\n\tthis.items = this.$users.find('.user').sort(function(a, b){\r\n\t\treturn parseInt($(a).data('sort'), 10) - parseInt($(b).data('sort'), 10);\r\n\t}).each(function(index){\r\n\t\tvar order = $(this).data('sort');\r\n\t\tthat.$users.append($(this));\r\n\t});\r\n};\r\n\r\nUsers.prototype.ordering = function()\r\n{\r\n\tvar data = {};\r\n\tthis.items = this.$users.find('.user');\r\n\tthis.items.each(function(index){\r\n\t\t$(this).data('sort', index);\r\n\t\tvar id = $(this).data('user');\r\n\t\tif(id && index)\r\n\t\t\tdata[id] = index;\r\n\t});\r\n\r\n\tthis.room.socket.emit('user order', data);\r\n};\r\n\r\nUsers.prototype.sort = function(list)\r\n{\r\n\tfor(var l in list){\r\n\t\tl = parseInt(l, 10);\r\n\t\tvar user = this.getUserById(l);\r\n\t\tif(user){\r\n\t\t\tuser.order = parseInt(list[l], 10);\r\n\t\t\t$(\"#user-\"+l).data('sort', list[l]);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.init = function(users)\r\n{\r\n\tvar that = this;\r\n\r\n\t// Setup users\r\n\tfor(var i = 0, length = users.length; i < length; i++){\r\n\t\tvar user = users[i];\r\n\t\tif(user.connected){\r\n\t\t\tif(user.name.toLowerCase() == this.room.user.name.toLowerCase()){\r\n\t\t\t\tuser = this.room.user;\r\n\t\t\t}\r\n\r\n\t\t\tthis.addUser(user);\r\n\t\t\tthis.refreshTokens(user);\r\n\t\t}\r\n\t}\r\n\r\n\t// Users connexions\r\n\tthis.room.socket.on('user login', function(data){\r\n\t\tthat.addUser(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('user logout', function(data){\r\n\t\tthat.removeUser(data);\r\n\t});\r\n\r\n\t// Users typing\r\n\tthis.room.socket.on('typing start', function(data){\r\n\t\tthat.typingStart(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('typing stop', function(data){\r\n\t\tthat.typingStop(data);\r\n\t});\r\n\r\n\t// User token\r\n\tthis.room.socket.on('token give', function(data){\r\n\t\tthat.refreshTokens(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('token use', function(data, token){\r\n\t\tthat.refreshTokens(data);\r\n\t\tvar token = $(\r\n\t\t\t'<div id=\"token-popin-'+data.id+'\" class=\"before overlay centerer\">'+\r\n\t\t\t\t'<div class=\"popin centered mui-panel text-align-center\">'+\r\n\t\t\t\t\t'<h3>'+data.name+' use '+token+' token</h3>'+\r\n\t\t\t\t\t'<div class=\"'+token+' token big\">&nbsp;</div>'+\r\n\t\t\t\t'</div>'+\r\n\t\t\t'</div>');\r\n\t\t$('body').append(token);\r\n\r\n\t\ttoken.delay(2000).fadeOut(300, function(){$(\"#token-popin-\"+data.id).remove();});\r\n\t\tsetTimeout(function(){token.removeClass('before');});\r\n\t});\r\n\r\n\t// User order\r\n\tthis.room.socket.on('user order', function(data){\r\n\t\tthat.sort(data);\r\n\t});\r\n\r\n\tif(this.room.user.admin){\r\n\t\tthis.$users.on('mousedown.sortable', '.user-details', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\r\n\t\tthis.$users.on('mousedown.sortable', '.user', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.grab($(this), {x:e.pageX, y:e.pageY});\r\n\t\t});\r\n\r\n\t\t$('body').on('click.token', '#users .user .token', function(){\r\n\t\t\tthat.room.socket.emit('token use', $(this).data('user'), $(this).data('token'));\r\n\t\t});\r\n\t} else {\r\n\t\t$('body').on('click.token', '#user-'+this.room.user.id+' .token', function(){\r\n\t\t\tthat.room.socket.emit('token use', that.room.user.id, $(this).data('token'));\r\n\t\t});\r\n\t}\r\n\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.destroy = function()\r\n{\r\n\tthis.room.socket.removeAllListeners('user login');\r\n\tthis.room.socket.removeAllListeners('user logout');\r\n\tthis.room.socket.removeAllListeners('typing start');\r\n\tthis.room.socket.removeAllListeners('typing stop');\r\n\tthis.$users.off('.sortable');\r\n\t$('body').off('.token').off('.sortable');\r\n};\r\n","(function(){\r\n\r\n\t//\r\n\t// Socket connection and login gestion\r\n\t//\r\n\r\n\tvar config = Config || {};\r\n\tvar url = config.url || 'http://localhost:3030';\r\n\tvar socket = io(url);\r\n\r\n\tvar room;\r\n\tvar loading = false;\r\n\r\n\tfunction loginRoom(item, room, user, action)\r\n\t{\r\n\t\tif(room == \"\" || user == \"\" || loading)\r\n\t\t\treturn false;\r\n\r\n\t\tloading = true;\r\n\t\titem.append('<span id=\"loading\">&nbsp;&nbsp;<i class=\"fa fa-spin fa-refresh\"></i></span>');\r\n\t\tsocket.emit(action, { room: room, user: user });\r\n\t}\r\n\r\n\t// Join room\r\n\tfunction joinRoom()\r\n\t{\r\n\t\tloginRoom($(\"#join\"), $(\"#room\").val(), $(\"#user\").val(), 'room join');\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Create room\r\n\tfunction createRoom()\r\n\t{\r\n\t\tloginRoom($(\"#create\"), $(\"#room\").val(), $(\"#user\").val(), 'room create');\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Init\r\n\tfunction init()\r\n\t{\r\n\t\t// Wait for server login event and create Room Object\r\n\t\tsocket.on('login', function(data){\r\n\t\t\tloading = false;\r\n\t\t\t$(\"#loading\").remove();\r\n\r\n\t\t\tif(!data.succes){\r\n\t\t\t\t$(\"#login-msg\").html(data.error).addClass('error');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\troom = new Room(socket, data.room.name, data.user, data.room.users, data.room.messages, data.room.settings);\r\n\t\t\tCookies.set('login', data.room.name+'|'+data.user.name, { expires: 356 });\r\n\r\n\t\t\t$(\".login-wrapper\").fadeOut(300);\r\n\t\t});\r\n\r\n\t\t// Handle click events\r\n\t\t$(\"#login\").submit(joinRoom);\r\n\t\t$(\"#join\").click(joinRoom);\r\n\t\t$(\"#create\").click(createRoom);\r\n\r\n\t\t// If cookie try to login\r\n\t\tvar cookie = Cookies.get('login');\r\n\t\tif(cookie) {\r\n\t\t\tvar ck = cookie.split(\"|\");\r\n\t\t\tloginRoom($(\"#join\"), ck[0], ck[1], 'room join');\r\n\t\t}\r\n\t}\r\n\r\n\twindow.addEventListener('DOMContentLoaded', init);\r\n})();\r\n","/*!\r\n * JavaScript Cookie v2.0.2\r\n * https://github.com/js-cookie/js-cookie\r\n *\r\n * Copyright 2006, 2015 Klaus Hartl\r\n * Released under the MIT license\r\n */\r\n(function (factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(factory);\r\n\t} else if (typeof exports === 'object') {\r\n\t\tmodule.exports = factory();\r\n\t} else {\r\n\t\tvar _OldCookies = window.Cookies;\r\n\t\tvar api = window.Cookies = factory(window.jQuery);\r\n\t\tapi.noConflict = function () {\r\n\t\t\twindow.Cookies = _OldCookies;\r\n\t\t\treturn api;\r\n\t\t};\r\n\t}\r\n}(function () {\r\n\tfunction extend () {\r\n\t\tvar i = 0;\r\n\t\tvar result = {};\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar attributes = arguments[ i ];\r\n\t\t\tfor (var key in attributes) {\r\n\t\t\t\tresult[key] = attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction init (converter) {\r\n\t\tfunction api (key, value, attributes) {\r\n\t\t\tvar result;\r\n\r\n\t\t\t// Write\r\n\r\n\t\t\tif (arguments.length > 1) {\r\n\t\t\t\tattributes = extend({\r\n\t\t\t\t\tpath: '/'\r\n\t\t\t\t}, api.defaults, attributes);\r\n\r\n\t\t\t\tif (typeof attributes.expires === 'number') {\r\n\t\t\t\t\tvar expires = new Date();\r\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\r\n\t\t\t\t\tattributes.expires = expires;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tresult = JSON.stringify(value);\r\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\r\n\t\t\t\t\t\tvalue = result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\r\n\t\t\t\tvalue = encodeURIComponent(String(value));\r\n\t\t\t\tvalue = value.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\r\n\r\n\t\t\t\tkey = encodeURIComponent(String(key));\r\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\r\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\r\n\r\n\t\t\t\treturn (document.cookie = [\r\n\t\t\t\t\tkey, '=', value,\r\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\r\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\r\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\r\n\t\t\t\t\tattributes.secure ? '; secure' : ''\r\n\t\t\t\t].join(''));\r\n\t\t\t}\r\n\r\n\t\t\t// Read\r\n\r\n\t\t\tif (!key) {\r\n\t\t\t\tresult = {};\r\n\t\t\t}\r\n\r\n\t\t\t// To prevent the for loop in the first place assign an empty array\r\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\r\n\t\t\t// calling \"get()\"\r\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\r\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\tfor (; i < cookies.length; i++) {\r\n\t\t\t\tvar parts = cookies[i].split('=');\r\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\r\n\t\t\t\tvar cookie = parts.slice(1).join('=');\r\n\r\n\t\t\t\tif (cookie.charAt(0) === '\"') {\r\n\t\t\t\t\tcookie = cookie.slice(1, -1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tcookie = converter && converter(cookie, name) || cookie.replace(rdecode, decodeURIComponent);\r\n\r\n\t\t\t\t\tif (this.json) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\r\n\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (key === name) {\r\n\t\t\t\t\t\tresult = cookie;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!key) {\r\n\t\t\t\t\t\tresult[name] = cookie;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tapi.get = api.set = api;\r\n\t\tapi.getJSON = function () {\r\n\t\t\treturn api.apply({\r\n\t\t\t\tjson: true\r\n\t\t\t}, [].slice.call(arguments));\r\n\t\t};\r\n\t\tapi.defaults = {};\r\n\r\n\t\tapi.remove = function (key, attributes) {\r\n\t\t\tapi(key, '', extend(attributes, {\r\n\t\t\t\texpires: -1\r\n\t\t\t}));\r\n\t\t};\r\n\r\n\t\tapi.withConverter = init;\r\n\r\n\t\treturn api;\r\n\t}\r\n\r\n\treturn init();\r\n}));\r\n\r\njQuery.fn.putCursorAtEnd = function() {\r\n\r\n  return this.each(function() {\r\n\r\n    $(this).focus()\r\n\r\n    // If this function exists...\r\n    if (this.setSelectionRange) {\r\n      // ... then use it (Doesn't work in IE)\r\n\r\n      // Double the length because Opera is inconsistent about whether a carriage return is one character or two. Sigh.\r\n      var len = $(this).val().length * 2;\r\n\r\n      this.setSelectionRange(len, len);\r\n    \r\n    } else {\r\n    // ... otherwise replace the contents with itself\r\n    // (Doesn't work in Google Chrome)\r\n\r\n      $(this).val($(this).val());\r\n      \r\n    }\r\n\r\n    // Scroll to the bottom, in case we're in a tall textarea\r\n    // (Necessary for Firefox and Google Chrome)\r\n    this.scrollTop = 999999;\r\n\r\n  });\r\n\r\n};\r\n\r\nvar hasWebGLSupport = (function(){\r\n\tvar support = false;\r\n\tvar tested = false;\r\n\treturn function(){\r\n\t\tif(!tested){\r\n\t\t\tvar gl = null;\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\ttry { gl = canvas.getContext(\"webgl\"); }\r\n\t\t\tcatch (x) { gl = null; }\r\n\r\n\t\t\tif (gl == null) {\r\n\t\t\t\ttry { gl = canvas.getContext(\"experimental-webgl\"); experimental = true; }\r\n\t\t\t\tcatch (x) { gl = null; }\r\n\t\t\t}\r\n\r\n\t\t\tif(gl == null || !window.WebGLRenderingContext){\r\n\t\t\t\tsupport = false;\r\n\t\t\t} else {\r\n\t\t\t\tsupport = true;\r\n\t\t\t}\r\n\r\n\t\t\tcanvas = null;\r\n\t\t\ttested = true;\r\n\t\t}\r\n\r\n\t\treturn support;\r\n\t}\r\n})();"]}