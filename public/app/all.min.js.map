{"version":3,"sources":["chat.js","dice2D.js","dice3D.js","dices.js","images.js","music.js","main.js","plugins.js","room.js","users.js"],"names":["Chat","room","messages","this","msgbox","myMessages","typing","editMode","$messages","$","$message","$content","$chat","init","Dice2D","id","type","color","box","value","parseInt","replace","split","radius","scale","transform","position","x","y","z","rotation","time","createMesh","Dices2D","width","height","w","h","cw","ch","scene","dices","prototype","getMessageIndexById","i","length","addMessage","message","editable","user","name","push","getClass","data","c","admin","prive","isNewBox","command","image","showCommand","append","html","users","showLastDice","roll","dice","scrollTop","scrollHeight","showError","error","showImage","text","find","editMessage","index","myIndex","indexOf","typingStart","that","clearTimeout","socket","emit","setTimeout","typingStop","startEdit","focus","val","putCursorAtEnd","stopEdit","editPrev","editNext","checkEndEdit","on","e","preventDefault","myMsg","keyCode","destroy","off","removeAllListeners","css","top","left","lineHeight","fontSize","fontWeight","textShadow","update","values","Math","acos","PI","Date","now","ceil","random","result","remove","sqrt","DicesModels3D","copyto","obj","res","Array","copy","hasOwnProperty","constructor","makeGeometry","vertices","faces","tab","af","geom","THREE","Geometry","vertex","Vector3","fromArray","normalize","multiplyScalar","ii","fl","aa","j","Face3","faceVertexUvs","Vector2","cos","sin","computeFaceNormals","computeVertexNormals","boundingSphere","Sphere","d4","geometry","mass","inertia","d6","d8","d10","a","b","d12","p","q","d20","t","d100","materialOptions","specular","emissive","shininess","shading","FlatShading","diceLabels","d10Labels","d100Labels","idealTextColor","bgColor","components","getRGBComponents","R","G","B","r","substring","g","makeDiceMaterials","diceColor","faceLabels","size","margin","materials","MeshPhongMaterial","map","backColor","undefined","canvas","document","createElement","context","getContext","font","fillStyle","fillRect","textAlign","textBaseline","fillText","texture","Texture","needsUpdate","createTextTexture","makeD4Materials","labels","translate","rotate","createD4Text","Dice3D","renderer","render","camera","Dices3D","aspect","desk","light","Dice","rolls","cooldown","$item","pop","Dices","defaultDices","$dices","reset","Images","$zoom","LocalPlayer","music","audio","Audio","volet","YoutubePlayer","youtube","$musicUrl","$playLater","$playNow","Music","playlist","current","savedVolume","currentVolume","localPlayer","youtubePlayer","player","$play","$mute","$volume","$bar","$musicPlayer","$musicPopin","model","mesh","Mesh","MeshFaceMaterial","castShadow","receiveShadow","quaternion","add","resize","window","innerWidth","innerHeight","min","wh","tan","far","updateProjectionMatrix","mw","max","set","target","setSize","WebGLRenderingContext","WebGLRenderer","CanvasRenderer","antialias","alpha","shadowMapEnabled","shadowMapSoft","setClearColor","Scene","fog","domElement","PerspectiveCamera","ambientLight","AmbientLight","SpotLight","shadowCameraNear","shadowCameraFar","shadowCameraFov","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","planeFragmentShader","ShaderChunk","join","planeMaterial","ShaderMaterial","uniforms","ShaderLib","vertexShader","fragmentShader","PlaneGeometry","addEventListener","bind","addClass","removeClass","each","d","show","sort","children","detach","exist","$this","hasClass","url","close","zoom","src","upload","shift","reader","FileReader","onload","evt","readAsDataURL","download","originalEvent","dataTransfer","files","attr","Config","io","loading","loginRoom","item","action","joinRoom","createRoom","succes","Room","settings","Cookies","expires","fadeOut","submit","click","cookie","get","ck","body","appendChild","autoplay","loop","post","crawlSongs","song","parent","elem","songs","next","musiclist","title","start","track","play","pause","volume","v","console","log","parentNode","removeChild","tag","firstScriptTag","getElementsByTagName","onPlayerReady","event","parse","parseURL","onPlayerStateChange","YT","PlayerState","PLAYING","getPlaylistIndex","ENDED","getPlaylist","insertBefore","onYouTubeIframeAPIReady","Player","events","onReady","onStateChange","loadPlaylist","list","pauseVideo","playVideo","setVolume","load","l","className","mute","unmute","round","offsetX","offset","clientX","fadeIn","factory","_OldCookies","api","define","amd","exports","module","jQuery","noConflict","extend","arguments","key","attributes","converter","path","defaults","setMilliseconds","getMilliseconds","JSON","stringify","test","encodeURIComponent","String","decodeURIComponent","escape","toUTCString","domain","secure","cookies","rdecode","parts","slice","charAt","json","getJSON","apply","call","withConverter","fn","len","setSelectionRange","hasWebGLSupport","support","tested","gl","experimental","options","Users","images","chat","$options","$roomName","$logout","optionsOpened","grabbed","ghost","$users","proxy","saveOptions","closeOptions","showOptions","location","href","contenu","customRoll","dices3D","prop","getUserByName","toLowerCase","getUserById","getIndexById","showUser","$user","order","prepend","refreshTokens","addUser","unshift","removeUser","splice","u","tokens","ts","tok","grab","self","clone","outerWidth","appendTo","release","pageX","pageY","grabbing","items","outerHeight","after","before","ordering","connected","token","delay","stopPropagation"],"mappings":"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","file":"all.min.js","sourcesContent":["function Chat(room, messages)\r\n{\r\n\tthis.msgbox = 0;\r\n\tthis.room = room;\r\n\tthis.messages = [];\r\n\tthis.myMessages = [];\r\n\tthis.typing = null;\r\n\tthis.editMode = -1;\r\n\r\n\tthis.$messages = $(\"#messages\");\r\n\tthis.$message = $(\"#message\");\r\n\tthis.$content = $(\"#content\");\r\n\tthis.$chat = $(\"#chat\");\r\n\r\n\tthis.init(messages);\r\n}\r\n\r\nChat.prototype.getMessageIndexById = function(id)\r\n{\r\n\tfor (var i = this.messages.length - 1; i >= 0; i--)\r\n\t{\r\n\t\tif(this.messages[i].id == id)\r\n\t\t\treturn i;\r\n\t}\r\n\r\n\treturn -1;\r\n};\r\n\r\nChat.prototype.addMessage = function(message, editable)\r\n{\r\n\t// On garde aussi en référence uniquement mes messages\r\n\tif(message.user.name == this.room.user.name && editable)\r\n\t\tthis.myMessages.push(message);\r\n\r\n\tthis.messages.push(message);\r\n};\r\n\r\nChat.prototype.getClass = function(data) {\r\n\tvar c = '';\r\n\tif(data.user.name == this.room.user.name) c += ' me';\r\n\tif(data.user.admin) c += ' admin';\r\n\tif(data.prive) c += ' prive';\r\n\r\n\treturn c;\r\n};\r\n\r\nChat.prototype.isNewBox = function(data)\r\n{\r\n\treturn !(\r\n\t\tthis.messages.length > 0 &&\r\n\t\tthis.messages[this.messages.length-1].user.name == data.user.name &&\r\n\t\t!this.messages[this.messages.length-1].command &&\r\n\t\t!this.messages[this.messages.length-1].image &&\r\n\t\tthis.messages[this.messages.length-1].prive == data.prive\r\n\t);\r\n};\r\n\r\nChat.prototype.showCommand = function(data)\r\n{\r\n\tswitch(data.command){\r\n\t\tcase \"/roll\":\r\n\t\t\tthis.$messages.append($('<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"diceroll mui-panel'+this.getClass(data)+'\">').html('<span class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</span> '+data.message));\r\n\t\t\tthis.addMessage(data, false);\r\n\t\t\tthis.room.users.showLastDice(data.user, data.message);\r\n\t\t\tif(data.user.name == this.room.user.name) this.room.dices.roll(data.dice);\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n\r\n\treturn true;\r\n};\r\n\r\nChat.prototype.showError = function(data)\r\n{\r\n\tdata.user.name = \"error\";\r\n\tthis.$messages.append($('<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message '+data.error+' me\">').html(data.message));\r\n\tthis.addMessage(data, false);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n\treturn;\r\n};\r\n\r\nChat.prototype.showImage = function(data)\r\n{\r\n\tvar text = '<div id=\"image-'+data.image+'\"><a href=\"#\" data-image=\"'+data.image+'\">Download image '+data.name+'</a></div>';\r\n\tif(this.isNewBox(data))\r\n\t{\r\n\t\tthis.$messages.append(\r\n\t\t\t'<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message mui-panel'+this.getClass(data)+'\">'+\r\n\t\t\t\t'<div class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</div> '+\r\n\t\t\t\t'<div class=\"text\">'+text+'</div>'+\r\n\t\t\t'</li>'\r\n\t\t);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$('#msgbox-'+this.msgbox).find('.text').append(text);\r\n\t}\r\n\t\r\n\tthis.addMessage(data, false);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n};\r\n\r\nChat.prototype.message = function(data)\r\n{\r\n\tif(data.error){\r\n\t\tthis.showError(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(data.command){\r\n\t\tthis.showCommand(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(typeof data.image !== \"undefined\"){\r\n\t\tthis.showImage(data);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif(this.isNewBox(data))\r\n\t{\r\n\t\t// Nouvelle box\r\n\t\tthis.$messages.append(\r\n\t\t\t'<li id=\"msgbox-'+(++this.msgbox)+'\" class=\"message mui-panel'+this.getClass(data)+'\">'+\r\n\t\t\t\t'<div class=\"user\">'+((data.prive) ? data.user.name+' to '+data.prive : data.user.name)+':</div> '+\r\n\t\t\t\t'<div class=\"text\"><div id=\"msg-'+data.id+'\">'+data.message+'</div></div>'+\r\n\t\t\t'</li>'\r\n\t\t);\r\n\t} \r\n\telse\r\n\t{\r\n\t\t// On ne crée pas de nouvelle box\r\n\t\t$('#msgbox-'+this.msgbox).find('.text').append('<div id=\"msg-'+data.id+'\">'+data.message+'</div>');\r\n\t}\r\n\r\n\tthis.addMessage(data, true);\r\n\tthis.$content.scrollTop(this.$content[0].scrollHeight);\r\n};\r\n\r\nChat.prototype.editMessage = function(data)\r\n{\r\n\t// Errors, command and images aren't editable\r\n\tif(data.error || data.command || data.image) return;\r\n\r\n\tvar index = this.getMessageIndexById(data.id);\r\n\tif(index >= 0)\r\n\t{\r\n\t\tvar myIndex = this.myMessages.indexOf(this.messages[index]);\r\n\t\tif(myIndex >= 0)\r\n\t\t\tthis.myMessages[myIndex] = data;\r\n\r\n\t\tthis.messages[index] = data;\r\n\t\t$(\"#msg-\"+data.id).html(data.message);\r\n\t}\r\n};\r\n\r\nChat.prototype.typingStart = function()\r\n{\r\n\tvar that = this;\r\n\tif(this.typing)\r\n\t{\r\n\t\t// Si typing en cours, on update\r\n\t\tclearTimeout(this.typing);\r\n\t\tthis.typing = setTimeout(function(){ that.typingStop(); }, 2500);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t// Sinon on emet l'info\r\n\t\tthis.room.socket.emit('typing start');\r\n\t\tthis.typing = setTimeout(function(){ that.typingStop(); }, 2500);\r\n\t}\r\n};\r\n\r\nChat.prototype.typingStop = function()\r\n{\r\n\tclearTimeout(this.typing);\r\n\tthis.typing = null;\r\n\tthis.room.socket.emit('typing stop');\r\n};\r\n\r\nChat.prototype.startEdit = function()\r\n{\r\n\tif(this.editMode >= 0){\r\n\t\tvar that = this;\r\n\t\tthis.$message.focus();\r\n\t\tthis.$message.val(this.myMessages[this.editMode].message);\r\n\t\tsetTimeout(function(){ that.$message.putCursorAtEnd(); }, 0);\r\n\t}\r\n};\r\n\r\nChat.prototype.stopEdit = function()\r\n{\r\n\tif(this.editMode >= 0){\r\n\t\tthis.$message.val(\"\");\r\n\t\tthis.editMode = -1;\r\n\t}\r\n};\r\n\r\nChat.prototype.editPrev = function()\r\n{\r\n\tif(this.editMode <= 0)\r\n\t\tthis.editMode = this.myMessages.length;\r\n\r\n\t--this.editMode;\r\n\tthis.startEdit();\r\n};\r\n\r\nChat.prototype.editNext = function()\r\n{\r\n\t++this.editMode;\r\n\r\n\tif(this.editMode >= this.myMessages.length)\r\n\t{\r\n\t\tthis.stopEdit();\r\n\t}\r\n\telse\r\n\t{\r\n\t\tthis.startEdit();\r\n\t}\r\n};\r\n\r\nChat.prototype.checkEndEdit = function() \r\n{\r\n\tif(this.$message.val() == \"\")\r\n\t{\r\n\t\tthis.editMode = -1;\r\n\t}\r\n};\r\n\r\nChat.prototype.init = function(messages)\r\n{\r\n\tvar that = this;\r\n\r\n\t// Ajouter messages existants\r\n\tfor (i = 0, length = messages.length; i < length; i++) {\r\n\t\tthis.message(messages[i]);\r\n\t}\r\n\r\n\t// Envoyer message\r\n\tthis.$chat.on(\"submit.chat\", function(e){\r\n\t\te.preventDefault();\r\n\r\n\t\tvar message = that.$message.val();\r\n\r\n\t\tif(message != \"\")\r\n\t\t{\r\n\t\t\tif (that.editMode >= 0)\r\n\t\t\t{\r\n\t\t\t\tvar myMsg = that.myMessages[that.editMode];\r\n\t\t\t\tif(myMsg.prive)\r\n\t\t\t\t\tmessage = \"@\"+myMsg.prive+\" \"+message;\r\n\r\n\t\t\t\tthat.room.socket.emit(\"chat edit\", myMsg.id, message);\r\n\t\t\t\tthat.stopEdit();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthat.room.socket.emit(\"chat\", message);\r\n\t\t\t}\r\n\r\n\t\t\tthat.$message.val('');\r\n\t\t\tthat.checkEndEdit();\r\n\t\t\tthat.typingStop();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\t// Recevoir messages\r\n\tthis.room.socket.on('chat', function(data){\r\n\t\tthat.message(data);\r\n\t});\r\n\r\n\t// Gestion du typing\r\n\tthis.$message.on(\"keypress.chat\", function(e){\r\n\t\t// e.keyCode : 8 back, 13 entrée\r\n\t\tif(e.keyCode != 8 && e.keyCode != 13)\r\n\t\t{\r\n\t\t\tthat.typingStart();\r\n\t\t}\r\n\t});\r\n\r\n\t// Gestion de l'édition\r\n\tthis.room.socket.on('chat edit', function(data){\r\n\t\tthat.editMessage(data);\r\n\t});\r\n\r\n\tthis.$message.on(\"keydown.chat\", function(e){\r\n\t\t// Key up\r\n\t\tif(e.keyCode == 38)\r\n\t\t{\r\n\t\t\tthat.editPrev();\r\n\t\t}\r\n\t\t// Key down\r\n\t\telse if(e.keyCode == 40)\r\n\t\t{\r\n\t\t\tthat.editNext();\r\n\t\t}\r\n\t\t// Key return or suppr\r\n\t\telse if(e.keyCode == 8 || e.keyCode == 46)\r\n\t\t{\r\n\t\t\tthat.checkEndEdit();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nChat.prototype.destroy = function()\r\n{\r\n\tthis.$chat.off(\".chat\");\r\n\tthis.$message.off(\".chat\");\r\n\tthis.room.socket.removeAllListeners('chat');\r\n\tthis.room.socket.removeAllListeners('chat edit');\r\n};","\"use strict\";\r\n\r\nfunction Dice2D(id, type, color, box)\r\n{\r\n\tthis.id = id;\r\n\tthis.type = type;\r\n\tthis.value = parseInt(this.type.replace('d', '').split(' ')[0]);\r\n\tthis.box = box;\r\n\tthis.radius = 0.25 * this.box.scale;\r\n\tthis.color = color;\r\n\tthis.transform;\r\n\r\n\tthis.position = {x: 0, y: 0, z: 0};\r\n\tthis.rotation = 0;\r\n\tthis.time = 0;\r\n\r\n\tthis.createMesh();\r\n}\r\n\r\nDice2D.prototype.createMesh = function()\r\n{\r\n\tthis.transform = $('<div class=\"dice '+this.type+'\"></div>').css({\r\n\t\tposition: \"absolute\",\r\n\t\ttop: -this.radius,\r\n\t\tleft: -this.radius,\r\n\t\twidth: this.radius * 2,\r\n\t\theight: this.radius * 2,\r\n\t\tlineHeight: this.radius * 2 + \"px\",\r\n\t\tfontSize: this.radius * 0.75 + \"px\",\r\n\t\tfontWeight: \"bold\",\r\n\t\ttextShadow: \"2px 2px 0px #000000, 2px -2px 0px #000000, -2px -2px 0px #000000, -2px 2px 0px #000000\"\r\n\t});\r\n\r\n\tthis.box.scene.append(this.transform);\r\n};\r\n\r\nDice2D.prototype.update = function(values)\r\n{\r\n\tthis.position.x = values[0] * this.box.w / 1000 / 2 + this.box.cw;\r\n\tthis.position.y = this.box.ch - values[1] * this.box.h / 1000 / 2;\r\n\tthis.position.z = values[2];\r\n\tthis.rotation = (((2 * Math.acos(values[3])) * 180 / Math.PI) + 180) % 360;\r\n\r\n\tthis.transform.css(\"transform\", \"translate3d(\"+this.position.x+\"px, \"+this.position.y+\"px, \"+this.position.z+\"px) rotate(\"+this.rotation+\"deg)\");\r\n\tif(Date.now() - this.time > 166){\r\n\t\tthis.transform.html(Math.ceil(Math.random() * this.value));\r\n\t\tthis.time = Date.now();\r\n\t}\r\n};\r\n\r\nDice2D.prototype.result = function(value)\r\n{\r\n\tthis.transform.html(value);\r\n};\r\n\r\nDice2D.prototype.remove = function() {\r\n\tthis.transform.remove();\r\n\tdelete this.box.dices[this.id];\r\n};\r\n\r\nfunction Dices2D(room, width, height)\r\n{\r\n\tthis.room = room;\r\n\tthis.w = width;\r\n\tthis.h = height;\r\n\tthis.cw;\r\n\tthis.ch;\r\n\tthis.scale;\r\n\tthis.scene;\r\n\r\n\tthis.dices = {};\r\n\r\n\tthis.init();\r\n}\r\n\r\nDices2D.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tthis.dices = {};\r\n\tthis.scene = $(\"#dice-box\");\r\n\r\n\tthis.room.socket.on('dice start', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tthat.dices[data[i].id] = new Dice2D(data[i].id, data[i].type, data[i].color, that);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice update', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].update(data[i]);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice result', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].result(data[i]);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice end', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tif(that.dices[data[i]]) that.dices[data[i]].remove();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nDices2D.prototype.remove = function() {\r\n\tthis.room.socket.removeAllListeners('dice start');\r\n\tthis.room.socket.removeAllListeners('dice update');\r\n\tthis.room.socket.removeAllListeners('dice result');\r\n\tthis.room.socket.removeAllListeners('dice end');\r\n};","\"use strict\";\r\n\r\nvar DicesModels3D = {};\r\n\r\nDicesModels3D.d4 = {\r\n\tgeometry: {\r\n\t\tvertices: [[1, 1, 1], [-1, -1, 1], [-1, 1, -1], [1, -1, -1]],\r\n\t\tfaces: [[1, 0, 2, 1], [0, 1, 3, 2], [0, 3, 2, 3], [1, 2, 3, 4]],\r\n\t\ttab: -0.1,\r\n\t\taf: Math.PI * 7 / 6\r\n\t},\r\n\tmass: 300,\r\n\tinertia: 5,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d6 = {\r\n\tgeometry: {\r\n\t\tvertices: [[-1, -1, -1], [1, -1, -1], [1, 1, -1], [-1, 1, -1], [-1, -1, 1], [1, -1, 1], [1, 1, 1], [-1, 1, 1]],\r\n\t\tfaces: [[0, 3, 2, 1, 1], [1, 2, 6, 5, 2], [0, 1, 5, 4, 3], [3, 7, 6, 2, 4], [0, 4, 7, 3, 5], [4, 5, 6, 7, 6]],\r\n\t\ttab: 0.1,\r\n\t\taf: Math.PI / 4\r\n\t},\r\n\tmass: 300,\r\n\tinertia: 13,\r\n\tscale: 1.1\r\n};\r\n\r\nDicesModels3D.d8 = {\r\n\tgeometry: {\r\n\t\tvertices: [[1, 0, 0], [-1, 0, 0], [0, 1, 0], [0, -1, 0], [0, 0, 1], [0, 0, -1]],\r\n\t\tfaces: [[0, 2, 4, 1], [0, 4, 3, 2], [0, 3, 5, 3], [0, 5, 2, 4], [1, 3, 4, 5], [1, 4, 2, 6], [1, 2, 5, 7], [1, 5, 3, 8]],\r\n\t\ttab: 0,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 340,\r\n\tinertia: 10,\r\n\tscale: 1.1\r\n};\r\n\r\nDicesModels3D.d10 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar a = Math.PI * 2 / 10, k = Math.cos(a), h = 0.105;\r\n\t\t\tvar vertices = [];\r\n\t\t\tfor (var i = 0, b = 0; i < 10; ++i, b += a)\r\n\t\t\t\tvertices.push([Math.cos(b), Math.sin(b), h * (i % 2 ? 1 : -1)]);\r\n\t\t\tvertices.push([0, 0, -1]); vertices.push([0, 0, 1]);\r\n\t\t\treturn vertices;\r\n\t\t}(),\r\n\t\tfaces: [\r\n\t\t\t[5, 7, 11, 0], [4, 2, 10, 1], [1, 3, 11, 2], [0, 8, 10, 3], [7, 9, 11, 4],\r\n\t\t\t[8, 6, 10, 5], [9, 1, 11, 6], [2, 0, 10, 7], [3, 5, 11, 8], [6, 4, 10, 9],\r\n\t\t\t[5, 6, 7, -1], [3, 2, 4, -1], [1, 2, 3, -1], [9, 8, 0, -1], [7, 8, 9, -1],\r\n\t\t\t[7, 6, 8, -1], [9, 0, 1, -1], [1, 0, 2, -1], [3, 4, 5, -1], [5, 4, 6, -1]\r\n\t\t],\r\n\t\ttab: 0,\r\n\t\taf: Math.PI * 6 / 5\r\n\t},\r\n\tmass: 350,\r\n\tinertia: 9,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d12 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar p = (1 + Math.sqrt(5)) / 2, q = 1 / p;\r\n\t\t\treturn [[0, q, p], [0, q, -p], [0, -q, p], [0, -q, -p], [p, 0, q], [p, 0, -q], [-p, 0, q], [-p, 0, -q], [q, p, 0], [q, -p, 0], [-q, p, 0], [-q, -p, 0], [1, 1, 1], [1, 1, -1], [1, -1, 1], [1, -1, -1], [-1, 1, 1], [-1, 1, -1], [-1, -1, 1], [-1, -1, -1]];\r\n\t\t}(),\r\n\t\tfaces: [[2, 14, 4, 12, 0, 1], [15, 9, 11, 19, 3, 2], [16, 10, 17, 7, 6, 3], [6, 7, 19, 11, 18, 4], [6, 18, 2, 0, 16, 5], [18, 11, 9, 14, 2, 6], [1, 17, 10, 8, 13, 7], [1, 13, 5, 15, 3, 8], [13, 8, 12, 4, 5, 9], [5, 4, 14, 9, 15, 10], [0, 12, 8, 10, 16, 11], [3, 19, 7, 17, 1, 12]],\r\n\t\ttab: 0.2,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 380,\r\n\tinertia: 8,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d20 = {\r\n\tgeometry: {\r\n\t\tvertices: function(){\r\n\t\t\tvar t = (1 + Math.sqrt(5)) / 2;\r\n\t\t\treturn [[-1, t, 0], [1, t, 0 ], [-1, -t, 0], [1, -t, 0], [0, -1, t], [0, 1, t], [0, -1, -t], [0, 1, -t], [t, 0, -1], [t, 0, 1], [-t, 0, -1], [-t, 0, 1]];\r\n\t\t}(),\r\n\t\tfaces: [[0, 11, 5, 1], [0, 5, 1, 2], [0, 1, 7, 3], [0, 7, 10, 4], [0, 10, 11, 5], [1, 5, 9, 6], [5, 11, 4, 7], [11, 10, 2, 8], [10, 7, 6, 9], [7, 1, 8, 10], [3, 9, 4, 11], [3, 4, 2, 12], [3, 2, 6, 13], [3, 6, 8, 14], [3, 8, 9, 15], [4, 9, 5, 16], [2, 4, 11, 17], [6, 2, 10, 18], [8, 6, 7, 19], [9, 8, 1, 20]],\r\n\t\ttab: -0.2,\r\n\t\taf: -Math.PI / 4 / 2\r\n\t},\r\n\tmass: 400,\r\n\tinertia: 6,\r\n\tscale: 1\r\n};\r\n\r\nDicesModels3D.d100 = {\r\n\tgeometry: DicesModels3D.d10.geometry,\r\n\tmass: 350,\r\n\tinertia: 9,\r\n\tscale: 1\r\n};\r\n\r\nfunction copyto(obj, res) {\r\n\tif (obj == null || typeof obj !== 'object') return obj;\r\n\tif (obj instanceof Array) {\r\n\t\tfor (var i = obj.length - 1; i >= 0; --i)\r\n\t\t\tres[i] = copy(obj[i]);\r\n\t}\r\n\telse {\r\n\t\tfor (var i in obj) {\r\n\t\t\tif (obj.hasOwnProperty(i))\r\n\t\t\t\tres[i] = copy(obj[i]);\r\n\t\t}\r\n\t}\r\n\treturn res;\r\n}\r\n\r\nfunction copy(obj) {\r\n\tif (!obj) return obj;\r\n\treturn copyto(obj, new obj.constructor());\r\n}\r\n\r\nfunction makeGeometry(vertices, faces, radius, tab, af) {\r\n\tvar geom = new THREE.Geometry();\r\n\tfor (var i = 0; i < vertices.length; ++i) {\r\n\t\tvar vertex = (new THREE.Vector3).fromArray(vertices[i]).normalize().multiplyScalar(radius);\r\n\t\tvertex.index = geom.vertices.push(vertex) - 1;\r\n\t}\r\n\tfor (var i = 0; i < faces.length; ++i) {\r\n\t\tvar ii = faces[i], fl = ii.length - 1;\r\n\t\tvar aa = Math.PI * 2 / fl;\r\n\t\tfor (var j = 0; j < fl - 2; ++j) {\r\n\t\t\tgeom.faces.push(new THREE.Face3(ii[0], ii[j + 1], ii[j + 2], [geom.vertices[ii[0]],\r\n\t\t\t\t\t\tgeom.vertices[ii[j + 1]], geom.vertices[ii[j + 2]]], 0, ii[fl] + 1));\r\n\t\t\tgeom.faceVertexUvs[0].push([\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(af) + 1 + tab) / 2 / (1 + tab)),\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab)),\r\n\t\t\t\t\tnew THREE.Vector2((Math.cos(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab),\r\n\t\t\t\t\t\t(Math.sin(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab))]);\r\n\t\t}\r\n\t}\r\n\tgeom.computeFaceNormals();\r\n\tgeom.computeVertexNormals();\r\n\tgeom.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\treturn geom;\r\n}\r\n\r\nvar materialOptions = {\r\n\tspecular: '#171d1f',\r\n\tcolor: '#ffffff',\r\n\temissive: '#000000',\r\n\tshininess: 7,\r\n\tshading: THREE.FlatShading,\r\n};\r\n\r\nvar diceLabels = [' ', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20'];\r\nvar d10Labels = [' ', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0'];\r\nvar d100Labels = [' ', '10', '20', '30', '40', '50', '60', '70', '80', '90', '00'];\r\n\r\nfunction idealTextColor(bgColor) {\r\n\r\n   var nThreshold = 105;\r\n   var components = getRGBComponents(bgColor);\r\n   var bgDelta = (components.R * 0.299) + (components.G * 0.587) + (components.B * 0.114);\r\n\r\n   return ((255 - bgDelta) < nThreshold) ? \"#000000\" : \"#ffffff\";\r\n}\r\n\r\nfunction getRGBComponents(color) {\r\n\r\n    var r = color.substring(1, 3);\r\n    var g = color.substring(3, 5);\r\n    var b = color.substring(5, 7);\r\n\r\n    return {\r\n       R: parseInt(r, 16),\r\n       G: parseInt(g, 16),\r\n       B: parseInt(b, 16)\r\n    };\r\n}\r\n\r\nfunction makeDiceMaterials(diceColor, faceLabels, size, margin) {\r\n\tfunction createTextTexture(text, color, backColor) {\r\n\t\tif (text == undefined) return null;\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tvar context = canvas.getContext(\"2d\");\r\n\t\tcanvas.width = size + margin;\r\n\t\tcanvas.height = size + margin;\r\n\t\tcontext.font = size + \"pt Arial\";\r\n\t\tcontext.fillStyle = backColor;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.fillText(text, canvas.width / 2, canvas.height / 2);\r\n\t\tif (text == '6' || text == '9') {\r\n\t\t\tcontext.fillText('  .', canvas.width / 2, canvas.height / 2);\r\n\t\t}\r\n\t\tvar texture = new THREE.Texture(canvas);\r\n\t\ttexture.needsUpdate = true;\r\n\t\treturn texture;\r\n\t}\r\n\tvar materials = [];\r\n\tfor (var i = 0; i < faceLabels.length; ++i)\r\n\t\tmaterials.push(new THREE.MeshPhongMaterial(copyto(materialOptions, { map: createTextTexture(faceLabels[i], idealTextColor(diceColor), diceColor) })));\r\n\r\n\treturn materials;\r\n}\r\n\r\nfunction makeD4Materials(diceColor, size, margin) {\r\n\tfunction createD4Text(text, color, backColor) {\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tvar context = canvas.getContext(\"2d\");\r\n\t\tcanvas.width = size + margin;\r\n\t\tcanvas.height = size + margin;\r\n\t\tcontext.font = size + \"pt Arial\";\r\n\t\tcontext.fillStyle = backColor;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.translate(0, size / 10);\r\n\t\tfor (var i in text) {\r\n\t\t\tcontext.fillText(text[i], canvas.width / 2,\r\n\t\t\t\t\tcanvas.height / 2 - size - margin / 10);\r\n\t\t\tcontext.translate(canvas.width / 2, canvas.height / 2);\r\n\t\t\tcontext.rotate(Math.PI * 2 / 3);\r\n\t\t\tcontext.translate(-canvas.width / 2, -canvas.height / 2);\r\n\t\t}\r\n\t\tvar texture = new THREE.Texture(canvas);\r\n\t\ttexture.needsUpdate = true;\r\n\t\treturn texture;\r\n\t}\r\n\tvar materials = [];\r\n\tvar labels = [[], [0, 0, 0], [2, 4, 3], [1, 3, 4], [2, 1, 4], [1, 2, 3]];\r\n\tfor (var i = 0; i < labels.length; ++i)\r\n\t\tmaterials.push(new THREE.MeshPhongMaterial(copyto(materialOptions, { map: createD4Text(labels[i], idealTextColor(diceColor), diceColor) })));\r\n\treturn materials;\r\n}\r\n\r\nfunction Dice3D(id, type, color, box)\r\n{\r\n\tthis.id = id;\r\n\tthis.type = type;\r\n\tthis.box = box;\r\n\tthis.radius = 0.6 * DicesModels3D[this.type].scale * box.scale;\r\n\tthis.color = color;\r\n\tthis.transform;\r\n\r\n\t//this.position = {x: 0, y: 0, z: 0};\r\n\t//this.rotation = {x: 0, y: 0, z: 0, w: 0};\r\n\r\n\tthis.createMesh();\r\n\r\n\tthis.box.renderer.render(this.box.scene, this.box.camera);\r\n}\r\n\r\nDice3D.prototype.createMesh = function()\r\n{\r\n\tvar model = DicesModels3D[this.type];\r\n\tvar geometry = makeGeometry(model.geometry.vertices, model.geometry.faces, this.radius, model.geometry.tab, model.geometry.af);\r\n\r\n\tvar materials;\r\n\tif(this.type == 'd4'){\r\n\t\tmaterials = makeD4Materials(this.color, this.box.scale / 3, this.box.scale);\r\n\t} else if(this.type == 'd100') {\r\n\t\tmaterials = makeDiceMaterials(this.color, d100Labels, this.box.scale / 3, this.box.scale);\r\n\t} else if(this.type == 'd10') {\r\n\t\tmaterials = makeDiceMaterials(this.color, d10Labels, this.box.scale / 3, this.box.scale);\r\n\t} else {\r\n\t\tmaterials = makeDiceMaterials(this.color, diceLabels, this.box.scale / 3, this.box.scale);\r\n\t}\r\n\r\n\tvar mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial( materials )  );\r\n\r\n\tmesh.castShadow = true;\r\n\tmesh.receiveShadow = false;\r\n\r\n\tmesh.position.x = -this.box.w * 2;\r\n\tmesh.position.y = -this.box.h * 2;\r\n\tmesh.position.z = 0;\r\n\r\n\tmesh.quaternion.x = 0;\r\n\tmesh.quaternion.y = 0;\r\n\tmesh.quaternion.z = 0;\r\n\tmesh.quaternion.w = 0;\r\n\r\n\tthis.transform = mesh;\r\n\tthis.box.scene.add(mesh);\r\n};\r\n\r\nDice3D.prototype.update = function(values)\r\n{\r\n\tthis.transform.position.x = values[0] * this.box.w / 1000;\r\n\tthis.transform.position.y = values[1] * this.box.h / 1000;\r\n\tthis.transform.position.z = values[2];\r\n\r\n\tthis.transform.quaternion.x = values[3];\r\n\tthis.transform.quaternion.y = values[4];\r\n\tthis.transform.quaternion.z = values[5];\r\n\tthis.transform.quaternion.w = values[6];\r\n};\r\n\r\nDice3D.prototype.remove = function() {\r\n\tthis.box.scene.remove(this.transform);\r\n\tdelete this.box.dices[this.id];\r\n};\r\n\r\nfunction Dices3D(room, width, height)\r\n{\r\n\tthis.room = room;\r\n\tthis.w = width;\r\n\tthis.h = height;\r\n\tthis.cw;\r\n\tthis.ch;\r\n\tthis.scene;\r\n\tthis.camera;\r\n\tthis.renderer;\r\n\tthis.aspect;\r\n\tthis.scale;\r\n\tthis.desk;\r\n\tthis.light;\r\n\r\n\tthis.dices = {};\r\n\r\n\tthis.init();\r\n}\r\n\r\nDices3D.prototype.resize = function()\r\n{\r\n\tthis.w = window.innerWidth;\r\n\tthis.h = window.innerHeight;\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\tthis.aspect = Math.min(this.cw / this.w, this.ch / this.h);\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tvar wh = Math.min(this.cw, this.ch) / this.aspect / Math.tan(10 * Math.PI / 180);\r\n\tthis.camera.aspect = this.cw / this.ch;\r\n\tthis.camera.far = wh * 1.3;\r\n\tthis.camera.position.z = wh;\r\n\tthis.camera.updateProjectionMatrix();\r\n\r\n\tvar mw = Math.max(this.w, this.h);\r\n\tthis.light.position.set(-mw / 2, mw / 2, mw * 2);\r\n\tthis.light.target.position.set(0, 0, 0);\r\n\r\n\tthis.renderer.setSize(this.w, this.h);\r\n};\r\n\r\nDices3D.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.cw = this.w / 2;\r\n\tthis.ch = this.h / 2;\r\n\r\n\tthis.aspect = Math.min(this.cw / this.w, this.ch / this.h);\r\n\tthis.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\r\n\r\n\tthis.renderer = window.WebGLRenderingContext\r\n\t\t? new THREE.WebGLRenderer({ antialias: true, alpha: true })\r\n\t\t: new THREE.CanvasRenderer({ antialias: true, alpha: true });\r\n\tthis.renderer.setSize(this.cw * 2, this.ch * 2);\r\n\tthis.renderer.shadowMapEnabled = true;\r\n\tthis.renderer.shadowMapSoft = true;\r\n\tthis.renderer.setClearColor(0x000000, 0);\r\n\r\n\tthis.dices = {};\r\n\tthis.scene = new THREE.Scene();\r\n\tthis.scene.fog = null;\r\n\r\n\t$(\"#dice-box\").append(this.renderer.domElement);\r\n\r\n\tvar wh = Math.min(this.cw, this.ch) / this.aspect / Math.tan(10 * Math.PI / 180);\r\n\tthis.camera = new THREE.PerspectiveCamera(20, this.cw / this.ch, 1, wh * 1.3);\r\n\tthis.camera.position.z = wh;\r\n\r\n\tvar ambientLight = new THREE.AmbientLight(0x666666);\r\n\tthis.scene.add(ambientLight);\r\n\r\n\tvar mw = Math.max(this.w, this.h);\r\n\tthis.light = new THREE.SpotLight(0xffffff);\r\n\tthis.light.position.set(-mw / 2, mw / 2, mw * 2);\r\n\tthis.light.target.position.set(0, 0, 0);\r\n\tthis.light.castShadow = true;\r\n\tthis.light.shadowCameraNear = mw / 10;\r\n\tthis.light.shadowCameraFar = mw * 3;\r\n\tthis.light.shadowCameraFov = 50;\r\n\tthis.light.shadowBias = 0.001;\r\n\tthis.light.shadowDarkness = 0.3;\r\n\tthis.light.shadowMapWidth = 1024;\r\n\tthis.light.shadowMapHeight = 1024;\r\n\tthis.scene.add(this.light);\r\n\r\n\tvar planeFragmentShader = [\r\n\r\n\t\t\"uniform vec3 diffuse;\",\r\n\t\t\"uniform float opacity;\",\r\n\r\n\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\r\n\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\t\"gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 );\",\r\n\r\n\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\r\n\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\r\n\r\n\t\t\t\"gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 - shadowColor.x );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join(\"\\n\");\r\n\r\n\tvar planeMaterial = new THREE.ShaderMaterial({\r\n\t\tuniforms: THREE.ShaderLib['basic'].uniforms,\r\n\t\tvertexShader: THREE.ShaderLib['basic'].vertexShader,\r\n\t\tfragmentShader: planeFragmentShader,\r\n\t\tcolor: 0x0000FF\r\n\t});\r\n\r\n\tthis.desk = new THREE.Mesh(new THREE.PlaneGeometry(this.w*2, this.h*2, 1, 1), planeMaterial);\r\n\tthis.desk.receiveShadow = true;\r\n\tthis.scene.add(this.desk);\r\n\r\n\twindow.addEventListener('click', this.resize.bind(this));\r\n\r\n\tthis.room.socket.on('dice start', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tthat.dices[data[i].id] = new Dice3D(data[i].id, data[i].type, data[i].color, that);\r\n\t\t}\r\n\t});\r\n\r\n\tthis.room.socket.on('dice update', function(data){\r\n\t\tfor(var i in data){\r\n\t\t\tif(that.dices[i]) that.dices[i].update(data[i]);\r\n\t\t}\r\n\t\tthat.renderer.render(that.scene, that.camera);\r\n\t});\r\n\r\n\tthis.room.socket.on('dice end', function(data){\r\n\t\tfor(var i = 0; i < data.length; i++){\r\n\t\t\tif(that.dices[data[i]]) that.dices[data[i]].remove();\r\n\t\t}\r\n\t\tthat.renderer.render(that.scene, that.camera);\r\n\t});\r\n};\r\n\r\nDices3D.prototype.remove = function() {\r\n\tthis.room.socket.removeAllListeners('dice start');\r\n\tthis.room.socket.removeAllListeners('dice update');\r\n\tthis.room.socket.removeAllListeners('dice end');\r\n};\r\n","function Dice(type){\r\n\tthis.type = type;\r\n\tthis.rolls = 0;\r\n\tthis.cooldown = null;\r\n\tthis.$item = $('<div class=\"dice d'+type.split('d').pop()+' noselect\">'+type+'</div>');\r\n}\r\n\r\nDice.prototype.roll = function() {\r\n\tvar that = this;\r\n\t++this.rolls;\r\n\tthis.$item.addClass(\"cooldown\");\r\n\tclearTimeout(this.cooldown);\r\n\tthis.cooldown = setTimeout(function(){ that.$item.removeClass(\"cooldown\"); }, 2000);\r\n};\r\n\r\nfunction Dices(room, defaultDices)\r\n{\r\n\tthis.room = room;\r\n\tthis.defaultDices = defaultDices || [];\r\n\tthis.dices = [];\r\n\r\n\tthis.$dices = $(\"#dices\");\r\n\r\n\tthis.reset();\r\n\tthis.init();\r\n}\r\n\r\n// Clear dices\r\nDices.prototype.reset = function()\r\n{\r\n\tvar that = this;\r\n\tthis.dices = [];\r\n\t$.each(this.defaultDices, function(i, d){\r\n\t\tthat.roll(d);\r\n\t});\r\n};\r\n\r\n// Show dices\r\nDices.prototype.show = function()\r\n{\r\n\tthis.sort();\r\n\tvar length = this.dices.length;\r\n\tthis.$dices.children(\".dice\").detach();\r\n\tthis.$dices.css({width: 45 * length, height: 45 * length});\r\n\tfor(var i = 0; i < length; i++)\r\n\t\tthis.$dices.append(this.dices[i].$item);\r\n};\r\n\r\n// Sort dices by number of rolls\r\nDices.prototype.sort = function()\r\n{\r\n\tthis.dices.sort(function(a, b){ return b.rolls - a.rolls; });\r\n};\r\n\r\n// Show\r\nDices.prototype.roll = function(dice)\r\n{\r\n\t// Merge 1dX and dX\r\n\tdice = dice.split('d');\r\n\tif(dice[0] == \"1\")\r\n\t\tdice[0] = \"\";\r\n\tdice = dice.join('d');\r\n\r\n\tvar exist = false;\r\n\tfor (var i = this.dices.length - 1; i >= 0; i--) {\r\n\t\tif(this.dices[i].type == dice){\r\n\t\t\texist = true;\r\n\t\t\tthis.dices[i].roll();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif(!exist) {\r\n\t\tthis.dices.push(new Dice(dice));\r\n\t}\r\n\r\n\tthis.show();\r\n};\r\n\r\nDices.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\t$(window).on('resize.dices', function(){\r\n\t\tthat.show();\r\n\t});\r\n\r\n\t$(document).on(\"click.dices\", \".dice\", function(e){\r\n\t\te.preventDefault();\r\n\t\tvar $this = $(this);\r\n\t\tif(!$this.hasClass(\"cooldown\")){\r\n\t\t\t$this.addClass(\"cooldown\");\r\n\t\t\tvar dice = $this.html();\r\n\t\t\tthat.room.socket.emit('chat', \"/roll \"+dice);\r\n\t\t}\r\n\t});\r\n};\r\n\r\nDices.prototype.destroy = function()\r\n{\r\n\t$(window).off('.dices');\r\n\t$(document).off('.dices');\r\n};\r\n","function Images(room)\r\n{\r\n\tthis.room = room;\r\n\tthis.image = \"\";\r\n\r\n\tthis.$zoom = null;\r\n\r\n\tthis.init();\r\n}\r\n\r\nImages.prototype.show = function(data) {\r\n\t$(\"#image-\"+data.id).html('<img class=\"zoomable link\" src=\"'+data.url+'\" alt=\"'+data.name+'\" title=\"'+data.name+'\">');\r\n};\r\n\r\nImages.prototype.close = function()\r\n{\r\n\tif(this.$zoom)\r\n\t{\r\n\t\tthis.$zoom.off('.images');\r\n\t\tthis.$zoom.remove();\r\n\t\tthis.$zoom = null;\r\n\t}\r\n};\r\n\r\nImages.prototype.zoom = function(src)\r\n{\r\n\tif(!this.$zoom)\r\n\t{\r\n\t\tvar that = this;\r\n\t\tthis.$zoom = $('<div class=\"overlay centerer closable\"><div class=\"image centered\"><img class=\"zoomed\" src=\"'+src+'\" alt=\"\"></div></div>')\r\n\t\t$('body').append(this.$zoom);\r\n\t\tthis.$zoom.on('click.images', function(){\r\n\t\t\tthat.close();\r\n\t\t});\r\n\t}\r\n};\r\n\r\nImages.prototype.upload = function(image)\r\n{\r\n\tif(image.type.split('/').shift() == 'image')\r\n\t{\r\n\t\tvar that = this;\r\n\t\treader = new FileReader();\r\n\t\treader.onload = function(evt){\r\n\t\t\tthat.room.socket.emit('image upload', image.name, evt.target.result);\r\n\t\t};\r\n\t\treader.readAsDataURL(image);\r\n\t}\r\n};\r\n\r\nImages.prototype.download = function(id) {\r\n\tthis.room.socket.emit('image download', id);\r\n};\r\n\r\nImages.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\t$('body')\r\n\t\t.on('dragover.images', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t})\r\n\t\t.on('drop.images', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.upload(e.originalEvent.dataTransfer.files[0]);\r\n\t\t})\r\n\t\t.on('click.images', '.zoomable', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.zoom($(this).attr(\"src\"));\r\n\t\t})\r\n\t\t.on('click.images', '[data-image]', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\t$(this).append(' <i class=\"fa fa-spin fa-refresh\"></i>');\r\n\t\t\tthat.download($(this).attr(\"data-image\"));\r\n\t\t});\r\n\r\n\tthis.room.socket.on('image', function(data){\r\n\t\tthat.show(data);\r\n\t});\r\n};\r\n\r\nImages.prototype.destroy = function()\r\n{\r\n\tthis.close();\r\n\t$('body').off('.images');\r\n};","function LocalPlayer(music)\r\n{\r\n\tthis.music = music;\r\n\tthis.audio = new Audio();\r\n\tthis.volet = 0;\r\n\tthis.init();\r\n}\r\n\r\nLocalPlayer.prototype.init = function(){\r\n\tvar that = this;\r\n\tdocument.body.appendChild(this.audio);\r\n\tthis.audio.autoplay = true;\r\n\tthis.audio.loop = true;\r\n\r\n\tif(that.music.room.user.admin){\r\n\t\t$.post('music/list.php', function(data){\r\n\t\t\tthat.music.$musicPopin.find('.local-contener').append(that.crawlSongs(data));\r\n\r\n\t\t\t$('body').on('click.music', '.song .fa-play', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.song($(this).parent().parent(), false);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.song .fa-plus', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.song($(this).parent().parent(), true);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.playlist .fa-play', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.playlist($(this).parent().parent(), false);\r\n\t\t\t});\r\n\r\n\t\t\t$('body').on('click.music', '.playlist .fa-plus', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthat.playlist($(this).parent().parent(), true);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n};\r\n\r\nLocalPlayer.prototype.song = function(elem, add){\r\n\tvar that = this;\r\n\tthat.music.$musicPopin.fadeOut(300);\r\n\tvar songs = {\r\n\t\ttype: 'local',\r\n\t\tadd: add,\r\n\t\turl: [elem.attr('data-song')]\r\n\t};\r\n\tthat.music.room.socket.emit('music', songs);\r\n};\r\n\r\nLocalPlayer.prototype.playlist = function(elem, add){\r\n\tvar that = this;\r\n\tvar songs = {\r\n\t\ttype: 'local',\r\n\t\tadd: add,\r\n\t\turl: []\r\n\t};\r\n\tthat.music.$musicPopin.fadeOut(300);\r\n\telem.next('input').next('label').next('ul').find('.song').each(function(){\r\n\t\tsongs.url.push($(this).attr('data-song'));\r\n\t});\r\n\r\n\tthat.music.room.socket.emit('music', songs);\r\n};\r\n\r\nLocalPlayer.prototype.crawlSongs = function(playlist){\r\n\t++this.volet;\r\n\tvar musiclist = '';\r\n\tmusiclist += '<h4 class=\"playlist list link\">'+playlist.title+'<span class=\"icon-play\"><i class=\"fa fa-plus\"></i><i class=\"fa fa-play\"></i></span></h4>';\r\n\tmusiclist += '<input id=\"volet-'+this.volet+'\" type=\"checkbox\" '+((this.volet==1)?'checked':'')+' class=\"volet-checkbox\">';\r\n\tmusiclist += '<label for=\"volet-'+this.volet+'\" class=\"volet-btn link fa fa-caret-right\"></label>';\r\n\tmusiclist += '<ul class=\"volet-content\">';\r\n\tfor(var i = 0; i < playlist.songs.length; i++){\r\n\t\tif(playlist.songs[i].type == \"playlist\"){\r\n\t\t\tmusiclist += '<li>'+this.crawlSongs(playlist.songs[i])+'</li>';\r\n\t\t} else {\r\n\t\t\tmusiclist += '<li class=\"song list link\" data-song=\"music/'+playlist.songs[i].url+'\">'+playlist.songs[i].title+'<span class=\"icon-play\"><i class=\"fa fa-plus\"></i><i class=\"fa fa-play\"></i></span></li>';\r\n\t\t}\r\n\t}\r\n\tmusiclist += '</ul>';\r\n\r\n\treturn musiclist;\r\n};\r\n\r\nLocalPlayer.prototype.start = function(track){\r\n\tthis.audio.src = track.url;\r\n\tthis.play();\r\n};\r\n\r\nLocalPlayer.prototype.pause = function(){\r\n\tthis.audio.pause();\r\n};\r\n\r\nLocalPlayer.prototype.play = function(){\r\n\tthis.audio.play();\r\n};\r\n\r\nLocalPlayer.prototype.volume = function(v){\r\n\tthis.audio.volume = Math.max(0, Math.min(v, 1));\r\n};\r\n\r\nLocalPlayer.prototype.destroy = function(){\r\n\tconsole.log(this.audio);\r\n\tthis.audio.parentNode.removeChild(this.audio);\r\n};\r\n\r\nfunction YoutubePlayer(music)\r\n{\r\n\tthis.music = music;\r\n    this.index = 0;\r\n\tthis.youtube;\r\n    this.$musicUrl;\r\n    this.$playLater;\r\n    this.$playNow;\r\n\r\n\tthis.init();\r\n}\r\n\r\nYoutubePlayer.prototype.init = function(){\r\n\tvar that = this;\r\n\r\n\t// Youtube player tag\r\n\tvar tag = document.createElement('script');\r\n\ttag.src = \"https://www.youtube.com/iframe_api\";\r\n\tvar firstScriptTag = document.getElementsByTagName('script')[0];\r\n\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n\r\n\twindow.onYouTubeIframeAPIReady = function() {\r\n\t\tthat.youtube = new YT.Player('yt-player', {\r\n\t\t\theight: '1',\r\n\t\t\twidth: '1',\r\n\t\t\tevents: {\r\n\t\t\t\t'onReady': onPlayerReady,\r\n\t\t\t\t'onStateChange': onPlayerStateChange\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// 4. The API will call this function when the video player is ready.\r\n    function onPlayerReady(event) {\r\n        console.log('player ready');\r\n\r\n\t\tif(that.music.room.user.admin){\r\n\t\t\tthat.music.$musicPopin.find('.youtube-contener').append(\r\n\t\t\t\t'<div class=\"mui-form-group\">'+\r\n\t\t\t\t\t'<input id=\"music-url\" type=\"text\" class=\"mui-form-control\" placeholder=\"https://www.youtube.com/watch?v=KqeKikpLQ5o\">'+\r\n\t\t\t\t\t'<label>Youtube url</label>'+\r\n\t\t\t\t'</div>'+\r\n\t\t\t\t'<button id=\"play-later\" class=\"mui-btn mui-btn-flat mui-btn-default mui-pull-left\">To playlist</button>'+\r\n\t\t\t\t'<button id=\"play-now\" class=\"mui-btn mui-btn-raised mui-btn-primary mui-pull-right\">Play now</button>'\r\n\t\t\t);\r\n\r\n\t\t\tthat.$musicUrl = $(\"#music-url\");\r\n\t\t\tthat.$playLater = $(\"#play-later\");\r\n\t\t\tthat.$playNow = $(\"#play-now\");\r\n\r\n\t\t\tthat.$playNow.on('click.music', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar value = that.$musicUrl[0].value;\r\n\t\t\t\tvar parse = that.parseURL(value);\r\n\t\t\t\tparse.add = false;\r\n\t\t\t\tthat.music.$musicPopin.fadeOut(300);\r\n\t\t\t\tthat.music.room.socket.emit('music', parse);\r\n\t\t\t\t//console.log('play now', parse);\r\n\t\t\t});\r\n\r\n\t\t\tthat.$playLater.on('click.music', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tvar value = that.$musicUrl[0].value;\r\n\t\t\t\tvar parse = that.parseURL(value);\r\n\t\t\t\tparse.add = true;\r\n\t\t\t\tthat.music.$musicPopin.fadeOut(300);\r\n\t\t\t\tthat.music.room.socket.emit('music', parse);\r\n\t\t\t\t//console.log('play later', parse);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\r\n    function onPlayerStateChange(event) {\r\n        //console.log('event: ' + event.data, 'index: ' + that.currentIndex, 'length: ' + (event.target.getPlaylist().length-1));\r\n        if(event.data == YT.PlayerState.PLAYING)\r\n            that.index = event.target.getPlaylistIndex();\r\n        if(event.data == YT.PlayerState.ENDED && that.index == event.target.getPlaylist().length-1){\r\n            that.music.next();\r\n            //console.log('Fin de la playlist');\r\n        }\r\n    }\r\n};\r\n\r\nYoutubePlayer.prototype.parseURL = function(url)\r\n{\r\n    var type = 'video';\r\n    if(url.indexOf('list=') != -1){\r\n        url = url.replace(/(>|<)/gi,'').split(/(vi\\/|list=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\r\n        type = 'playlist';\r\n    } else {\r\n        url = url.replace(/(>|<)/gi,'').split(/(vi\\/|v=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\r\n    }\r\n\r\n    if(url[2] !== undefined)\r\n        url = url[2].split(/[^0-9a-z_\\-]/i);\r\n\r\n    return {\r\n        url: url[0],\r\n        type: type\r\n    };\r\n};\r\n\r\nYoutubePlayer.prototype.start = function(track){\r\n\tif(track.type == 'playlist') this.youtube.loadPlaylist({list: track.url});\r\n    else this.youtube.loadPlaylist(track.url);\r\n};\r\n\r\nYoutubePlayer.prototype.pause = function(){\r\n\tthis.youtube.pauseVideo();\r\n};\r\n\r\nYoutubePlayer.prototype.play = function(){\r\n\tthis.youtube.playVideo();\r\n};\r\n\r\nYoutubePlayer.prototype.volume = function(v){\r\n\tthis.youtube.setVolume(Math.max(0, Math.min(v, 1)) * 100);\r\n};\r\n\r\nYoutubePlayer.prototype.destroy = function(){\r\n\tthis.youtube.destroy();\r\n\tif(this.music.room.user.admin){\r\n\t\tthis.$playNow.off('.music');\r\n\t\tthis.$playLater.off('.music');\r\n\t}\r\n};\r\n\r\nfunction Music(room)\r\n{\r\n\tthis.room = room;\r\n\tthis.playlist = [];\r\n\tthis.current = 0;\r\n\tthis.savedVolume = 0;\r\n\tthis.currentVolume = 0;\r\n\tthis.localPlayer;\r\n\tthis.youtubePlayer;\r\n\tthis.player;\r\n\r\n\tthis.$play = $(\"#play\");\r\n\tthis.$mute = $(\"#mute\");\r\n\tthis.$volume = $(\"#volume\");\r\n\tthis.$bar = this.$volume.find(\".audio-volume-bar\");\r\n\tthis.$musicPlayer = $(\"#music-player\");\r\n\r\n    this.$musicPopin;\r\n\r\n\tthis.init();\r\n}\r\n\r\nMusic.prototype.load = function(data)\r\n{\r\n\tconsole.log('data', data);\r\n    if(data.add){\r\n\t\tif(data.type == 'local'){\r\n\t\t\tfor(var i = 0, l = data.url.length; i<l; i++)\r\n\t\t\t\tthis.playlist.push({type: data.type, add: data.add, url: data.url[i]});\r\n\t\t} else {\r\n\t\t\tthis.playlist.push(data);\r\n\t\t}\r\n\r\n        if(this.playlist.length == 1){\r\n            this.current = 0;\r\n            this.start();\r\n        }\r\n    } else {\r\n\t\tthis.playlist = [];\r\n\t\tif(data.type == 'local'){\r\n\t\t\tfor(var i = 0, l = data.url.length; i<l; i++)\r\n\t\t\t\tthis.playlist.push({type: data.type, add: data.add, url: data.url[i]});\r\n\t\t} else {\r\n\t\t\tthis.playlist.push(data);\r\n\t\t}\r\n\t\tthis.current = 0;\r\n        this.start();\r\n    }\r\n};\r\n\r\nMusic.prototype.start = function()\r\n{\r\n\tconsole.log(this.playlist);\r\n    if(this.playlist.length === 0)\r\n        return;\r\n\tif(this.playlist[this.current].type == 'local')\r\n\t\tthis.player = this.localPlayer;\r\n\telse\r\n\t\tthis.player = this.youtubePlayer;\r\n\r\n    this.player.start(this.playlist[this.current]);\r\n    this.play();\r\n};\r\n\r\nMusic.prototype.next = function()\r\n{\r\n\tif(++this.current >= this.playlist.length)\r\n\t\tthis.current = 0;\r\n\tthis.start();\r\n};\r\n\r\nMusic.prototype.play = function()\r\n{\r\n\tthis.$play\r\n\t\t.removeClass(\"fa-play\")\r\n\t\t.addClass(\"fa-pause\");\r\n\tthis.player.play();\r\n\tthis.volume(this.currentVolume);\r\n};\r\n\r\nMusic.prototype.pause = function()\r\n{\r\n\tthis.$play\r\n\t\t.removeClass(\"fa-pause\")\r\n\t\t.addClass(\"fa-play\");\r\n\tthis.player.pause();\r\n};\r\n\r\nMusic.prototype.volume = function(volume)\r\n{\r\n\tvolume = Math.min(Math.max(volume, 0), 1);\r\n\r\n\tvar c = \"fa \";\r\n\tif(volume == 0){\r\n\t\tc += \"fa-volume-off\";\r\n\t} else if(volume < 0.4){\r\n\t\tc += \"fa-volume-down\";\r\n\t} else {\r\n\t\tc += \"fa-volume-up\";\r\n\t}\r\n\r\n\tthis.$mute[0].className = c;\r\n\r\n\tthis.$bar.css('width', (volume*100)+'%');\r\n\r\n\tif(this.player)\r\n\t\tthis.player.volume(volume * 0.2);\r\n    this.currentVolume = volume;\r\n};\r\n\r\nMusic.prototype.mute = function()\r\n{\r\n\tthis.savedVolume = this.currentVolume;\r\n\tthis.volume(0);\r\n};\r\n\r\nMusic.prototype.unmute = function()\r\n{\r\n\tthis.volume(this.savedVolume);\r\n\tthis.savedVolume = 0;\r\n};\r\n\r\nMusic.prototype.init = function()\r\n{\r\n\tvar that = this;\r\n\r\n\tthat.youtubePlayer = new YoutubePlayer(that);\r\n\tthat.localPlayer = new LocalPlayer(that);\r\n\r\n    that.volume(0.5);\r\n\r\n    that.$volume.on('mousedown.music', function(e){\r\n        e.preventDefault();\r\n        that.volume(Math.round(e.offsetX/$(this).width()*100)/100);\r\n        $(window).on('mousemove.music', function(e){\r\n            var offset = e.clientX - that.$volume.offset().left;\r\n            that.volume(Math.round(offset/that.$volume.width()*100)/100);\r\n        });\r\n    });\r\n\r\n    that.$mute.on('click.music', function(){\r\n        if(that.savedVolume == 0){\r\n            that.mute();\r\n        } else {\r\n            that.unmute();\r\n        }\r\n    });\r\n\r\n    $(window).on('mouseup.music', function(){\r\n        $(window).off('mousemove.music');\r\n    });\r\n\r\n    that.room.socket.on('music', function(data){\r\n        that.load(data);\r\n    });\r\n\r\n    that.room.socket.on('music pause', function(){\r\n        that.pause();\r\n    });\r\n\r\n    that.room.socket.on('music play', function(){\r\n        that.play();\r\n    });\r\n\r\n    that.room.socket.on('music volume', function(data){\r\n        that.volume(data);\r\n    });\r\n\r\n    if(that.room.user.admin)\r\n    {\r\n        $('.room-wrapper').append('<div id=\"music-player\"><div class=\"music-title\">Click to choose song</div></div>');\r\n\r\n        $('.room-wrapper').append('<div class=\"music-selector overlay centerer\" style=\"display:none;\">'+\r\n            '<div class=\"popin mui-panel centered\">'+\r\n                '<i class=\"music-selector-close popin-close fa fa-times link\"></i>'+\r\n\t\t\t\t'<div class=\"youtube-contener\"></div>'+\r\n\t\t\t\t'<div class=\"local-contener\" style=\"position:relative;clear:both;\"></div>'+\r\n            '</div>'+\r\n        '</div>');\r\n\r\n        that.$musicPlayer = $(\"#music-player\");\r\n        that.$musicPopin = $(\".music-selector\");\r\n\r\n        that.$musicPlayer.on(\"click.music\", function(e){\r\n            e.preventDefault();\r\n            if(that.room.user.admin){\r\n                that.$musicPopin.fadeIn(300);\r\n            }\r\n        });\r\n\r\n        that.$play.on(\"click.music\", function(e){\r\n            e.preventDefault();\r\n            if(that.room.user.admin)\r\n            {\r\n                var $this = $(this);\r\n                if($this.hasClass('fa-play')){\r\n                    if(that.player){\r\n                        that.room.socket.emit('music play');\r\n                    } else {\r\n                        that.$musicPopin.fadeIn(300);\r\n                    }\r\n                } else {\r\n                    that.room.socket.emit('music pause');\r\n                }\r\n            }\r\n        });\r\n\r\n\t\t$('body').on(\"click.music\", \".music-selector-close\", function(){\r\n\t        that.$musicPopin.fadeOut(300);\r\n\t    });\r\n    }\r\n};\r\n\r\nMusic.prototype.destroy = function()\r\n{\r\n\tthis.youtubePlayer.destroy();\r\n\tthis.localPlayer.destroy();\r\n\r\n\tthis.$volume.off('.music');\r\n\tthis.$mute.off('.music');\r\n\tthis.$play.off('.music');\r\n\t$('body').off('.music');\r\n\t$(window).off('.music');\r\n\r\n\tthis.room.socket.removeAllListeners('music');\r\n\tthis.room.socket.removeAllListeners('music play');\r\n\tthis.room.socket.removeAllListeners('music pause');\r\n\tthis.room.socket.removeAllListeners('music volume');\r\n\r\n\tif(this.room.user.admin){\r\n\t\tthis.$musicPlayer.remove();\r\n\t\tthis.$musicPopin.remove();\r\n\t}\r\n};\r\n","(function(){\r\n\r\n\t//\r\n\t// Socket connection and login gestion\r\n\t//\r\n\r\n\tvar config = Config || {};\r\n\tvar url = config.url || 'http://localhost:3030';\r\n\tvar socket = io(url);\r\n\r\n\tvar room;\r\n\tvar loading = false;\r\n\r\n\tfunction loginRoom(item, room, user, action)\r\n\t{\r\n\t\tif(room == \"\" || user == \"\" || loading)\r\n\t\t\treturn false;\r\n\r\n\t\tloading = true;\r\n\t\titem.append('<span id=\"loading\">&nbsp;&nbsp;<i class=\"fa fa-spin fa-refresh\"></i></span>');\r\n\t\tsocket.emit(action, { room: room, user: user });\r\n\t}\r\n\r\n\t// Join room\r\n\tfunction joinRoom()\r\n\t{\r\n\t\tloginRoom($(\"#join\"), $(\"#room\").val(), $(\"#user\").val(), 'room join');\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Create room\r\n\tfunction createRoom()\r\n\t{\r\n\t\tloginRoom($(\"#create\"), $(\"#room\").val(), $(\"#user\").val(), 'room create');\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Init\r\n\tfunction init()\r\n\t{\r\n\t\t// Wait for server login event and create Room Object\r\n\t\tsocket.on('login', function(data){\r\n\t\t\tloading = false;\r\n\t\t\t$(\"#loading\").remove();\r\n\r\n\t\t\tif(!data.succes){\r\n\t\t\t\t$(\"#login-msg\").html(data.error).addClass('error');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\troom = new Room(socket, data.room.name, data.user, data.room.users, data.room.messages, data.room.settings);\r\n\t\t\tCookies.set('login', data.room.name+'|'+data.user.name, { expires: 356 });\r\n\r\n\t\t\t$(\".login-wrapper\").fadeOut(300);\r\n\t\t});\r\n\r\n\t\t// Handle click events\r\n\t\t$(\"#login\").submit(joinRoom);\r\n\t\t$(\"#join\").click(joinRoom);\r\n\t\t$(\"#create\").click(createRoom);\r\n\r\n\t\t// If cookie try to login\r\n\t\tvar cookie = Cookies.get('login');\r\n\t\tif(cookie) {\r\n\t\t\tvar ck = cookie.split(\"|\");\r\n\t\t\tloginRoom($(\"#join\"), ck[0], ck[1], 'room join');\r\n\t\t}\r\n\t}\r\n\r\n\twindow.addEventListener('DOMContentLoaded', init);\r\n})();\r\n","/*!\r\n * JavaScript Cookie v2.0.2\r\n * https://github.com/js-cookie/js-cookie\r\n *\r\n * Copyright 2006, 2015 Klaus Hartl\r\n * Released under the MIT license\r\n */\r\n(function (factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(factory);\r\n\t} else if (typeof exports === 'object') {\r\n\t\tmodule.exports = factory();\r\n\t} else {\r\n\t\tvar _OldCookies = window.Cookies;\r\n\t\tvar api = window.Cookies = factory(window.jQuery);\r\n\t\tapi.noConflict = function () {\r\n\t\t\twindow.Cookies = _OldCookies;\r\n\t\t\treturn api;\r\n\t\t};\r\n\t}\r\n}(function () {\r\n\tfunction extend () {\r\n\t\tvar i = 0;\r\n\t\tvar result = {};\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar attributes = arguments[ i ];\r\n\t\t\tfor (var key in attributes) {\r\n\t\t\t\tresult[key] = attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction init (converter) {\r\n\t\tfunction api (key, value, attributes) {\r\n\t\t\tvar result;\r\n\r\n\t\t\t// Write\r\n\r\n\t\t\tif (arguments.length > 1) {\r\n\t\t\t\tattributes = extend({\r\n\t\t\t\t\tpath: '/'\r\n\t\t\t\t}, api.defaults, attributes);\r\n\r\n\t\t\t\tif (typeof attributes.expires === 'number') {\r\n\t\t\t\t\tvar expires = new Date();\r\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\r\n\t\t\t\t\tattributes.expires = expires;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tresult = JSON.stringify(value);\r\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\r\n\t\t\t\t\t\tvalue = result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\r\n\t\t\t\tvalue = encodeURIComponent(String(value));\r\n\t\t\t\tvalue = value.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\r\n\r\n\t\t\t\tkey = encodeURIComponent(String(key));\r\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\r\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\r\n\r\n\t\t\t\treturn (document.cookie = [\r\n\t\t\t\t\tkey, '=', value,\r\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\r\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\r\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\r\n\t\t\t\t\tattributes.secure ? '; secure' : ''\r\n\t\t\t\t].join(''));\r\n\t\t\t}\r\n\r\n\t\t\t// Read\r\n\r\n\t\t\tif (!key) {\r\n\t\t\t\tresult = {};\r\n\t\t\t}\r\n\r\n\t\t\t// To prevent the for loop in the first place assign an empty array\r\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\r\n\t\t\t// calling \"get()\"\r\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\r\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\tfor (; i < cookies.length; i++) {\r\n\t\t\t\tvar parts = cookies[i].split('=');\r\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\r\n\t\t\t\tvar cookie = parts.slice(1).join('=');\r\n\r\n\t\t\t\tif (cookie.charAt(0) === '\"') {\r\n\t\t\t\t\tcookie = cookie.slice(1, -1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tcookie = converter && converter(cookie, name) || cookie.replace(rdecode, decodeURIComponent);\r\n\r\n\t\t\t\t\tif (this.json) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\r\n\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (key === name) {\r\n\t\t\t\t\t\tresult = cookie;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!key) {\r\n\t\t\t\t\t\tresult[name] = cookie;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tapi.get = api.set = api;\r\n\t\tapi.getJSON = function () {\r\n\t\t\treturn api.apply({\r\n\t\t\t\tjson: true\r\n\t\t\t}, [].slice.call(arguments));\r\n\t\t};\r\n\t\tapi.defaults = {};\r\n\r\n\t\tapi.remove = function (key, attributes) {\r\n\t\t\tapi(key, '', extend(attributes, {\r\n\t\t\t\texpires: -1\r\n\t\t\t}));\r\n\t\t};\r\n\r\n\t\tapi.withConverter = init;\r\n\r\n\t\treturn api;\r\n\t}\r\n\r\n\treturn init();\r\n}));\r\n\r\njQuery.fn.putCursorAtEnd = function() {\r\n\r\n  return this.each(function() {\r\n\r\n    $(this).focus()\r\n\r\n    // If this function exists...\r\n    if (this.setSelectionRange) {\r\n      // ... then use it (Doesn't work in IE)\r\n\r\n      // Double the length because Opera is inconsistent about whether a carriage return is one character or two. Sigh.\r\n      var len = $(this).val().length * 2;\r\n\r\n      this.setSelectionRange(len, len);\r\n    \r\n    } else {\r\n    // ... otherwise replace the contents with itself\r\n    // (Doesn't work in Google Chrome)\r\n\r\n      $(this).val($(this).val());\r\n      \r\n    }\r\n\r\n    // Scroll to the bottom, in case we're in a tall textarea\r\n    // (Necessary for Firefox and Google Chrome)\r\n    this.scrollTop = 999999;\r\n\r\n  });\r\n\r\n};\r\n\r\nvar hasWebGLSupport = (function(){\r\n\tvar support = false;\r\n\tvar tested = false;\r\n\treturn function(){\r\n\t\tif(!tested){\r\n\t\t\tvar gl = null;\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\ttry { gl = canvas.getContext(\"webgl\"); }\r\n\t\t\tcatch (x) { gl = null; }\r\n\r\n\t\t\tif (gl == null) {\r\n\t\t\t\ttry { gl = canvas.getContext(\"experimental-webgl\"); experimental = true; }\r\n\t\t\t\tcatch (x) { gl = null; }\r\n\t\t\t}\r\n\r\n\t\t\tif(gl == null || !window.WebGLRenderingContext){\r\n\t\t\t\tsupport = false;\r\n\t\t\t} else {\r\n\t\t\t\tsupport = true;\r\n\t\t\t}\r\n\r\n\t\t\tcanvas = null;\r\n\t\t\ttested = true;\r\n\t\t}\r\n\r\n\t\treturn support;\r\n\t}\r\n})();","function Room(socket, name, user, users, messages, options)\r\n{\r\n\tthis.socket = socket;\r\n\tthis.name = name;\r\n\tthis.user = user;\r\n\r\n\tthis.dices = new Dices(this, options.defaultDices);\r\n\tif(hasWebGLSupport()){\r\n\t\tthis.dice = new Dices3D(this, window.innerWidth, window.innerHeight);\r\n\t} else {\r\n\t\tthis.dice = new Dices2D(this, window.innerWidth, window.innerHeight);\r\n\t}\r\n\tthis.users = new Users(this, users);\r\n\tthis.images = new Images(this);\r\n\tthis.chat = new Chat(this, messages);\r\n\tthis.music = new Music(this);\r\n\tthis.options = options;\r\n\r\n\tthis.$options = $('#options');\r\n\tthis.$roomName = $(\"#room-name\");\r\n\tthis.$logout = $(\"#logout\");\r\n\r\n\tthis.optionsOpened = false;\r\n\r\n\tthis.init(users);\r\n}\r\n\r\nRoom.prototype.init = function(users)\r\n{\r\n\tvar that = this;\r\n\r\n\tthis.$roomName.text(this.name);\r\n\r\n\t// Is admin\r\n\tif(this.user.admin)\r\n\t{\r\n\t\t$(\"body\")\r\n\t\t\t.addClass('admin-layout')\r\n\t\t\t.on('click.room', '.options-save', $.proxy(that.saveOptions, that))\r\n\t\t\t.on('click.room', '.options-close', $.proxy(that.closeOptions, that));\r\n\t\tthis.$options.on('click.room', $.proxy(that.showOptions, that));\r\n\t}\r\n\r\n\t// Login out\r\n\tthis.$logout.on(\"click.room\", function(e){\r\n\t\te.preventDefault();\r\n\t\tCookies.remove('login');\r\n\t\tthat.destroy();\r\n\t\twindow.location.href = window.location.href;\r\n\t});\r\n\r\n\tthis.socket.on('change settings', function(data){\r\n\t\t//TODO: change settings without reloading\r\n\t\twindow.location.href = window.location.href;\r\n\t});\r\n\r\n\tthis.socket.on('disconnect', function(){\r\n\t\tthat.destroy();\r\n\t\twindow.location.href = window.location.href;\r\n\t});\r\n};\r\n\r\nRoom.prototype.showOptions = function()\r\n{\r\n\tvar contenu = '<div id=\"options-popin\" class=\"overlay centerer\"><div class=\"popin mui-panel centered\"><i class=\"options-close popin-close fa fa-times link\"></i>';\r\n\tcontenu += '<div class=\"mui-form-group\"><label for=\"options-dices-3d\">Use 3D dice</label><input id=\"options-dices-3d\" type=\"checkbox\"'+((this.options.dices3D) ? ' checked' : ' ')+'></div>';\r\n\tcontenu += '<div class=\"mui-form-group\"><input id=\"options-default-dices\" class=\"mui-form-control mui-empty mui-dirty\" type=\"text\" value=\"'+this.options.defaultDices.join(',')+'\"><label>Default dice (separated by comma)</label></div>';\r\n\tcontenu += '<div class=\"mui-form-group\"><input id=\"options-custom-roll\" class=\"mui-form-control mui-empty mui-dirty\" type=\"text\" value=\"'+this.options.customRoll+'\"><label>/dice command (custom /roll where agument are remplacing $n)</label></div>';\r\n\tcontenu += '<button class=\"options-close mui-btn mui-btn-flat mui-btn-default mui-pull-left\">Cancel</button><button class=\"options-save mui-btn mui-btn-raised mui-btn-primary mui-pull-right\">Save</button>';\r\n\tcontenu += '</div></div>';\r\n\t$('body').append(contenu);\r\n\tthis.optionsOpened = true;\r\n};\r\n\r\nRoom.prototype.saveOptions = function()\r\n{\r\n\tif(!this.user.admin)\r\n\t\treturn;\r\n\r\n\tvar options = {\r\n\t\tdices3D: $('#options-dices-3d').prop('checked'),\r\n\t\tdefaultDices: $('#options-default-dices').val().split(','),\r\n\t\tcustomRoll: $('#options-custom-roll').val()\r\n\t};\r\n\r\n\tthis.socket.emit('save settings', options);\r\n\tthis.closeOptions();\r\n};\r\n\r\nRoom.prototype.closeOptions = function()\r\n{\r\n\tif(this.optionsOpened == false)\r\n\t\treturn;\r\n\r\n\t$('#options-popin').remove();\r\n\tthis.optionsOpened = false;\r\n};\r\n\r\nRoom.prototype.destroy = function()\r\n{\r\n\t$(\"body\")\r\n\t\t.removeClass('admin-layout')\r\n\t\t.off(\".room\");\r\n\tthis.$roomName.text(\"\");\r\n\tthis.$logout.off(\".room\");\r\n\tthis.$options.off(\".room\");\r\n\r\n\tthis.dices.destroy();\r\n\tthis.users.destroy();\r\n\tthis.chat.destroy();\r\n\tthis.music.destroy();\r\n};\r\n","function Users(room, users)\r\n{\r\n\tthis.room = room;\r\n\tthis.users = [];\r\n\tthis.grabbed = null;\r\n\tthis.ghost = null;\r\n\r\n\tthis.$users = $(\"#users\");\r\n\tthis.item;\r\n\r\n\tthis.init(users);\r\n}\r\n\r\nUsers.prototype.getUserByName = function(name) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].name.toLowerCase() == name.toLowerCase())\r\n\t\t\treturn this.users[i];\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nUsers.prototype.getUserById = function(id) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].id == id)\r\n\t\t\treturn this.users[i];\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nUsers.prototype.getIndexById = function(id) {\r\n\tfor (var i = this.users.length - 1; i >= 0; i--) {\r\n\t\tif(this.users[i].id == id)\r\n\t\t\treturn i;\r\n\t}\r\n\r\n\treturn -1;\r\n};\r\n\r\nUsers.prototype.showUser = function(user)\r\n{\r\n\tvar c = \"user\";\r\n\tif(user.admin) c += \" admin\";\r\n\tif(user.name == this.room.user.name) c += \" me\";\r\n\r\n\tvar $caracs =\r\n\t\t'<div class=\"user-details mui-panel\">' +\r\n\t\t\t'<!--<div class=\"title\"><strong>Characteristics</strong></div>' +\r\n\t\t\t'<div class=\"user-health noselect\" data-carac=\"health\"><i class=\"fa fa-heart\"></i> <span>8</span></div>' +\r\n\t\t\t'<div class=\"user-defense noselect\" data-carac=\"defense\"><i class=\"fa fa-shield\"></i> <span>8</span></div>-->' +\r\n\t\t\t'<div class=\"title\"><strong>Tokens</strong></div>' +\r\n\t\t\t'<div class=\"user-tokens\"></div>' +\r\n\t\t'</div>';\r\n\r\n\tvar $user = '<li data-user=\"'+user.id+'\" data-sort=\"'+user.order+'\" class=\"user-item '+c+'\" id=\"user-'+user.id+'\">'+user.name+'<span class=\"user-dice\"></span>'+$caracs+'</li>';\r\n\r\n\tif(user.admin) {\r\n\t\tthis.$users.prepend($user);\r\n\t} else {\r\n\t\tthis.$users.append($user);\r\n\t}\r\n\r\n\tthis.refreshTokens(user);\r\n};\r\n\r\nUsers.prototype.addUser = function(user)\r\n{\r\n\tif(user.admin) {\r\n\t\tthis.users.unshift(user);\r\n\t} else {\r\n\t\tthis.users.push(user);\r\n\t}\r\n\r\n\tthis.showUser(user);\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.removeUser = function(user)\r\n{\r\n\tvar index = this.getIndexById(user.id);\r\n\tif(index >= 0)\r\n\t\tthis.users.splice(index, 1);\r\n\r\n\t$(\"#user-\"+user.id).remove();\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.refreshTokens = function(user)\r\n{\r\n\tu = this.getUserById(user.id);\r\n\tif(u){\r\n\t\tu.tokens = user.tokens;\r\n\t\tvar ts = $(\"#user-\"+user.id+\" .user-tokens\");\r\n\t\tvar tok = \"\";\r\n\r\n\t\tfor(var t in u.tokens){\r\n\t\t\ttok += '<div class=\"token '+t+'\" data-user=\"'+user.id+'\" data-token=\"'+t+'\">'+u.tokens[t]+'</div>';\r\n\t\t}\r\n\r\n\t\tif(tok == \"\"){\r\n\t\t\tts.html('<div class=\"notoken\">No tokens</div>');\r\n\t\t} else {\r\n\t\t\tts.html(tok);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nUsers.prototype.typingStart = function(user)\r\n{\r\n\t$(\"#user-\"+user.id).addClass(\"typing\");\r\n};\r\n\r\nUsers.prototype.typingStop = function(user)\r\n{\r\n\t$(\"#user-\"+user.id).removeClass(\"typing\");\r\n};\r\n\r\nUsers.prototype.showLastDice = function(user, dice)\r\n{\r\n\t$(\"#user-\"+user.id).find(\".user-dice\").html(dice);\r\n};\r\n\r\nUsers.prototype.grab = function(elem, position)\r\n{\r\n\tif(this.grabbed !== null || !this.room.user.admin || elem.hasClass('admin'))\r\n\t\treturn;\r\n\r\n\tvar self = this;\r\n\t$('body').addClass('grabbing');\r\n\tthis.ghost = elem.clone()\r\n\t\t.css({\r\n\t\t\tposition: \"absolute\",\r\n\t\t\ttop: \"0\",\r\n\t\t\tleft: \"0\",\r\n\t\t\twidth: elem.outerWidth()+'px',\r\n\t\t\ttransform: \"translate(\"+position.x+\"px, \"+position.y+\"px)\"\r\n\t\t})\r\n\t\t.appendTo('body');\r\n\tthis.grabbed = elem.addClass('grabbing');\r\n\r\n\t$('body').on('mouseup.sortable', function(e){\r\n\t\te.preventDefault();\r\n\t\tself.release({x:e.pageX, y:e.pageY});\r\n\t});\r\n\r\n\t$('body').on('mousemove.sortable', function(e){\r\n\t\te.preventDefault();\r\n\t\tself.grabbing({x:e.pageX, y:e.pageY});\r\n\t});\r\n};\r\n\r\nUsers.prototype.grabbing = function(position)\r\n{\r\n\tif(this.grabbed === null)\r\n\t\treturn;\r\n\r\n\tvar self = this;\r\n\tthis.ghost.css(\"transform\", \"translate(\"+position.x+\"px, \"+position.y+\"px)\");\r\n\r\n\tthis.items.each(function(){\r\n\t\tvar $this = $(this);\r\n\t\tif(!$this.hasClass('grabbing') && !$this.hasClass('admin')){\r\n\t\t\tvar top = $this.offset().top;\r\n\t\t\tvar height = $this.outerHeight();\r\n\t\t\tif(top < position.y && position.y< top + height){\r\n\t\t\t\t// if is in range\r\n\t\t\t\tif(position.y> top + height / 2){\r\n\t\t\t\t\tself.grabbed.after($this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.grabbed.before($this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n\r\nUsers.prototype.release = function()\r\n{\r\n\tif(this.grabbed === null)\r\n\t\treturn;\r\n\r\n\t$('body').removeClass('grabbing');\r\n\tthis.grabbed.removeClass('grabbing');\r\n\tthis.grabbed = null;\r\n\tthis.ghost.remove();\r\n\tthis.ghost = null;\r\n\t$('body').off('.sortable');\r\n\r\n\tif(this.room.user.admin)\r\n\t\tthis.ordering();\r\n};\r\n\r\nUsers.prototype.order = function()\r\n{\r\n\tvar that = this;\r\n\tthis.items = this.$users.find('.user').sort(function(a, b){\r\n\t\treturn parseInt($(a).data('sort'), 10) - parseInt($(b).data('sort'), 10);\r\n\t}).each(function(index){\r\n\t\tvar order = $(this).data('sort');\r\n\t\tthat.$users.append($(this));\r\n\t});\r\n};\r\n\r\nUsers.prototype.ordering = function()\r\n{\r\n\tvar data = {};\r\n\tthis.items = this.$users.find('.user');\r\n\tthis.items.each(function(index){\r\n\t\t$(this).data('sort', index);\r\n\t\tvar id = $(this).data('user');\r\n\t\tif(id && index)\r\n\t\t\tdata[id] = index;\r\n\t});\r\n\r\n\tthis.room.socket.emit('user order', data);\r\n};\r\n\r\nUsers.prototype.sort = function(list)\r\n{\r\n\tfor(var l in list){\r\n\t\tl = parseInt(l, 10);\r\n\t\tvar user = this.getUserById(l);\r\n\t\tif(user){\r\n\t\t\tuser.order = parseInt(list[l], 10);\r\n\t\t\t$(\"#user-\"+l).data('sort', list[l]);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.init = function(users)\r\n{\r\n\tvar that = this;\r\n\r\n\t// Setup users\r\n\tfor(var i = 0, length = users.length; i < length; i++){\r\n\t\tvar user = users[i];\r\n\t\tif(user.connected){\r\n\t\t\tif(user.name.toLowerCase() == this.room.user.name.toLowerCase()){\r\n\t\t\t\tuser = this.room.user;\r\n\t\t\t}\r\n\r\n\t\t\tthis.addUser(user);\r\n\t\t\tthis.refreshTokens(user);\r\n\t\t}\r\n\t}\r\n\r\n\t// Users connexions\r\n\tthis.room.socket.on('user login', function(data){\r\n\t\tthat.addUser(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('user logout', function(data){\r\n\t\tthat.removeUser(data);\r\n\t});\r\n\r\n\t// Users typing\r\n\tthis.room.socket.on('typing start', function(data){\r\n\t\tthat.typingStart(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('typing stop', function(data){\r\n\t\tthat.typingStop(data);\r\n\t});\r\n\r\n\t// User token\r\n\tthis.room.socket.on('token give', function(data){\r\n\t\tthat.refreshTokens(data);\r\n\t});\r\n\r\n\tthis.room.socket.on('token use', function(data, token){\r\n\t\tthat.refreshTokens(data);\r\n\t\tvar token = $(\r\n\t\t\t'<div id=\"token-popin-'+data.id+'\" class=\"before overlay centerer\">'+\r\n\t\t\t\t'<div class=\"popin centered mui-panel text-align-center\">'+\r\n\t\t\t\t\t'<h3>'+data.name+' use '+token+' token</h3>'+\r\n\t\t\t\t\t'<div class=\"'+token+' token big\">&nbsp;</div>'+\r\n\t\t\t\t'</div>'+\r\n\t\t\t'</div>');\r\n\t\t$('body').append(token);\r\n\r\n\t\ttoken.delay(2000).fadeOut(300, function(){$(\"#token-popin-\"+data.id).remove();});\r\n\t\tsetTimeout(function(){token.removeClass('before');});\r\n\t});\r\n\r\n\t// User order\r\n\tthis.room.socket.on('user order', function(data){\r\n\t\tthat.sort(data);\r\n\t});\r\n\r\n\tif(this.room.user.admin){\r\n\t\tthis.$users.on('mousedown.sortable', '.user-details', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\r\n\t\tthis.$users.on('mousedown.sortable', '.user', function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthat.grab($(this), {x:e.pageX, y:e.pageY});\r\n\t\t});\r\n\r\n\t\t$('body').on('click.token', '#users .user .token', function(){\r\n\t\t\tthat.room.socket.emit('token use', $(this).data('user'), $(this).data('token'));\r\n\t\t});\r\n\t} else {\r\n\t\t$('body').on('click.token', '#user-'+this.room.user.id+' .token', function(){\r\n\t\t\tthat.room.socket.emit('token use', that.room.user.id, $(this).data('token'));\r\n\t\t});\r\n\t}\r\n\r\n\tthis.order();\r\n};\r\n\r\nUsers.prototype.destroy = function()\r\n{\r\n\tthis.room.socket.removeAllListeners('user login');\r\n\tthis.room.socket.removeAllListeners('user logout');\r\n\tthis.room.socket.removeAllListeners('typing start');\r\n\tthis.room.socket.removeAllListeners('typing stop');\r\n\tthis.$users.off('.sortable');\r\n\t$('body').off('.token').off('.sortable');\r\n};\r\n"]}